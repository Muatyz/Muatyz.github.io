<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>è¯¾è®¾ | æ— å¤„æƒ¹å°˜åŸƒ</title>
<meta name="keywords" content="cs, data analysis">
<meta name="description" content="å¼•èˆªä¸­æ–­ä¼šå¯¼è‡´æ¸¯å£è¿è¥æ•ˆç‡è¾ƒä½, å› æ­¤å¯¹ç»Ÿè®¡æ•°æ®è¿›è¡Œåˆ†æå¯ä»¥å¯¹å¼•èˆªä½œä¸šç‚¹çš„ç§»åŠ¨æä¾›é£é™©è¯„ä¼°å’Œå†³ç­–è¾…åŠ©">
<meta name="author" content="Muartz">
<link rel="canonical" href="https://Muatyz.github.io/posts/cs/intro-two-cs-project2/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.js" onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://Muatyz.github.io/img/Head32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://Muatyz.github.io/img/Head16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://Muatyz.github.io/img/Head32.png">
<link rel="apple-touch-icon" href="https://Muatyz.github.io/img/Head32.png">
<link rel="mask-icon" href="https://Muatyz.github.io/img/Head32.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script defer src="https://unpkg.com/mermaid@8.8.1/dist/mermaid.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.3/dist/jquery.min.js"></script>



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = ""; 
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<script type="text/javascript"
        async
        src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[\[','\]\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});

MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<style>
code.has-jax {
    font: inherit;
    font-size: 100%;
    background: inherit;
    border: inherit;
    color: #515151;
}
</style>
<meta property="og:title" content="è¯¾è®¾" />
<meta property="og:description" content="å¼•èˆªä¸­æ–­ä¼šå¯¼è‡´æ¸¯å£è¿è¥æ•ˆç‡è¾ƒä½, å› æ­¤å¯¹ç»Ÿè®¡æ•°æ®è¿›è¡Œåˆ†æå¯ä»¥å¯¹å¼•èˆªä½œä¸šç‚¹çš„ç§»åŠ¨æä¾›é£é™©è¯„ä¼°å’Œå†³ç­–è¾…åŠ©" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://Muatyz.github.io/posts/cs/intro-two-cs-project2/" />
<meta property="og:image" content="https://s2.loli.net/2023/05/20/ops4b9WAYctdHSE.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-05T12:20:21+08:00" />
<meta property="article:modified_time" content="2023-05-05T12:20:21+08:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://s2.loli.net/2023/05/20/ops4b9WAYctdHSE.png" />
<meta name="twitter:title" content="è¯¾è®¾"/>
<meta name="twitter:description" content="å¼•èˆªä¸­æ–­ä¼šå¯¼è‡´æ¸¯å£è¿è¥æ•ˆç‡è¾ƒä½, å› æ­¤å¯¹ç»Ÿè®¡æ•°æ®è¿›è¡Œåˆ†æå¯ä»¥å¯¹å¼•èˆªä½œä¸šç‚¹çš„ç§»åŠ¨æä¾›é£é™©è¯„ä¼°å’Œå†³ç­–è¾…åŠ©"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [

        {
          "@type": "ListItem",
          "position":  1 ,
          "name": "ğŸ“šæ–‡ç« ",
          "item": "https://Muatyz.github.io/posts/"
        },

        {
          "@type": "ListItem",
          "position":  2 ,
          "name": "ğŸ‘¨ğŸ»â€ğŸ’» CS",
          "item": "https://Muatyz.github.io/posts/cs/"
        }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "è¯¾è®¾",
      "item": "https://Muatyz.github.io/posts/cs/intro-two-cs-project2/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "è¯¾è®¾",
  "name": "è¯¾è®¾",
  "description": "å¼•èˆªä¸­æ–­ä¼šå¯¼è‡´æ¸¯å£è¿è¥æ•ˆç‡è¾ƒä½, å› æ­¤å¯¹ç»Ÿè®¡æ•°æ®è¿›è¡Œåˆ†æå¯ä»¥å¯¹å¼•èˆªä½œä¸šç‚¹çš„ç§»åŠ¨æä¾›é£é™©è¯„ä¼°å’Œå†³ç­–è¾…åŠ©",
  "keywords": [
    "cs", "data analysis"
  ],
  "articleBody": " æ¶‰å¯†è­¦å‘Š æœ¬æ¬¡è¯¾è®¾æ‰€ä½¿ç”¨çš„åå¹´å¼•èˆªä¸­æ–­ç›¸å…³çš„æ•°æ®å‡ä¸ºæ¶‰å¯†, è€Œæœ¬å°ç»„å…¨ä½“æˆå‘˜å‡å·²ç­¾è®¢ä¿å¯†å¥‘çº¦ä»¥è¿›è¡Œè¯¾è®¾å·¥ä½œ. å› æ­¤ä¸‹é¢æ‰€ä½¿ç”¨çš„ä»£ç ä¸ä¼šå±•ç¤ºä»»ä½•å…·ä½“çš„æ•°æ®, è€Œåªæ˜¯å±•ç¤ºå…¶å·¥ä½œåŸç†. æœ¬æ–‡å°†ä»‹ç»æœ¬äººæ‰€è´Ÿè´£çš„é—®é¢˜ä¸€éƒ¨åˆ†, å³å¯¹åå¹´çš„å¼•èˆªä¸­æ–­æ•°æ®è¿›è¡Œåˆ†æ, å¹¶ä¸”å¾—å‡ºç›¸åº”çš„ç»“è®º.\né—®é¢˜åˆ†æ é¡¹ç›®æä¾›çš„æ•°æ®é›†ç»™å‡ºäº† 2011-2020 å…± 10 å¹´å‘ç”Ÿå¼•èˆªä¸­æ–­çš„æƒ…å†µç»Ÿè®¡, å…¶ä¸­å¯¼è‡´å¼•èˆªä¸­æ–­çš„åŸå› åŒ…æ‹¬å¤§é£ç®¡åˆ¶å’Œèƒ½è§åº¦ä¸è‰¯ä¸¤ç±», æœ¬é¢˜ä¸­æš‚ä¸è€ƒè™‘èƒ½è§åº¦ä¸è‰¯æƒ…å†µçš„åˆ†æ, åªå…³æ³¨å¤§é£ç®¡åˆ¶çš„åˆ†æ. è¯·ç­›é€‰å‡ºå¤§é£ç®¡åˆ¶çš„æƒ…å†µç»Ÿè®¡, ç»Ÿè®¡å¤§é£ç®¡åˆ¶æ—¥çš„é£å‘ã€é£çº§æƒ…å†µ æ³¨æ„: é£å‘å’Œé£çº§æƒ…å†µæ¯æ—¥å¯èƒ½ä¸æ˜¯ç¨³å®šçš„, è¯·è®¾è®¡æ•°æ®å¤„ç†è§„åˆ™, èƒ½å¤Ÿæœ‰æ•ˆåœ°ä»£è¡¨å½“æ—¥çš„é£å‘ã€é£çº§æƒ…å†µ.\nè¦æ±‚è¿ç”¨æ•°æ®å¯è§†åŒ–çš„æ–¹æ³•å±•ç¤ºç»Ÿè®¡ç»“æœ, å¹¶æ–‡å­—è¯´æ˜é£å‘å’Œé£çº§çš„æ•°æ®å¤„ç†è§„åˆ™, é™„ XLSX æ–‡ä»¶, åŒ…æ‹¬å…¨éƒ¨å¤§é£ç®¡åˆ¶æ—¥çš„é£å‘å’Œé£çº§. (15 åˆ†)\næ ¹æ®ä¸Šä¸€é—®ä¸­çš„åˆ†æ, å»ºæ¨¡åˆ†æä¸åŒé£å‘å’Œé£çº§å¯¹è§¦å‘å¼•èˆªä¸­æ–­çš„å½±å“, è¦æ±‚å±•ç°å‡º 10 å¹´é—´çš„å½±å“æƒ…å†µ, å¹¶ç»™å‡ºè§¦å‘å¼•èˆªä¸­æ–­çš„é£å‘å’Œé£çº§è§„å¾‹(å¯ä»¥æ˜¯å„å› ç´ çš„ç‹¬ç«‹é˜ˆå€¼, ä¹Ÿå¯ä»¥æ˜¯åŒå› ç´ è€¦åˆçš„é˜ˆå€¼). (15 åˆ†) æ•°æ®æ ·ä¾‹ä»‹ç»ï¼š Sheet 1ï¼š2020å¹´é€šèˆªç®¡åˆ¶æƒ…å†µç»Ÿè®¡è¡¨â€”â€”2020å¹´å¼•èˆªä¸­æ–­æ—¶é—´çš„æ±‡æ€», å…¶ä¸­æœ¬é¢˜åªè€ƒè™‘å¤§é£ç®¡åˆ¶çš„æƒ…å†µ, åˆ†åˆ«åŒ…æ‹¬å¼•èˆªæš‚åœçš„æ—¥æœŸã€æš‚åœèµ·æ­¢æ—¶é—´å’Œæš‚åœæ—¶é•¿. Sheet 2ï¼š2020å¹´1æœˆ8æ—¥æ´‹å±±æ¸¯æµ·äº‹å±€å·¥ä½œæŠ¥å‘Šâ€”â€”ä½¿ç”¨å…¶ä¸­çš„èˆŸå±±é™„è¿‘æ²¿æµ·å½“æ—¥æ°”è±¡ç®€æŠ¥. Sheet 3ï¼šè§‚æµ‹çº¿6è­¦æˆ’åŒºâ€”â€”ç»è¿‡è§‚æµ‹çº¿çš„èˆ¹èˆ¶ä¿¡æ¯è®°å½•, ä½¿ç”¨å…¶ä¸­çš„èˆ¹åã€èˆ¹èˆ¶ç§ç±»ã€èˆ¹èˆ¶é•¿åº¦ã€æŠ¥å‘Šçº¿åç§°ã€èˆ¹èˆ¶èˆªå‘ã€èˆ¹èˆ¶èˆªé€Ÿã€ç©¿è¶Šæ—¶é—´ã€ç»åº¦å’Œçº¬åº¦ç­‰ä¿¡æ¯. è§‚å¯Ÿå‘ç°æ‰€ç»™çš„æ•°æ®è¡¨æ ¼æ ¼å¼ä¸ä¸€, ä¸ºäº†èƒ½å¤Ÿä½¿ç”¨ç»Ÿä¸€æ–¹å¼å¯¹æ•°æ®è¿›è¡ŒæŒ–æ˜å¤„ç†, éœ€è¦å°†æ‰€æœ‰æ–‡ä»¶æ•´åˆä¸º XLSX æ ¼å¼.\næŒ‰å¹´é¡ºåºè¯»å–æºè¡¨æ ¼æ–‡ä»¶å, è¯»å–é¦–é¡µçš„ sheet å¹¶ä¸”è¯»å–å¯¹åº”çš„æ—¥æœŸ. åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­, è¿˜æ¶‰åŠäº†å¯¹äº sheet æ ¼å¼ä¸Šçš„å‰ªè£å¤„ç†å’Œå¯¹å­—ç¬¦ä¸²çš„é‡æ•´åŒ–.\nç”±ä»»åŠ¡è¦æ±‚å¯çŸ¥, éœ€è¦æ•´ç†å¤§é£ç®¡åˆ¶å¼•èµ·çš„å¼•èˆªä¸­æ–­, å› æ­¤å¯ä»¥æå–å¤§é£ç®¡åˆ¶å¯¹åº”çš„æ—¥æœŸå¹¶æŸ¥è¯¢å½“å¤©æµ·é¢çš„å¤©æ°”æƒ…å†µ.\nè€Œåœ¨è¯¥ä»»åŠ¡æä¾›çš„æ•°æ®æ–‡ä»¶ä¸­, å¤©æ°”ä¿¡æ¯éƒ½æ˜¯çº¯ç²¹æ–‡æœ¬, æˆ‘ä»¬éœ€è¦å¯¹å…¶ä¸­çš„æœ‰æ•ˆä¿¡æ¯è¿›è¡Œæå–. æ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ä»¬é€‰æ‹©äº†ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œç­›é€‰.\nè¯»å–åˆ°å„å¹´å¤§é£ç®¡åˆ¶æ—¥æœŸä¸‹çš„é£å‘é£çº§å, å°±å¯ä»¥ä½¿ç”¨ OriginPro è½¯ä»¶æä¾›çš„ç»˜å›¾åŠŸèƒ½å¯¹(é£å‘, é£çº§)ä¿¡æ¯è¿›è¡Œç»Ÿè®¡å¹¶ä¸”æ€»ç»“è§„å¾‹.\nä»»åŠ¡ä¸€æ‰€æ¶‰åŠçš„ä»£ç æ ¹æ®éœ€æ±‚è¢«åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†:classifier.py, calcute.py. å‰è€…è¿›è¡Œæ•°æ®çš„è¯»å–, åè€…è¿›è¡Œæ•°æ®çš„æ•´ç†.\nè¯»å–æ•°æ® #classifier.py #! -*- coding=utf-8 -*- from numpy import NaN import pandas as pd import re import openpyxl import pyexcel as p import xlwings as xw import shutil years=[str(x) for x in range(2011,2020+1)] for year in years: #æŒ‰å¹´è¯»å–è¡¨æ ¼æ–‡ä»¶############################################### parentpath=r\"./Project02-Data-31/ä»»åŠ¡ä¸€-å¼•èˆªä¸­æ–­-æ°”è±¡ç»Ÿè®¡æ•°æ®\" path=parentpath+r'/'+year+r\"å¹´æ°”è±¡ç»Ÿè®¡.xlsx\" #å°†æ–°çš„mainsheetå†™å…¥åŸæ¥çš„è¡¨æ ¼è€Œä¸åˆ é™¤å…¶ä½™çš„sheet if int(year)\u003e=2019: #2019å¹´å’Œ2020å¹´æ–‡ä»¶ä¸º.xlsæ ¼å¼, è½¬ä¸º.xlsxæ ¼å¼ p.save_book_as(file_name=path[:-1],dest_file_name=path) f=pd.ExcelFile(path) wb=xw.Book(path) SheetNames=f.sheet_names mainsheet=pd.read_excel(path,sheet_name=SheetNames[0]) #å°†sheetæ•´ç†ä¸ºå’Œ2019å¹´ä»¥å‰ç›¸åŒçš„æ ¼å¼ï¼ˆå³åˆ é™¤è¡¨å¤´å¹¶æ—¥æœŸåˆ—è°ƒæ•´è‡³ç¬¬ä¸€åˆ—ï¼‰ mainsheet=mainsheet.iloc[1:,1:] orisht=wb.sheets(SheetNames[0]) orisht.delete() sht=wb.sheets.add(name=year+'å¹´å½±å“é€šèˆª',before=SheetNames[1]) sht.range('A1').value=mainsheet.values wb.save(year+r\"å¹´æ°”è±¡ç»Ÿè®¡.xlsx\") wb.close() file=year+r\"å¹´æ°”è±¡ç»Ÿè®¡.xlsx\" shutil.copy(file,parentpath)#å°†ç”Ÿæˆçš„æ–‡ä»¶è¦†ç›–åœ¨æºæ–‡ä»¶ä¸Š ######################################################### f=pd.ExcelFile(path) #è·å–å·¥ä½œè¡¨åç§° SheetNames=f.sheet_names #æ£€æŸ¥æ˜¯å¦è¯»å–æˆåŠŸ print(SheetNames) #è¯»å–ç¬¬ä¸€å¼ sheet mainsheet=pd.read_excel(path,sheet_name=year+'å¹´å½±å“é€šèˆª') #è¯»å–ç¬¬ä¸€é¡µçš„æ–‡ä»¶å¹¶è·å¾—ä¸€äº›åŸºæœ¬æ•°æ® rowNum=mainsheet.shape[0] #è¯»å–ç¬¬ä¸€é¡µsheetçš„ç¬¬ä¸€äºŒåˆ—çš„æœ‰æ•ˆæ•°æ® datePlus=mainsheet.iloc[2:rowNum-3,[0,1]] datePlus=datePlus.dropna(axis=0,how='any') #è·å–å½“å¹´å¤§é£ç®¡åˆ¶æ—¥æœŸ date=datePlus.iloc[:,0] #æ£€æŸ¥è¯»å–çš„å¤§é£ç®¡åˆ¶æ—¶é—´æ®µ print(date) #å°†æ—¶é—´æ®µæ‹†åˆ†ä¸ºå•å¤© Date=[] for i in range(date.shape[0]): date.iloc[i]=date.iloc[i][5:] series=[] if '-' in date.iloc[i]: ###########å¯¹.å’Œ-è¿›è¡Œå®šä½############### loc1=date.iloc[i].index('.') loc2=date.iloc[i].index('-') ######æ³¨æ„å»é™¤æ—¥æœŸå•å…ƒæ ¼ä¸­å¶å°”å‡ºç°çš„ä¸­æ–‡## begin=int(re.sub('[\\u4e00-\\u9fa5]', '',date.iloc[i][loc1+1:loc2])) end=int(re.sub('[\\u4e00-\\u9fa5]', '',date.iloc[i][loc2+1:])) month=str(re.sub('[\\u4e00-\\u9fa5]', '',date.iloc[i][:loc1+1])) for j in range(begin,end+1): if month+str(j) not in Date: #############é¿å…é‡å¤ç™»è®°å·²ç»ç™»è®°è¿‡çš„æ—¥æœŸ####### Date.append(month+str(j)) else: Date.append(str(re.sub('[\\u4e00-\\u9fa5]', '',date.iloc[i]))) date=pd.DataFrame(date) #æ£€æŸ¥å»å¹´ä»½æ˜¯å¦æˆåŠŸ print(date) #æ£€æŸ¥çœŸæ­£çš„æ—¥æœŸåºåˆ—æ˜¯å¦ç”ŸæˆæˆåŠŸ print(Date) ########ä»¥ç”Ÿæˆçš„æ—¥æœŸä¾æ¬¡æŸ¥è¯¢å½“å¹´çš„é£å‘é£çº§çš„æƒ…å†µ########### Time=[] Land=[] #æµ·é¢çš„å¤©æ°”ä¿¡æ¯ç›¸è¾ƒäºé™†åœ°çš„å¯¹å¼•èˆªä¸­æ–­åº”å½“æ›´ç›´æ¥ Sea=[] for day in Date: \"\"\" è¯¥ç‰ˆæœ¬ä¸ºå®Œå…¨æ’é™¤ç©ºæ—¥æœŸ(æ— æ³•ç”±Dateç›´æ¥æŸ¥è¯¢åˆ°çš„æ—¥æœŸ) \"\"\" if day in SheetNames: Sheet=pd.read_excel(path,sheet_name=day) Time.append(day) Land.append(Sheet.iloc[1,0]) Sea.append(Sheet.iloc[2,0]) else: #æœ€ä¸¥è°¨çš„æ–¹å¼æ˜¯å¦‚æœè¿™ä¸€å¤©æ²¡æœ‰è¯»å–åˆ°, åº”å½“å†è¯»å–å‰ä¸€å¤©å¤©æ°”ä¸­\"æ˜å¤©\"çš„ä¿¡æ¯ #ä½†æ˜¯å¤©æ°”çš„è®°å½•æ ¼å¼ä¸ä¸€, æ‰€ä»¥è¿™é‡Œé€‰æ‹©è‹¥æ²¡æœ‰è¯¥å¤©çš„å¤©æ°”è®°å½•, å°±é€‰æ‹©ä¸å½•å…¥ pass #åˆ›å»ºæ—¶é—´å’Œå¤©æ°”å…³ç³»çš„å­—å…¸å¹¶ç”Ÿæˆè¡¨æ ¼ dic={'Day':Time,'Land':Land,'Sea':Sea} Ori=pd.DataFrame(dic) #æ£€æŸ¥ç”Ÿæˆé£å‘é£çº§åŸå§‹æ•°æ®è¡¨æ˜¯å¦æˆåŠŸ print(Ori) #######æ–‡æœ¬å¤„ç†ç¨‹åº, è¯»å–åŸå§‹æ•°æ®ä¸­çš„é£å‘å’Œé£çº§ä¿¡æ¯############### #åˆ›å»ºç©ºè¡¨æ ¼ä»¥å¤‡è¯»å†™ tmp=pd.DataFrame() processedPath='./ProcessedData/ProcessedData'+year+'.xlsx' tmpFile=tmp.to_excel(processedPath) #ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œä¿¡æ¯è¯»å– for orisentence in Sea: WeatherDay=str(Time[Sea.index(orisentence)]) law=r\"([ä»Š|æ˜|å]å¤©)?([ä¸œ|è¥¿|å]?[å—|åŒ—|ä¸œ|è¥¿]?)?[åˆ°]?([ä¸œ|è¥¿|å]?[å—|åŒ—|ä¸œ|è¥¿|é˜µ]?)?é£(\\d)[\\-]?([\\d]?)çº§\" Weather=re.findall(law,orisentence,re.S) ''' æ­¤å¤„ä½¿ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œå¤©æ°”ä¿¡æ¯çš„ç­›é€‰, ä¸¥æ ¼æ¥è¯´åº”è¯¥ç¼–è¾‘çŠ¶æ€è‡ªåŠ¨æœºè¿›è¡Œè¯»å–. ä½†æ˜¯ç”±äºå¤©æ°”ä¿¡æ¯çš„æ’°å†™æ–¹å¼å®åœ¨ä¸ä¸€, æ‰€ä»¥é€‰ç”¨äº†ä¸€ä¸ªé€šç”¨æ€§è¾ƒé«˜çš„æ–¹æ³•. è‹¥ç”¨Pytorchè¿›è¡Œè¯­è¨€å¤„ç†åº”å½“æ˜¯æœ€ä¸“ä¸šçš„, é™äºèƒ½åŠ›æ°´å¹³å¹¶æœªä½¿ç”¨. ''' if Weather: day=[] #é£å‘å¯èƒ½ä¼šå‘ç”Ÿæ”¹å˜, å¦‚\"ä¸œåˆ°ä¸œåŒ—é£\"ç­‰ diraction1=[] diraction2=[] #è®°å½•æœ€å°é£çº§å’Œæœ€å¤§é£çº§ minscale=[] maxscale=[] for i in range(len(Weather)): day.append(Weather[i][0]) #è‹¥æœ‰ç©ºç™½éƒ¨åˆ†, åˆ™ä»å¦ä¸€éƒ¨åˆ†å¤åˆ¶æ•°æ®# ############é£å‘éƒ¨åˆ†çš„ç©ºç™½å¡«å……############# if Weather[i][2]=='': diraction1.append(Weather[i][1]) diraction2.append(Weather[i][1]) elif Weather[i][2]=='': diraction1.append(Weather[i][2]) diraction2.append(Weather[i][2]) else: diraction1.append(Weather[i][1]) diraction2.append(Weather[i][2]) ##############é£çº§éƒ¨åˆ†çš„ç©ºç™½å¡«å……########## if Weather[i][4]!='' and int(Weather[i][3])\u003eint(Weather[i][4]): #æ’é™¤è¯»åˆ°10çš„æ—¶å€™å°†1å’Œ0æ‹†å¼€ minscale.append(str(Weather[i][3])+str(Weather[i][4])) maxscale.append(str(Weather[i][3])+str(Weather[i][4])) elif Weather[i][4]=='': #å¯¹ä»…æœ‰ä¸€ä¸ªæ•°å­—çš„è¿›è¡Œå¤åˆ¶ç²˜è´´å¤„ç† minscale.append(str(Weather[i][3])) maxscale.append(str(Weather[i][3])) else: #å…¶ä»–æƒ…å†µæ­£å¸¸å…¥ä½ minscale.append(str(Weather[i][3])) maxscale.append(str(Weather[i][4])) #ç”Ÿæˆæ—¥æœŸå’Œå¤©æ°”å…³ç³»çš„å­—å…¸å¹¶ç”Ÿæˆè¡¨æ ¼ weatherdic={'æ—¥æœŸ':day,'é£å‘1':diraction1,'é£å‘2':diraction2,'å°é£çº§':minscale,'å¤§é£çº§':maxscale} df=pd.DataFrame(weatherdic) #åœ¨è¯¥æ–‡ä»¶ä¸­ä¾æ¬¡åˆ›å»ºæ–°worksheet,å¡«å…¥ç›¸åº”çš„df with pd.ExcelWriter(processedPath,mode='a') as writer: df.to_excel(writer,sheet_name=WeatherDay) #æ¸…ç†è¯»å†™æœŸé—´äº§ç”Ÿçš„æ— ç”¨sheet(å³Sheet1) processedExcel=openpyxl.load_workbook(processedPath) wastedSheet=processedExcel['Sheet1'] processedExcel.remove(wastedSheet) #å°†è¯»å†™å®Œæ¯•çš„è¡¨æ ¼å­˜å‚¨èµ·æ¥ processedExcel.save(processedPath) åˆ†ææ•°æ® é£å‘åˆ†çº§ç¡®å®šå‡†åˆ™ ç”±ä¸Šè¿°çš„ä»£ç ä¸éš¾çœ‹å‡º, å¯¹äºä¸€æ®µæºæ–‡ä»¶çš„å¤©æ°”ä¿¡æ¯æ–‡æœ¬, å³ä½¿æ˜¯åŒä¸€æ­£åˆ™è¡¨è¾¾å¼ä¹Ÿå¯èƒ½ä¼šè¯»å‡ºå¤šæ¡ç»“æœ. æœ‰çš„æ˜¯åŒä¸€å¤©å†…çš„å¤šæ¡æ•°æ®, æœ‰çš„æ˜¯ä¸åŒå¤©é‡Œçš„æ•°æ®(è¿™æ˜¯å› ä¸ºæŸäº›æ—¥æœŸçš„æ•°æ®å¹¶ä¸å­˜åœ¨äºå¯¹åº”çš„å¤§é£ç®¡åˆ¶æ—¥æœŸçš„è¡¨æ ¼ä¸­, è€Œæ˜¯å­˜åœ¨äºæŸäº›ç›¸é‚»çš„å¤§é£ç®¡åˆ¶æ—¥æœŸ.)\næ‰€ä»¥æˆ‘ä»¬æ”¶é›†å¤©æ°”çš„ç­–ç•¥æ˜¯: å·²çŸ¥å¤§é£ç®¡åˆ¶æœŸé—´çš„å¤©æ°”è®°å½•å¹¶ä¸æ­¢ä¸€å¤©, ç»“åˆæ­£åˆ™è¡¨è¾¾å¼çš„è¯»å–æ•ˆæœ, å°†è¯»å–æ•°æ®çš„ç¬¬ä¸€å¤©å’Œç¬¬äºŒå¤©ä¹‹é—´çš„æ‰€æœ‰æ•°æ®ï¼› ç„¶åé£çº§å°±æ˜¯é£å‘æ•°æ®çš„æœ€å¤§å€¼å’Œæœ€å°å€¼, é£å‘åˆ™æ˜¯è¿™äº›æ•°æ®çš„ç¬¬ä¸€å¯¹(è®°å½•æ•°æ®æ—¶, é£å‘å¯èƒ½ä¼šä»¥\"ä¸œåˆ°ä¸œåŒ—é£\"çš„æ–¹å¼å‘ˆç°, æ‰€ä»¥é£å‘ä¼šä»¥æˆå¯¹çš„å½¢å¼è®°å½•ä¸‹æ¥. è‡³äºæœ¬æ¥å°±åªæœ‰ä¸€ä¸ªé£å‘çš„, å°±è§†ä¸ºè¿™ä¸€å¯¹é£å‘çš„ä¸¤ä¸ªå…ƒç´ éƒ½æ˜¯ç›¸åŒçš„).\nè™½ç„¶è¿™æ ·çš„å¤„ç†å¯èƒ½çœ‹ä¼¼æœ‰äº›è‰ç‡, ä½†æ˜¯ç»“åˆå…·ä½“çš„å¤©æ°”ä¿¡æ¯æ–‡æœ¬ä¸éš¾çœ‹å‡º, å‡ºç°å¼‚å¸¸æƒ…å†µå¾€å¾€éƒ½æ˜¯éƒ½ä¼šæ˜¯æ—¥æœŸè¿æŠ¥(å¦‚â€™ä»Šå¤©ã€æ˜å¤©ä¸œåˆ°ä¸œåŒ—é£â€™), è€Œä¸”å¤§é£ç®¡åˆ¶çš„æ—¥æœŸä¹Ÿæœ‰å¯èƒ½æ˜¯è¿ç»­çš„, æ‰€ä»¥å³ä½¿æŒ‰ç…§ä¸Šæ–‡æ‰€è¿°çš„æ¨¡ç³Šè¯†åˆ«æ–¹æ³•, ä¹Ÿæ˜¯æœ‰ä¸€å®šè¯æ®æ”¯æ’‘çš„.\nä¸‹é¢æ˜¯å…·ä½“çš„ä»£ç å®ç°:\n#! -*- coding=utf-8 -*- from numpy import NAN, NaN, nan import pandas as pd #######################è¯»å–çœŸæ­£çš„é£å‘é£çº§################## #é€å¹´è¯»å–å·²ç»ç”Ÿæˆå®Œæ¯•çš„æ—¥æœŸ-å¤©æ°”è¡¨æ ¼ years=[str(x) for x in range(2011,2020+1)] #é¢„å…ˆåˆ†é…listä»¥å­˜å‚¨è¯»å–çš„å¯¹åº”æ•°æ® Time=[] Diraction1=[] Diraction2=[] minScale=[] maxScale=[] for year in years: processedPath='./ProcessedData/ProcessedData'+year+'.xlsx' f=pd.ExcelFile(processedPath) SheetNames=f.sheet_names #æŒ‰å¤©è¯»å–å½“å¤©çš„é£å‘é£çº§ for day in SheetNames: sht=pd.read_excel(processedPath,sheet_name=day) date=list(sht['æ—¥æœŸ'].values) dira1=list(sht['é£å‘1'].values) dira2=list(sht['é£å‘2'].values) scale1=list(sht['å°é£çº§'].values) scale2=list(sht['å¤§é£çº§'].values) #å»é™¤ç©ºç™½æ—¥æœŸï¼Œå³è®°å½•åœ¨'æ—¥æœŸ'åˆ—é‡Œå®é™…è®°å½•çš„å¤©æ•°(ä»Šå¤©ï¼Œæ˜å¤©æˆ–åå¤©) date_brief=[sing for sing in date if sing==sing] #è®°å½•æ—¥æœŸæ‰€åœ¨ä½ç½®çš„ç´¢å¼• date_index=[] for sing in date_brief: date_index.append(date.index(sing)) if len(date_brief)==1: #è‹¥è®°å½•åœ¨åˆ—çš„åªæœ‰ä¸€å¤©ï¼Œé‚£ä¹ˆæ— è®ºè¿™ä¸€å¤©æ˜¯å“ªä¸€å¤©éƒ½å°†å…¶ä½œä¸ºå½“å¤©çš„æ•°æ® diraction1=dira1[date_index[0]:] diraction2=dira2[date_index[0]:] minscale=min(scale1[date_index[0]:]) maxscale=max(scale2[date_index[0]:]) else: #è®°å½•çš„ä¸æ­¢ä¸€å¤©çš„æ—¶å€™ï¼Œå°±å°†ç¬¬ä¸€å¤©å’Œç¬¬äºŒå¤©ä¹‹é—´çš„æ•°æ®æ”¶é›†èµ·æ¥ #å³ï¼Œæœ‰å¯èƒ½è¯»å–åˆ°çš„æ˜¯\"ä»Šå¤©ï¼Œåå¤©\",é‚£ä¹ˆä¹Ÿä¼šè®°å½•è¿™ä¸¤è€…ä¹‹é—´çš„æ‰€æœ‰æ•°æ® diraction1=dira1[date_index[0]:date_index[1]] diraction2=dira2[date_index[0]:date_index[1]] minscale=min(scale1[date_index[0]:date_index[1]]) maxscale=max(scale2[date_index[0]:date_index[1]]) #é¢„å…ˆåˆ†é…listå¯¹é£å‘çš„ä¸¤ä¸ªæ–¹å‘è¿›è¡Œå­˜å‚¨ d1list=[] d2list=[] #è®°å½•é£å‘é£çº§æ—¶å…ˆè®°å½•å¯¹åº”å¤©çš„æ—¥æœŸï¼Œä¸ºäº†é¿å…é‡å¤è¿˜è¦åŠ ä¸Šå¹´ä»½çš„ä¿¡æ¯ Time.append(year+r'.'+day) #åœ¨æ•°æ®ä¸­ä¼šæœ‰ç©ºæ ¼å’Œ'é˜µ'çš„æ•°æ®ï¼ŒæŒ‰ç…§æˆ‘ä»¬å¯¹äºåœ°ç†çš„ç†è§£å³é˜µé£ä¸ºæœ€å¤§é£çº§ #æ‰€ä»¥åœ¨è®°å½•æ—¶ï¼Œå°†ä¸¤å¤©ä¹‹é—´çš„æ‰€æœ‰é£çº§è¿›è¡Œæ¯”è¾ƒï¼Œé˜µé£ä¸ºæœ€å¤§å€¼æ‰€ä»¥å¿…å®šåŒ…æ‹¬åœ¨æ¯”è¾ƒå½“ä¸­ for d1 in diraction1: if str(d1)!='nan' and str(d1)!='é˜µ': d1list.append(str(d1)) for d2 in diraction2: if str(d2)!='nan' and str(d2)!='é˜µ': d2list.append(str(d2)) #å®Œæˆå¯¹äºæ•°æ®çš„æ¸…ç†ä¹‹åï¼Œè¯»å–é£å‘çš„è§„åˆ™å³ä¸ºå…¶ä¸­çš„ç¬¬ä¸€æ¬¡é£å‘ä¿¡æ¯çš„ç»“æœ #å³ï¼Œå¿½ç•¥äº†éšç€æ—¶é—´å˜åŒ–é£å‘ä¿¡æ¯éšä¹‹å˜åŒ–çš„è¿‡ç¨‹ã€‚ #æœ€ä¸¥è°¨çš„æ–¹æ³•æ˜¯ç»“åˆå¤©æ°”è®°å½•æ¡£æ¡ˆçš„æœ€ä¸‹æ–¹çš„å¼•èˆªä¸­æ–­æ—¶é—´(ä¸­åˆæˆ–è€…ä¸‹åˆ)æ¥åˆ¤æ–­ #æœ€æ­£ç¡®çš„æ—¶é—´ï¼Œä½†æ˜¯ä»…ä»…å€ŸåŠ©æ­£åˆ™è¡¨è¾¾å¼è¿™ä¸ªä»»åŠ¡æ˜¯å¼‚å¸¸å›°éš¾çš„ Diraction1.append(d1list[0].replace('å','')) Diraction2.append(d2list[0].replace('å','')) #åœ¨ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¯»å–é£å‘çš„æ—¶å€™ï¼Œä¼šè¯»è¿›'å'å­—ç¬¦ #åœ¨è¿›è¡Œæ•°æ®å¤„ç†æ—¶åˆ™å°†åå­—å»é™¤ä»¥å¤‡åæœŸè¿›è¡Œå­—å…¸ä»£æ¢ minScale.append(minscale) maxScale.append(maxscale) #æ‰‹åŠ¨å†™å…¥æ–¹å‘å’Œåº¦æ•°çš„å¯¹åº”å­—å…¸ word_to_num={'ä¸œ':0,'è¥¿':180,'å—':270,'åŒ—':90,'ä¸œå—':315,'ä¸œåŒ—':45,'è¥¿å—':225,'è¥¿åŒ—':135} #é¢„å…ˆåˆ†é…è¯»å…¥è¯»æ•°çš„list Diraction1_num=[] Diraction2_num=[] #ä½¿ç”¨å·²å†™å¥½çš„å­—å…¸å¯¹æ–¹å‘è¿›è¡Œä»£æ¢ for i in range(len(Time)): Diraction1_num.append(word_to_num[Diraction1[i]]) Diraction2_num.append(word_to_num[Diraction2[i]]) #ç”Ÿæˆæ–°å­—å…¸å¹¶ä¸”ç”Ÿæˆè¡¨æ ¼ dira_and_scale={'æ—¥æœŸ':Time,'é£å‘1':Diraction1,'é£å‘1num':Diraction1_num,'é£å‘2':Diraction2,'é£å‘2num':Diraction2_num,'å°é£çº§':minScale,'å¤§é£çº§':maxScale} df=pd.DataFrame(dira_and_scale) processedPath='./ProcessedData/data.xlsx' #å°†ç”Ÿæˆçš„è¡¨æ ¼è®°å½•ä¸‹ file=df.to_excel(processedPath) ç»“è®º é¦–å…ˆæ˜¯å¾—åˆ°ä¸€å¼ åå¹´å°ºåº¦çš„æ—¥æœŸ-é£å‘é£çº§çš„è¡¨æ ¼, å…¶ä¸­å·²ç»åŒ…å«äº†å¯¹é£å‘è¯»ä¸ºåº¦æ•°çš„åˆ—.\nä½¿ç”¨ OriginPro çš„é£å‘ç«ç‘°å›¾çš„ç»˜åˆ¶åŠŸèƒ½ä¸éš¾ç»˜åˆ¶å‡ºé£å‘å’Œé£çº§åœ¨å¤§é£ç®¡åˆ¶æœŸé—´çš„è§„å¾‹. ç”±ä¸Šè¿°å›¾å¯ä»¥åˆ†æå¾—åˆ°çš„ç»“è®ºæ˜¯:\nå¤§é£ç®¡åˆ¶å‘ç”Ÿæ—¶ï¼Œé£å‘å„ä¸ªé£å‘éƒ½æœ‰ï¼Œä½†æ˜¯å¤§å¤šé›†ä¸­åœ¨è¥¿åŒ—æ–¹å‘ï¼Œè€Œä¸”ä¹Ÿæ˜¯è¥¿åŒ—æ–¹å‘çš„é£çº§æœ€å¤§; é£çº§ä¸€èˆ¬è¦è¾¾åˆ°5çº§åŠä»¥ä¸Šæ—¶æ‰ä¼šè§¦å‘æ»¡è¶³å¤§é£ç®¡åˆ¶çš„æ¡ä»¶. ",
  "wordCount" : "4766",
  "inLanguage": "zh",
  "image":"https://s2.loli.net/2023/05/20/ops4b9WAYctdHSE.png","datePublished": "2023-05-05T12:20:21+08:00",
  "dateModified": "2023-05-05T12:20:21+08:00",
  "author":[{
    "@type": "Person",
    "name": "Muartz"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://Muatyz.github.io/posts/cs/intro-two-cs-project2/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "æ— å¤„æƒ¹å°˜åŸƒ",
    "logo": {
      "@type": "ImageObject",
      "url": "https://Muatyz.github.io/img/Head32.png"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    (function () {
        let  arr,reg = new RegExp("(^| )"+"change-themes"+"=([^;]*)(;|$)");
        if(arr = document.cookie.match(reg)) {
        } else {
            if (new Date().getHours() >= 19 || new Date().getHours() < 6) {
                document.body.classList.add('dark');
                localStorage.setItem("pref-theme", 'dark');
            } else {
                document.body.classList.remove('dark');
                localStorage.setItem("pref-theme", 'light');
            }
        }
    })()

    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }
</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://Muatyz.github.io/" accesskey="h" title="è®¡ç®—ç‰©ç†å­¦ä¹ æ—¥å¿— (Alt + H)">
            <img src="https://Muatyz.github.io/img/Head64.png" alt="logo" aria-label="logo"
                 height="35">è®¡ç®—ç‰©ç†å­¦ä¹ æ—¥å¿—</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                         stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                         stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://Muatyz.github.io/search" title="ğŸ” æœç´¢ (Alt &#43; /)" accesskey=/>
                <span>ğŸ” æœç´¢</span>
                </a>
            </li>
            <li>
                <a href="https://Muatyz.github.io/" title="ğŸ  ä¸»é¡µ">
                <span>ğŸ  ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://Muatyz.github.io/posts" title="ğŸ“š æ–‡ç« ">
                <span>ğŸ“š æ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://Muatyz.github.io/tags" title="ğŸ§© æ ‡ç­¾">
                <span>ğŸ§© æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://Muatyz.github.io/archives/" title="â±ï¸ æ—¶é—´è½´">
                <span>â±ï¸ æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="https://Muatyz.github.io/about" title="ğŸ™‹ğŸ»â€â™‚ï¸ å…³äº">
                <span>ğŸ™‹ğŸ»â€â™‚ï¸ å…³äº</span>
                </a>
            </li>
            <li>
                <a href="https://Muatyz.github.io/links" title="ğŸ¤ å‹é“¾">
                <span>ğŸ¤ å‹é“¾</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main page">
<style>
    i[id*="post_meta_style"] {
        display: flex;
        align-items: center;
        margin: 0 0 10px 0;
    }
</style>

<article class="post-single">
    <div id="single-content">
        <header class="post-header">
            <div class="breadcrumbs"><a href="https://Muatyz.github.io/">ğŸ  ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href="https://Muatyz.github.io/posts/">ğŸ“šæ–‡ç« </a>&nbsp;Â»&nbsp;<a href="https://Muatyz.github.io/posts/cs/">ğŸ‘¨ğŸ»â€ğŸ’» CS</a></div>
            <h1 class="post-title">
                è¯¾è®¾
            </h1>
            <div class="post-description">
                å¼•èˆªä¸­æ–­ä¼šå¯¼è‡´æ¸¯å£è¿è¥æ•ˆç‡è¾ƒä½, å› æ­¤å¯¹ç»Ÿè®¡æ•°æ®è¿›è¡Œåˆ†æå¯ä»¥å¯¹å¼•èˆªä½œä¸šç‚¹çš„ç§»åŠ¨æä¾›é£é™©è¯„ä¼°å’Œå†³ç­–è¾…åŠ©
            </div>
            <div class="post-meta">

<style>
    i[id*="post_meta_style"] {
        display: flex;
        align-items: center;
        margin: 0 0 10px 0;
    }

    .parent-post-meta {
        display: flex;
        flex-wrap: wrap;
        opacity: 0.8;
    }
</style>

<span class="parent-post-meta">
    <span id="post_meta_style_1">
        <span class="fa fa-calendar-check-o"></span>
        <span>2023-05-05
            &nbsp;&nbsp;
        </span>
    </span>
    
    
    
    
    
    
    
    <span id="post_meta_style_3">
        <span class="fa fa-file-word-o"></span>
        <span>4766å­—
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_4">
        <span class="fa fa-clock-o"></span>
        <span>10åˆ†é’Ÿ
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_5">
        <span class="fa fa-user-o"></span>
        <span>Muartz
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_6">
        <span class="fa fa-tags" style="opacity: 0.8"></span>
        <span>
            <span class="post-tags-meta">
                <a href="https://Muatyz.github.io/tags/data-analysis/" style="color: var(--secondary)!important;">data analysis</a>
                &nbsp;<a href="https://Muatyz.github.io/tags/cs/" style="color: var(--secondary)!important;">cs</a>
            </span>
        </span>
    </span>
</span>
<span style="opacity: 0.8;">
                    <span id="post_meta_style_7">
                        &nbsp;&nbsp;
                        <span class="fa fa-eye" ></span>
                        <span>
                            <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv"></span></span>
                            &nbsp;&nbsp;
                        </span>
                    </span>
                    <span id="post_meta_style_8">
                        <span class="fa fa-commenting-o"></span>
                        <span>
                            <script src="https://cdn.staticfile.org/twikoo/1.6.16/twikoo.all.min.js"></script>
                            <script>
                                let url = document.documentURI
                                
                                let dnsUrl = "https://Muatyz.github.io/"
                                let urlSplit = url.split(dnsUrl)
                                let finalUrl = urlSplit[1]
                                if (finalUrl[0] !== '/') {
                                    finalUrl = '/'+finalUrl
                                }
                                twikoo.getCommentsCount({
                                    envId: "https://www.muartz.com", 
                                region: "ap-shanghai", 
                                urls: [ 
                                    
                                    finalUrl,
                                ],
                                    includeReply: false 
                                }).then(function (res) {
                                    let count = res[0].count
                                    const obj = document.getElementById("comment_count");
                                    obj.innerText = count
                                    
                                    
                                    
                                }).catch(function (err) {
                                    
                                    console.error(err);
                                });
                            </script>
                            <span id="comment_count"></span>
                        </span>
                    </span>
                </span>

</div>
        </header> 
<figure class="entry-cover1"><img style="zoom:50%;" loading="lazy" src="https://s2.loli.net/2023/05/20/ops4b9WAYctdHSE.png" alt="">
    
</figure><aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">ç›®å½•</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e9%97%ae%e9%a2%98%e5%88%86%e6%9e%90" aria-label="é—®é¢˜åˆ†æ">é—®é¢˜åˆ†æ</a></li>
                <li>
                    <a href="#%e8%af%bb%e5%8f%96%e6%95%b0%e6%8d%ae" aria-label="è¯»å–æ•°æ®">è¯»å–æ•°æ®</a></li>
                <li>
                    <a href="#%e5%88%86%e6%9e%90%e6%95%b0%e6%8d%ae" aria-label="åˆ†ææ•°æ®">åˆ†ææ•°æ®</a><ul>
                        
                <li>
                    <a href="#%e9%a3%8e%e5%90%91%e5%88%86%e7%ba%a7%e7%a1%ae%e5%ae%9a%e5%87%86%e5%88%99" aria-label="é£å‘åˆ†çº§ç¡®å®šå‡†åˆ™">é£å‘åˆ†çº§ç¡®å®šå‡†åˆ™</a></li></ul>
                </li>
                <li>
                    <a href="#%e7%bb%93%e8%ae%ba" aria-label="ç»“è®º">ç»“è®º</a>
                </li>
            </ul>
        </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
        
        activeElement = elements[0];
        const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
        document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
    }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 &&
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
            const id = encodeURI(element.getAttribute('id')).toLowerCase();
            if (element === activeElement){
                document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
            } else {
                document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
            }
        })
    }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;
        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;
    }
</script>
        <div class="post-content"><div class="details admonition warning open">

 <div class="details-summary admonition-title">

 <i class="icon fas fa-exclamation-triangle fa-fw"></i>æ¶‰å¯†è­¦å‘Š<i class="details-icon fas fa-angle-right fa-fw"></i>

 </div>

 <div class="details-content">

 <div class="admonition-content">æœ¬æ¬¡è¯¾è®¾æ‰€ä½¿ç”¨çš„åå¹´å¼•èˆªä¸­æ–­ç›¸å…³çš„æ•°æ®å‡ä¸ºæ¶‰å¯†, è€Œæœ¬å°ç»„å…¨ä½“æˆå‘˜å‡å·²ç­¾è®¢ä¿å¯†å¥‘çº¦ä»¥è¿›è¡Œè¯¾è®¾å·¥ä½œ. å› æ­¤ä¸‹é¢æ‰€ä½¿ç”¨çš„ä»£ç ä¸ä¼šå±•ç¤ºä»»ä½•å…·ä½“çš„æ•°æ®, è€Œåªæ˜¯å±•ç¤ºå…¶å·¥ä½œåŸç†.</div>

 </div>

 </div>
<p>æœ¬æ–‡å°†ä»‹ç»æœ¬äººæ‰€è´Ÿè´£çš„<strong>é—®é¢˜ä¸€</strong>éƒ¨åˆ†, å³å¯¹åå¹´çš„å¼•èˆªä¸­æ–­æ•°æ®è¿›è¡Œåˆ†æ, å¹¶ä¸”å¾—å‡ºç›¸åº”çš„ç»“è®º.</p>
<h1 id="é—®é¢˜åˆ†æ">é—®é¢˜åˆ†æ<a hidden class="anchor" aria-hidden="true" href="#é—®é¢˜åˆ†æ">#</a></h1>
<blockquote>
<ul>
<li>é¡¹ç›®æä¾›çš„æ•°æ®é›†ç»™å‡ºäº† 2011-2020 å…± 10 å¹´å‘ç”Ÿå¼•èˆªä¸­æ–­çš„æƒ…å†µç»Ÿè®¡, å…¶ä¸­å¯¼è‡´å¼•èˆªä¸­æ–­çš„åŸå› åŒ…æ‹¬å¤§é£ç®¡åˆ¶å’Œèƒ½è§åº¦ä¸è‰¯ä¸¤ç±», æœ¬é¢˜ä¸­æš‚ä¸è€ƒè™‘èƒ½è§åº¦ä¸è‰¯æƒ…å†µçš„åˆ†æ, åªå…³æ³¨å¤§é£ç®¡åˆ¶çš„åˆ†æ. è¯·ç­›é€‰å‡ºå¤§é£ç®¡åˆ¶çš„æƒ…å†µç»Ÿè®¡, ç»Ÿè®¡å¤§é£ç®¡åˆ¶æ—¥çš„é£å‘ã€é£çº§æƒ…å†µ</li>
</ul>
<blockquote>
<p>æ³¨æ„: é£å‘å’Œé£çº§æƒ…å†µæ¯æ—¥å¯èƒ½ä¸æ˜¯ç¨³å®šçš„, è¯·è®¾è®¡æ•°æ®å¤„ç†è§„åˆ™, èƒ½å¤Ÿæœ‰æ•ˆåœ°ä»£è¡¨å½“æ—¥çš„é£å‘ã€é£çº§æƒ…å†µ.</p>
</blockquote>
<p>è¦æ±‚è¿ç”¨æ•°æ®å¯è§†åŒ–çš„æ–¹æ³•å±•ç¤ºç»Ÿè®¡ç»“æœ, å¹¶æ–‡å­—è¯´æ˜é£å‘å’Œé£çº§çš„æ•°æ®å¤„ç†è§„åˆ™, é™„ XLSX æ–‡ä»¶, åŒ…æ‹¬å…¨éƒ¨å¤§é£ç®¡åˆ¶æ—¥çš„é£å‘å’Œé£çº§. (15 åˆ†)</p>
<ul>
<li>æ ¹æ®ä¸Šä¸€é—®ä¸­çš„åˆ†æ, å»ºæ¨¡åˆ†æä¸åŒé£å‘å’Œé£çº§å¯¹è§¦å‘å¼•èˆªä¸­æ–­çš„å½±å“, è¦æ±‚å±•ç°å‡º 10 å¹´é—´çš„å½±å“æƒ…å†µ, å¹¶ç»™å‡ºè§¦å‘å¼•èˆªä¸­æ–­çš„é£å‘å’Œé£çº§è§„å¾‹(å¯ä»¥æ˜¯å„å› ç´ çš„ç‹¬ç«‹é˜ˆå€¼, ä¹Ÿå¯ä»¥æ˜¯åŒå› ç´ è€¦åˆçš„é˜ˆå€¼). (15 åˆ†)</li>
<li>æ•°æ®æ ·ä¾‹ä»‹ç»ï¼š
<ul>
<li>Sheet 1ï¼š2020å¹´é€šèˆªç®¡åˆ¶æƒ…å†µç»Ÿè®¡è¡¨â€”â€”2020å¹´å¼•èˆªä¸­æ–­æ—¶é—´çš„æ±‡æ€», å…¶ä¸­æœ¬é¢˜åªè€ƒè™‘å¤§é£ç®¡åˆ¶çš„æƒ…å†µ, åˆ†åˆ«åŒ…æ‹¬å¼•èˆªæš‚åœçš„æ—¥æœŸã€æš‚åœèµ·æ­¢æ—¶é—´å’Œæš‚åœæ—¶é•¿.</li>
<li>Sheet 2ï¼š2020å¹´1æœˆ8æ—¥æ´‹å±±æ¸¯æµ·äº‹å±€å·¥ä½œæŠ¥å‘Šâ€”â€”ä½¿ç”¨å…¶ä¸­çš„èˆŸå±±é™„è¿‘æ²¿æµ·å½“æ—¥æ°”è±¡ç®€æŠ¥.</li>
<li>Sheet 3ï¼šè§‚æµ‹çº¿6è­¦æˆ’åŒºâ€”â€”ç»è¿‡è§‚æµ‹çº¿çš„èˆ¹èˆ¶ä¿¡æ¯è®°å½•, ä½¿ç”¨å…¶ä¸­çš„èˆ¹åã€èˆ¹èˆ¶ç§ç±»ã€èˆ¹èˆ¶é•¿åº¦ã€æŠ¥å‘Šçº¿åç§°ã€èˆ¹èˆ¶èˆªå‘ã€èˆ¹èˆ¶èˆªé€Ÿã€ç©¿è¶Šæ—¶é—´ã€ç»åº¦å’Œçº¬åº¦ç­‰ä¿¡æ¯.</li>
</ul>
</li>
</ul>
</blockquote>
<p>è§‚å¯Ÿå‘ç°æ‰€ç»™çš„æ•°æ®è¡¨æ ¼æ ¼å¼ä¸ä¸€, ä¸ºäº†èƒ½å¤Ÿä½¿ç”¨ç»Ÿä¸€æ–¹å¼å¯¹æ•°æ®è¿›è¡ŒæŒ–æ˜å¤„ç†, éœ€è¦å°†æ‰€æœ‰æ–‡ä»¶æ•´åˆä¸º XLSX æ ¼å¼.</p>
<p>æŒ‰å¹´é¡ºåºè¯»å–æºè¡¨æ ¼æ–‡ä»¶å, è¯»å–é¦–é¡µçš„ sheet å¹¶ä¸”è¯»å–å¯¹åº”çš„æ—¥æœŸ. åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­, è¿˜æ¶‰åŠäº†å¯¹äº sheet æ ¼å¼ä¸Šçš„å‰ªè£å¤„ç†å’Œå¯¹å­—ç¬¦ä¸²çš„é‡æ•´åŒ–.</p>
<p>ç”±ä»»åŠ¡è¦æ±‚å¯çŸ¥, éœ€è¦æ•´ç†å¤§é£ç®¡åˆ¶å¼•èµ·çš„å¼•èˆªä¸­æ–­, å› æ­¤å¯ä»¥æå–å¤§é£ç®¡åˆ¶å¯¹åº”çš„æ—¥æœŸå¹¶æŸ¥è¯¢å½“å¤©æµ·é¢çš„å¤©æ°”æƒ…å†µ.</p>
<p>è€Œåœ¨è¯¥ä»»åŠ¡æä¾›çš„æ•°æ®æ–‡ä»¶ä¸­, å¤©æ°”ä¿¡æ¯éƒ½æ˜¯çº¯ç²¹æ–‡æœ¬, æˆ‘ä»¬éœ€è¦å¯¹å…¶ä¸­çš„æœ‰æ•ˆä¿¡æ¯è¿›è¡Œæå–. æ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ä»¬é€‰æ‹©äº†ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œç­›é€‰.</p>
<p>è¯»å–åˆ°å„å¹´å¤§é£ç®¡åˆ¶æ—¥æœŸä¸‹çš„é£å‘é£çº§å, å°±å¯ä»¥ä½¿ç”¨ OriginPro è½¯ä»¶æä¾›çš„ç»˜å›¾åŠŸèƒ½å¯¹(é£å‘, é£çº§)ä¿¡æ¯è¿›è¡Œç»Ÿè®¡å¹¶ä¸”æ€»ç»“è§„å¾‹.</p>
<p>ä»»åŠ¡ä¸€æ‰€æ¶‰åŠçš„ä»£ç æ ¹æ®éœ€æ±‚è¢«åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†:classifier.py, calcute.py. å‰è€…è¿›è¡Œæ•°æ®çš„è¯»å–, åè€…è¿›è¡Œæ•°æ®çš„æ•´ç†.</p>
<h1 id="è¯»å–æ•°æ®">è¯»å–æ•°æ®<a hidden class="anchor" aria-hidden="true" href="#è¯»å–æ•°æ®">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#classifier.py</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#! -*- coding=utf-8 -*-</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> NaN
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> openpyxl
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pyexcel <span style="color:#66d9ef">as</span> p
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> xlwings <span style="color:#66d9ef">as</span> xw
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> shutil
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>years<span style="color:#f92672">=</span>[str(x) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">2011</span>,<span style="color:#ae81ff">2020</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> year <span style="color:#f92672">in</span> years:
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æŒ‰å¹´è¯»å–è¡¨æ ¼æ–‡ä»¶###############################################</span>
</span></span><span style="display:flex;"><span>	parentpath<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;./Project02-Data-31/ä»»åŠ¡ä¸€-å¼•èˆªä¸­æ–­-æ°”è±¡ç»Ÿè®¡æ•°æ®&#34;</span>
</span></span><span style="display:flex;"><span>	path<span style="color:#f92672">=</span>parentpath<span style="color:#f92672">+</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;/&#39;</span><span style="color:#f92672">+</span>year<span style="color:#f92672">+</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;å¹´æ°”è±¡ç»Ÿè®¡.xlsx&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#å°†æ–°çš„mainsheetå†™å…¥åŸæ¥çš„è¡¨æ ¼è€Œä¸åˆ é™¤å…¶ä½™çš„sheet</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> int(year)<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">2019</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">#2019å¹´å’Œ2020å¹´æ–‡ä»¶ä¸º.xlsæ ¼å¼, è½¬ä¸º.xlsxæ ¼å¼</span>
</span></span><span style="display:flex;"><span>		p<span style="color:#f92672">.</span>save_book_as(file_name<span style="color:#f92672">=</span>path[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>],dest_file_name<span style="color:#f92672">=</span>path)
</span></span><span style="display:flex;"><span>		f<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>ExcelFile(path)
</span></span><span style="display:flex;"><span>		wb<span style="color:#f92672">=</span>xw<span style="color:#f92672">.</span>Book(path)
</span></span><span style="display:flex;"><span>		SheetNames<span style="color:#f92672">=</span>f<span style="color:#f92672">.</span>sheet_names
</span></span><span style="display:flex;"><span>		mainsheet<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>read_excel(path,sheet_name<span style="color:#f92672">=</span>SheetNames[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">#å°†sheetæ•´ç†ä¸ºå’Œ2019å¹´ä»¥å‰ç›¸åŒçš„æ ¼å¼ï¼ˆå³åˆ é™¤è¡¨å¤´å¹¶æ—¥æœŸåˆ—è°ƒæ•´è‡³ç¬¬ä¸€åˆ—ï¼‰</span>
</span></span><span style="display:flex;"><span>		mainsheet<span style="color:#f92672">=</span>mainsheet<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">1</span>:,<span style="color:#ae81ff">1</span>:]
</span></span><span style="display:flex;"><span>		orisht<span style="color:#f92672">=</span>wb<span style="color:#f92672">.</span>sheets(SheetNames[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>		orisht<span style="color:#f92672">.</span>delete()
</span></span><span style="display:flex;"><span>		sht<span style="color:#f92672">=</span>wb<span style="color:#f92672">.</span>sheets<span style="color:#f92672">.</span>add(name<span style="color:#f92672">=</span>year<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;å¹´å½±å“é€šèˆª&#39;</span>,before<span style="color:#f92672">=</span>SheetNames[<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>		sht<span style="color:#f92672">.</span>range(<span style="color:#e6db74">&#39;A1&#39;</span>)<span style="color:#f92672">.</span>value<span style="color:#f92672">=</span>mainsheet<span style="color:#f92672">.</span>values
</span></span><span style="display:flex;"><span>		wb<span style="color:#f92672">.</span>save(year<span style="color:#f92672">+</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;å¹´æ°”è±¡ç»Ÿè®¡.xlsx&#34;</span>)
</span></span><span style="display:flex;"><span>		wb<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>		file<span style="color:#f92672">=</span>year<span style="color:#f92672">+</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;å¹´æ°”è±¡ç»Ÿè®¡.xlsx&#34;</span>
</span></span><span style="display:flex;"><span>		shutil<span style="color:#f92672">.</span>copy(file,parentpath)<span style="color:#75715e">#å°†ç”Ÿæˆçš„æ–‡ä»¶è¦†ç›–åœ¨æºæ–‡ä»¶ä¸Š</span>
</span></span><span style="display:flex;"><span>			
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#########################################################</span>
</span></span><span style="display:flex;"><span>	f<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>ExcelFile(path)
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#è·å–å·¥ä½œè¡¨åç§°</span>
</span></span><span style="display:flex;"><span>	SheetNames<span style="color:#f92672">=</span>f<span style="color:#f92672">.</span>sheet_names
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#æ£€æŸ¥æ˜¯å¦è¯»å–æˆåŠŸ</span>
</span></span><span style="display:flex;"><span>	print(SheetNames)
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#è¯»å–ç¬¬ä¸€å¼ sheet</span>
</span></span><span style="display:flex;"><span>	mainsheet<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>read_excel(path,sheet_name<span style="color:#f92672">=</span>year<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;å¹´å½±å“é€šèˆª&#39;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#è¯»å–ç¬¬ä¸€é¡µçš„æ–‡ä»¶å¹¶è·å¾—ä¸€äº›åŸºæœ¬æ•°æ®</span>
</span></span><span style="display:flex;"><span>	rowNum<span style="color:#f92672">=</span>mainsheet<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#è¯»å–ç¬¬ä¸€é¡µsheetçš„ç¬¬ä¸€äºŒåˆ—çš„æœ‰æ•ˆæ•°æ®</span>
</span></span><span style="display:flex;"><span>	datePlus<span style="color:#f92672">=</span>mainsheet<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">2</span>:rowNum<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>,[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>]]
</span></span><span style="display:flex;"><span>	datePlus<span style="color:#f92672">=</span>datePlus<span style="color:#f92672">.</span>dropna(axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;any&#39;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#è·å–å½“å¹´å¤§é£ç®¡åˆ¶æ—¥æœŸ</span>
</span></span><span style="display:flex;"><span>	date<span style="color:#f92672">=</span>datePlus<span style="color:#f92672">.</span>iloc[:,<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#æ£€æŸ¥è¯»å–çš„å¤§é£ç®¡åˆ¶æ—¶é—´æ®µ</span>
</span></span><span style="display:flex;"><span>	print(date)
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#å°†æ—¶é—´æ®µæ‹†åˆ†ä¸ºå•å¤©</span>
</span></span><span style="display:flex;"><span>	Date<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(date<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>]):
</span></span><span style="display:flex;"><span>		date<span style="color:#f92672">.</span>iloc[i]<span style="color:#f92672">=</span>date<span style="color:#f92672">.</span>iloc[i][<span style="color:#ae81ff">5</span>:]
</span></span><span style="display:flex;"><span>		series<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;-&#39;</span> <span style="color:#f92672">in</span> date<span style="color:#f92672">.</span>iloc[i]:
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">###########å¯¹.å’Œ-è¿›è¡Œå®šä½###############</span>
</span></span><span style="display:flex;"><span>			loc1<span style="color:#f92672">=</span>date<span style="color:#f92672">.</span>iloc[i]<span style="color:#f92672">.</span>index(<span style="color:#e6db74">&#39;.&#39;</span>)
</span></span><span style="display:flex;"><span>			loc2<span style="color:#f92672">=</span>date<span style="color:#f92672">.</span>iloc[i]<span style="color:#f92672">.</span>index(<span style="color:#e6db74">&#39;-&#39;</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">######æ³¨æ„å»é™¤æ—¥æœŸå•å…ƒæ ¼ä¸­å¶å°”å‡ºç°çš„ä¸­æ–‡##</span>
</span></span><span style="display:flex;"><span>			begin<span style="color:#f92672">=</span>int(re<span style="color:#f92672">.</span>sub(<span style="color:#e6db74">&#39;[</span><span style="color:#ae81ff">\u4e00</span><span style="color:#e6db74">-</span><span style="color:#ae81ff">\u9fa5</span><span style="color:#e6db74">]&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>,date<span style="color:#f92672">.</span>iloc[i][loc1<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>:loc2]))
</span></span><span style="display:flex;"><span>			end<span style="color:#f92672">=</span>int(re<span style="color:#f92672">.</span>sub(<span style="color:#e6db74">&#39;[</span><span style="color:#ae81ff">\u4e00</span><span style="color:#e6db74">-</span><span style="color:#ae81ff">\u9fa5</span><span style="color:#e6db74">]&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>,date<span style="color:#f92672">.</span>iloc[i][loc2<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>:]))
</span></span><span style="display:flex;"><span>			month<span style="color:#f92672">=</span>str(re<span style="color:#f92672">.</span>sub(<span style="color:#e6db74">&#39;[</span><span style="color:#ae81ff">\u4e00</span><span style="color:#e6db74">-</span><span style="color:#ae81ff">\u9fa5</span><span style="color:#e6db74">]&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>,date<span style="color:#f92672">.</span>iloc[i][:loc1<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]))
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(begin,end<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">if</span> month<span style="color:#f92672">+</span>str(j) <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> Date:
</span></span><span style="display:flex;"><span>					<span style="color:#75715e">#############é¿å…é‡å¤ç™»è®°å·²ç»ç™»è®°è¿‡çš„æ—¥æœŸ#######</span>
</span></span><span style="display:flex;"><span>					Date<span style="color:#f92672">.</span>append(month<span style="color:#f92672">+</span>str(j))
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>			Date<span style="color:#f92672">.</span>append(str(re<span style="color:#f92672">.</span>sub(<span style="color:#e6db74">&#39;[</span><span style="color:#ae81ff">\u4e00</span><span style="color:#e6db74">-</span><span style="color:#ae81ff">\u9fa5</span><span style="color:#e6db74">]&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>,date<span style="color:#f92672">.</span>iloc[i])))
</span></span><span style="display:flex;"><span>	date<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame(date)
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#æ£€æŸ¥å»å¹´ä»½æ˜¯å¦æˆåŠŸ</span>
</span></span><span style="display:flex;"><span>	print(date)
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#æ£€æŸ¥çœŸæ­£çš„æ—¥æœŸåºåˆ—æ˜¯å¦ç”ŸæˆæˆåŠŸ</span>
</span></span><span style="display:flex;"><span>	print(Date)
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">########ä»¥ç”Ÿæˆçš„æ—¥æœŸä¾æ¬¡æŸ¥è¯¢å½“å¹´çš„é£å‘é£çº§çš„æƒ…å†µ###########</span>
</span></span><span style="display:flex;"><span>	Time<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>	Land<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#æµ·é¢çš„å¤©æ°”ä¿¡æ¯ç›¸è¾ƒäºé™†åœ°çš„å¯¹å¼•èˆªä¸­æ–­åº”å½“æ›´ç›´æ¥</span>
</span></span><span style="display:flex;"><span>	Sea<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> day <span style="color:#f92672">in</span> Date:
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">		è¯¥ç‰ˆæœ¬ä¸ºå®Œå…¨æ’é™¤ç©ºæ—¥æœŸ(æ— æ³•ç”±Dateç›´æ¥æŸ¥è¯¢åˆ°çš„æ—¥æœŸ)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">		&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> day <span style="color:#f92672">in</span> SheetNames:
</span></span><span style="display:flex;"><span>			Sheet<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>read_excel(path,sheet_name<span style="color:#f92672">=</span>day)
</span></span><span style="display:flex;"><span>			Time<span style="color:#f92672">.</span>append(day)
</span></span><span style="display:flex;"><span>			Land<span style="color:#f92672">.</span>append(Sheet<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>			Sea<span style="color:#f92672">.</span>append(Sheet<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æœ€ä¸¥è°¨çš„æ–¹å¼æ˜¯å¦‚æœè¿™ä¸€å¤©æ²¡æœ‰è¯»å–åˆ°, åº”å½“å†è¯»å–å‰ä¸€å¤©å¤©æ°”ä¸­&#34;æ˜å¤©&#34;çš„ä¿¡æ¯</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#ä½†æ˜¯å¤©æ°”çš„è®°å½•æ ¼å¼ä¸ä¸€, æ‰€ä»¥è¿™é‡Œé€‰æ‹©è‹¥æ²¡æœ‰è¯¥å¤©çš„å¤©æ°”è®°å½•, å°±é€‰æ‹©ä¸å½•å…¥</span>
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#åˆ›å»ºæ—¶é—´å’Œå¤©æ°”å…³ç³»çš„å­—å…¸å¹¶ç”Ÿæˆè¡¨æ ¼</span>
</span></span><span style="display:flex;"><span>	dic<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;Day&#39;</span>:Time,<span style="color:#e6db74">&#39;Land&#39;</span>:Land,<span style="color:#e6db74">&#39;Sea&#39;</span>:Sea}
</span></span><span style="display:flex;"><span>	Ori<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame(dic)
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#æ£€æŸ¥ç”Ÿæˆé£å‘é£çº§åŸå§‹æ•°æ®è¡¨æ˜¯å¦æˆåŠŸ</span>
</span></span><span style="display:flex;"><span>	print(Ori)
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#######æ–‡æœ¬å¤„ç†ç¨‹åº, è¯»å–åŸå§‹æ•°æ®ä¸­çš„é£å‘å’Œé£çº§ä¿¡æ¯###############</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#åˆ›å»ºç©ºè¡¨æ ¼ä»¥å¤‡è¯»å†™</span>
</span></span><span style="display:flex;"><span>	tmp<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame()
</span></span><span style="display:flex;"><span>	processedPath<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;./ProcessedData/ProcessedData&#39;</span><span style="color:#f92672">+</span>year<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;.xlsx&#39;</span>
</span></span><span style="display:flex;"><span>	tmpFile<span style="color:#f92672">=</span>tmp<span style="color:#f92672">.</span>to_excel(processedPath)
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œä¿¡æ¯è¯»å–</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> orisentence <span style="color:#f92672">in</span> Sea:
</span></span><span style="display:flex;"><span>		WeatherDay<span style="color:#f92672">=</span>str(Time[Sea<span style="color:#f92672">.</span>index(orisentence)])
</span></span><span style="display:flex;"><span>		law<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;([ä»Š|æ˜|å]å¤©)?([ä¸œ|è¥¿|å]?[å—|åŒ—|ä¸œ|è¥¿]?)?[åˆ°]?([ä¸œ|è¥¿|å]?[å—|åŒ—|ä¸œ|è¥¿|é˜µ]?)?é£(\d)[\-]?([\d]?)çº§&#34;</span>
</span></span><span style="display:flex;"><span>		Weather<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>findall(law,orisentence,re<span style="color:#f92672">.</span>S)
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">æ­¤å¤„ä½¿ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œå¤©æ°”ä¿¡æ¯çš„ç­›é€‰, ä¸¥æ ¼æ¥è¯´åº”è¯¥ç¼–è¾‘çŠ¶æ€è‡ªåŠ¨æœºè¿›è¡Œè¯»å–. 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">ä½†æ˜¯ç”±äºå¤©æ°”ä¿¡æ¯çš„æ’°å†™æ–¹å¼å®åœ¨ä¸ä¸€, æ‰€ä»¥é€‰ç”¨äº†ä¸€ä¸ªé€šç”¨æ€§è¾ƒé«˜çš„æ–¹æ³•. 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">è‹¥ç”¨Pytorchè¿›è¡Œè¯­è¨€å¤„ç†åº”å½“æ˜¯æœ€ä¸“ä¸šçš„, é™äºèƒ½åŠ›æ°´å¹³å¹¶æœªä½¿ç”¨. 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">		&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> Weather:
</span></span><span style="display:flex;"><span>			day<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">#é£å‘å¯èƒ½ä¼šå‘ç”Ÿæ”¹å˜, å¦‚&#34;ä¸œåˆ°ä¸œåŒ—é£&#34;ç­‰</span>
</span></span><span style="display:flex;"><span>			diraction1<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>			diraction2<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">#è®°å½•æœ€å°é£çº§å’Œæœ€å¤§é£çº§</span>
</span></span><span style="display:flex;"><span>			minscale<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>			maxscale<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(Weather)):
</span></span><span style="display:flex;"><span>				day<span style="color:#f92672">.</span>append(Weather[i][<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>				<span style="color:#75715e">#è‹¥æœ‰ç©ºç™½éƒ¨åˆ†, åˆ™ä»å¦ä¸€éƒ¨åˆ†å¤åˆ¶æ•°æ®#</span>
</span></span><span style="display:flex;"><span>				<span style="color:#75715e">############é£å‘éƒ¨åˆ†çš„ç©ºç™½å¡«å……#############</span>
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">if</span> Weather[i][<span style="color:#ae81ff">2</span>]<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;&#39;</span>:
</span></span><span style="display:flex;"><span>					diraction1<span style="color:#f92672">.</span>append(Weather[i][<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>					diraction2<span style="color:#f92672">.</span>append(Weather[i][<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">elif</span> Weather[i][<span style="color:#ae81ff">2</span>]<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;&#39;</span>:
</span></span><span style="display:flex;"><span>					diraction1<span style="color:#f92672">.</span>append(Weather[i][<span style="color:#ae81ff">2</span>])
</span></span><span style="display:flex;"><span>					diraction2<span style="color:#f92672">.</span>append(Weather[i][<span style="color:#ae81ff">2</span>])
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>					diraction1<span style="color:#f92672">.</span>append(Weather[i][<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>					diraction2<span style="color:#f92672">.</span>append(Weather[i][<span style="color:#ae81ff">2</span>])
</span></span><span style="display:flex;"><span>				<span style="color:#75715e">##############é£çº§éƒ¨åˆ†çš„ç©ºç™½å¡«å……##########</span>
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">if</span> Weather[i][<span style="color:#ae81ff">4</span>]<span style="color:#f92672">!=</span><span style="color:#e6db74">&#39;&#39;</span> <span style="color:#f92672">and</span> int(Weather[i][<span style="color:#ae81ff">3</span>])<span style="color:#f92672">&gt;</span>int(Weather[i][<span style="color:#ae81ff">4</span>]):
</span></span><span style="display:flex;"><span>					<span style="color:#75715e">#æ’é™¤è¯»åˆ°10çš„æ—¶å€™å°†1å’Œ0æ‹†å¼€</span>
</span></span><span style="display:flex;"><span>					minscale<span style="color:#f92672">.</span>append(str(Weather[i][<span style="color:#ae81ff">3</span>])<span style="color:#f92672">+</span>str(Weather[i][<span style="color:#ae81ff">4</span>]))
</span></span><span style="display:flex;"><span>					maxscale<span style="color:#f92672">.</span>append(str(Weather[i][<span style="color:#ae81ff">3</span>])<span style="color:#f92672">+</span>str(Weather[i][<span style="color:#ae81ff">4</span>]))
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">elif</span> Weather[i][<span style="color:#ae81ff">4</span>]<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;&#39;</span>:
</span></span><span style="display:flex;"><span>							<span style="color:#75715e">#å¯¹ä»…æœ‰ä¸€ä¸ªæ•°å­—çš„è¿›è¡Œå¤åˆ¶ç²˜è´´å¤„ç†</span>
</span></span><span style="display:flex;"><span>					minscale<span style="color:#f92672">.</span>append(str(Weather[i][<span style="color:#ae81ff">3</span>]))
</span></span><span style="display:flex;"><span>					maxscale<span style="color:#f92672">.</span>append(str(Weather[i][<span style="color:#ae81ff">3</span>]))
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>					<span style="color:#75715e">#å…¶ä»–æƒ…å†µæ­£å¸¸å…¥ä½</span>
</span></span><span style="display:flex;"><span>					minscale<span style="color:#f92672">.</span>append(str(Weather[i][<span style="color:#ae81ff">3</span>]))
</span></span><span style="display:flex;"><span>					maxscale<span style="color:#f92672">.</span>append(str(Weather[i][<span style="color:#ae81ff">4</span>]))
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">#ç”Ÿæˆæ—¥æœŸå’Œå¤©æ°”å…³ç³»çš„å­—å…¸å¹¶ç”Ÿæˆè¡¨æ ¼</span>
</span></span><span style="display:flex;"><span>		weatherdic<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;æ—¥æœŸ&#39;</span>:day,<span style="color:#e6db74">&#39;é£å‘1&#39;</span>:diraction1,<span style="color:#e6db74">&#39;é£å‘2&#39;</span>:diraction2,<span style="color:#e6db74">&#39;å°é£çº§&#39;</span>:minscale,<span style="color:#e6db74">&#39;å¤§é£çº§&#39;</span>:maxscale}
</span></span><span style="display:flex;"><span>		df<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame(weatherdic)
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">#åœ¨è¯¥æ–‡ä»¶ä¸­ä¾æ¬¡åˆ›å»ºæ–°worksheet,å¡«å…¥ç›¸åº”çš„df</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">with</span> pd<span style="color:#f92672">.</span>ExcelWriter(processedPath,mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;a&#39;</span>) <span style="color:#66d9ef">as</span> writer:
</span></span><span style="display:flex;"><span>			df<span style="color:#f92672">.</span>to_excel(writer,sheet_name<span style="color:#f92672">=</span>WeatherDay)
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#æ¸…ç†è¯»å†™æœŸé—´äº§ç”Ÿçš„æ— ç”¨sheet(å³Sheet1)</span>
</span></span><span style="display:flex;"><span>	processedExcel<span style="color:#f92672">=</span>openpyxl<span style="color:#f92672">.</span>load_workbook(processedPath)
</span></span><span style="display:flex;"><span>	wastedSheet<span style="color:#f92672">=</span>processedExcel[<span style="color:#e6db74">&#39;Sheet1&#39;</span>]
</span></span><span style="display:flex;"><span>	processedExcel<span style="color:#f92672">.</span>remove(wastedSheet)
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#å°†è¯»å†™å®Œæ¯•çš„è¡¨æ ¼å­˜å‚¨èµ·æ¥</span>
</span></span><span style="display:flex;"><span>	processedExcel<span style="color:#f92672">.</span>save(processedPath)
</span></span></code></pre></div><h1 id="åˆ†ææ•°æ®">åˆ†ææ•°æ®<a hidden class="anchor" aria-hidden="true" href="#åˆ†ææ•°æ®">#</a></h1>
<h2 id="é£å‘åˆ†çº§ç¡®å®šå‡†åˆ™">é£å‘åˆ†çº§ç¡®å®šå‡†åˆ™<a hidden class="anchor" aria-hidden="true" href="#é£å‘åˆ†çº§ç¡®å®šå‡†åˆ™">#</a></h2>
<p>ç”±ä¸Šè¿°çš„ä»£ç ä¸éš¾çœ‹å‡º, å¯¹äºä¸€æ®µæºæ–‡ä»¶çš„å¤©æ°”ä¿¡æ¯æ–‡æœ¬, å³ä½¿æ˜¯åŒä¸€æ­£åˆ™è¡¨è¾¾å¼ä¹Ÿå¯èƒ½ä¼šè¯»å‡ºå¤šæ¡ç»“æœ. æœ‰çš„æ˜¯åŒä¸€å¤©å†…çš„å¤šæ¡æ•°æ®, æœ‰çš„æ˜¯ä¸åŒå¤©é‡Œçš„æ•°æ®(è¿™æ˜¯å› ä¸ºæŸäº›æ—¥æœŸçš„æ•°æ®å¹¶ä¸å­˜åœ¨äºå¯¹åº”çš„å¤§é£ç®¡åˆ¶æ—¥æœŸçš„è¡¨æ ¼ä¸­, è€Œæ˜¯å­˜åœ¨äºæŸäº›ç›¸é‚»çš„å¤§é£ç®¡åˆ¶æ—¥æœŸ.)</p>
<p>æ‰€ä»¥æˆ‘ä»¬æ”¶é›†å¤©æ°”çš„ç­–ç•¥æ˜¯: å·²çŸ¥å¤§é£ç®¡åˆ¶æœŸé—´çš„å¤©æ°”è®°å½•å¹¶ä¸æ­¢ä¸€å¤©, ç»“åˆæ­£åˆ™è¡¨è¾¾å¼çš„è¯»å–æ•ˆæœ, å°†è¯»å–æ•°æ®çš„ç¬¬ä¸€å¤©å’Œç¬¬äºŒå¤©ä¹‹é—´çš„æ‰€æœ‰æ•°æ®ï¼›
ç„¶åé£çº§å°±æ˜¯é£å‘æ•°æ®çš„æœ€å¤§å€¼å’Œæœ€å°å€¼, é£å‘åˆ™æ˜¯è¿™äº›æ•°æ®çš„ç¬¬ä¸€å¯¹(è®°å½•æ•°æ®æ—¶, é£å‘å¯èƒ½ä¼šä»¥&quot;ä¸œåˆ°ä¸œåŒ—é£&quot;çš„æ–¹å¼å‘ˆç°, æ‰€ä»¥é£å‘ä¼šä»¥æˆå¯¹çš„å½¢å¼è®°å½•ä¸‹æ¥. è‡³äºæœ¬æ¥å°±åªæœ‰ä¸€ä¸ªé£å‘çš„, å°±è§†ä¸ºè¿™ä¸€å¯¹é£å‘çš„ä¸¤ä¸ªå…ƒç´ éƒ½æ˜¯ç›¸åŒçš„).</p>
<p>è™½ç„¶è¿™æ ·çš„å¤„ç†å¯èƒ½çœ‹ä¼¼æœ‰äº›è‰ç‡, ä½†æ˜¯ç»“åˆå…·ä½“çš„å¤©æ°”ä¿¡æ¯æ–‡æœ¬ä¸éš¾çœ‹å‡º, å‡ºç°å¼‚å¸¸æƒ…å†µå¾€å¾€éƒ½æ˜¯éƒ½ä¼šæ˜¯æ—¥æœŸè¿æŠ¥(å¦‚&rsquo;ä»Šå¤©ã€æ˜å¤©ä¸œåˆ°ä¸œåŒ—é£&rsquo;), è€Œä¸”å¤§é£ç®¡åˆ¶çš„æ—¥æœŸä¹Ÿæœ‰å¯èƒ½æ˜¯è¿ç»­çš„, æ‰€ä»¥å³ä½¿æŒ‰ç…§ä¸Šæ–‡æ‰€è¿°çš„æ¨¡ç³Šè¯†åˆ«æ–¹æ³•, ä¹Ÿæ˜¯æœ‰ä¸€å®šè¯æ®æ”¯æ’‘çš„.</p>
<p>ä¸‹é¢æ˜¯å…·ä½“çš„ä»£ç å®ç°:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#! -*- coding=utf-8 -*-</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> NAN, NaN, nan
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#######################è¯»å–çœŸæ­£çš„é£å‘é£çº§##################</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#é€å¹´è¯»å–å·²ç»ç”Ÿæˆå®Œæ¯•çš„æ—¥æœŸ-å¤©æ°”è¡¨æ ¼</span>
</span></span><span style="display:flex;"><span>	years<span style="color:#f92672">=</span>[str(x) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">2011</span>,<span style="color:#ae81ff">2020</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)]
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#é¢„å…ˆåˆ†é…listä»¥å­˜å‚¨è¯»å–çš„å¯¹åº”æ•°æ®</span>
</span></span><span style="display:flex;"><span>	Time<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>	Diraction1<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>	Diraction2<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>	minScale<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>	maxScale<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> year <span style="color:#f92672">in</span> years:
</span></span><span style="display:flex;"><span>		processedPath<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;./ProcessedData/ProcessedData&#39;</span><span style="color:#f92672">+</span>year<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;.xlsx&#39;</span>
</span></span><span style="display:flex;"><span>		f<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>ExcelFile(processedPath)
</span></span><span style="display:flex;"><span>		SheetNames<span style="color:#f92672">=</span>f<span style="color:#f92672">.</span>sheet_names
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">#æŒ‰å¤©è¯»å–å½“å¤©çš„é£å‘é£çº§</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">for</span> day <span style="color:#f92672">in</span> SheetNames:
</span></span><span style="display:flex;"><span>			sht<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>read_excel(processedPath,sheet_name<span style="color:#f92672">=</span>day)
</span></span><span style="display:flex;"><span>			date<span style="color:#f92672">=</span>list(sht[<span style="color:#e6db74">&#39;æ—¥æœŸ&#39;</span>]<span style="color:#f92672">.</span>values)
</span></span><span style="display:flex;"><span>			dira1<span style="color:#f92672">=</span>list(sht[<span style="color:#e6db74">&#39;é£å‘1&#39;</span>]<span style="color:#f92672">.</span>values)
</span></span><span style="display:flex;"><span>			dira2<span style="color:#f92672">=</span>list(sht[<span style="color:#e6db74">&#39;é£å‘2&#39;</span>]<span style="color:#f92672">.</span>values)
</span></span><span style="display:flex;"><span>			scale1<span style="color:#f92672">=</span>list(sht[<span style="color:#e6db74">&#39;å°é£çº§&#39;</span>]<span style="color:#f92672">.</span>values)
</span></span><span style="display:flex;"><span>			scale2<span style="color:#f92672">=</span>list(sht[<span style="color:#e6db74">&#39;å¤§é£çº§&#39;</span>]<span style="color:#f92672">.</span>values)
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">#å»é™¤ç©ºç™½æ—¥æœŸï¼Œå³è®°å½•åœ¨&#39;æ—¥æœŸ&#39;åˆ—é‡Œå®é™…è®°å½•çš„å¤©æ•°(ä»Šå¤©ï¼Œæ˜å¤©æˆ–åå¤©)</span>
</span></span><span style="display:flex;"><span>			date_brief<span style="color:#f92672">=</span>[sing <span style="color:#66d9ef">for</span> sing <span style="color:#f92672">in</span> date <span style="color:#66d9ef">if</span> sing<span style="color:#f92672">==</span>sing]
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">#è®°å½•æ—¥æœŸæ‰€åœ¨ä½ç½®çš„ç´¢å¼•</span>
</span></span><span style="display:flex;"><span>			date_index<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">for</span> sing <span style="color:#f92672">in</span> date_brief:
</span></span><span style="display:flex;"><span>				date_index<span style="color:#f92672">.</span>append(date<span style="color:#f92672">.</span>index(sing))
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">if</span> len(date_brief)<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>				<span style="color:#75715e">#è‹¥è®°å½•åœ¨åˆ—çš„åªæœ‰ä¸€å¤©ï¼Œé‚£ä¹ˆæ— è®ºè¿™ä¸€å¤©æ˜¯å“ªä¸€å¤©éƒ½å°†å…¶ä½œä¸ºå½“å¤©çš„æ•°æ®</span>
</span></span><span style="display:flex;"><span>				diraction1<span style="color:#f92672">=</span>dira1[date_index[<span style="color:#ae81ff">0</span>]:]
</span></span><span style="display:flex;"><span>				diraction2<span style="color:#f92672">=</span>dira2[date_index[<span style="color:#ae81ff">0</span>]:]
</span></span><span style="display:flex;"><span>				minscale<span style="color:#f92672">=</span>min(scale1[date_index[<span style="color:#ae81ff">0</span>]:])
</span></span><span style="display:flex;"><span>				maxscale<span style="color:#f92672">=</span>max(scale2[date_index[<span style="color:#ae81ff">0</span>]:])
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">#è®°å½•çš„ä¸æ­¢ä¸€å¤©çš„æ—¶å€™ï¼Œå°±å°†ç¬¬ä¸€å¤©å’Œç¬¬äºŒå¤©ä¹‹é—´çš„æ•°æ®æ”¶é›†èµ·æ¥</span>
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">#å³ï¼Œæœ‰å¯èƒ½è¯»å–åˆ°çš„æ˜¯&#34;ä»Šå¤©ï¼Œåå¤©&#34;,é‚£ä¹ˆä¹Ÿä¼šè®°å½•è¿™ä¸¤è€…ä¹‹é—´çš„æ‰€æœ‰æ•°æ®</span>
</span></span><span style="display:flex;"><span>				diraction1<span style="color:#f92672">=</span>dira1[date_index[<span style="color:#ae81ff">0</span>]:date_index[<span style="color:#ae81ff">1</span>]]
</span></span><span style="display:flex;"><span>				diraction2<span style="color:#f92672">=</span>dira2[date_index[<span style="color:#ae81ff">0</span>]:date_index[<span style="color:#ae81ff">1</span>]]
</span></span><span style="display:flex;"><span>				minscale<span style="color:#f92672">=</span>min(scale1[date_index[<span style="color:#ae81ff">0</span>]:date_index[<span style="color:#ae81ff">1</span>]])
</span></span><span style="display:flex;"><span>				maxscale<span style="color:#f92672">=</span>max(scale2[date_index[<span style="color:#ae81ff">0</span>]:date_index[<span style="color:#ae81ff">1</span>]])
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">#é¢„å…ˆåˆ†é…listå¯¹é£å‘çš„ä¸¤ä¸ªæ–¹å‘è¿›è¡Œå­˜å‚¨</span>
</span></span><span style="display:flex;"><span>			d1list<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>			d2list<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">#è®°å½•é£å‘é£çº§æ—¶å…ˆè®°å½•å¯¹åº”å¤©çš„æ—¥æœŸï¼Œä¸ºäº†é¿å…é‡å¤è¿˜è¦åŠ ä¸Šå¹´ä»½çš„ä¿¡æ¯</span>
</span></span><span style="display:flex;"><span>			Time<span style="color:#f92672">.</span>append(year<span style="color:#f92672">+</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;.&#39;</span><span style="color:#f92672">+</span>day)
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">#åœ¨æ•°æ®ä¸­ä¼šæœ‰ç©ºæ ¼å’Œ&#39;é˜µ&#39;çš„æ•°æ®ï¼ŒæŒ‰ç…§æˆ‘ä»¬å¯¹äºåœ°ç†çš„ç†è§£å³é˜µé£ä¸ºæœ€å¤§é£çº§</span>
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">#æ‰€ä»¥åœ¨è®°å½•æ—¶ï¼Œå°†ä¸¤å¤©ä¹‹é—´çš„æ‰€æœ‰é£çº§è¿›è¡Œæ¯”è¾ƒï¼Œé˜µé£ä¸ºæœ€å¤§å€¼æ‰€ä»¥å¿…å®šåŒ…æ‹¬åœ¨æ¯”è¾ƒå½“ä¸­</span>
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">for</span> d1 <span style="color:#f92672">in</span> diraction1:
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">if</span> str(d1)<span style="color:#f92672">!=</span><span style="color:#e6db74">&#39;nan&#39;</span> <span style="color:#f92672">and</span> str(d1)<span style="color:#f92672">!=</span><span style="color:#e6db74">&#39;é˜µ&#39;</span>:
</span></span><span style="display:flex;"><span>					d1list<span style="color:#f92672">.</span>append(str(d1))
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">for</span> d2 <span style="color:#f92672">in</span> diraction2:
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">if</span> str(d2)<span style="color:#f92672">!=</span><span style="color:#e6db74">&#39;nan&#39;</span> <span style="color:#f92672">and</span> str(d2)<span style="color:#f92672">!=</span><span style="color:#e6db74">&#39;é˜µ&#39;</span>:
</span></span><span style="display:flex;"><span>					d2list<span style="color:#f92672">.</span>append(str(d2))
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">#å®Œæˆå¯¹äºæ•°æ®çš„æ¸…ç†ä¹‹åï¼Œè¯»å–é£å‘çš„è§„åˆ™å³ä¸ºå…¶ä¸­çš„ç¬¬ä¸€æ¬¡é£å‘ä¿¡æ¯çš„ç»“æœ</span>
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">#å³ï¼Œå¿½ç•¥äº†éšç€æ—¶é—´å˜åŒ–é£å‘ä¿¡æ¯éšä¹‹å˜åŒ–çš„è¿‡ç¨‹ã€‚</span>
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">#æœ€ä¸¥è°¨çš„æ–¹æ³•æ˜¯ç»“åˆå¤©æ°”è®°å½•æ¡£æ¡ˆçš„æœ€ä¸‹æ–¹çš„å¼•èˆªä¸­æ–­æ—¶é—´(ä¸­åˆæˆ–è€…ä¸‹åˆ)æ¥åˆ¤æ–­</span>
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">#æœ€æ­£ç¡®çš„æ—¶é—´ï¼Œä½†æ˜¯ä»…ä»…å€ŸåŠ©æ­£åˆ™è¡¨è¾¾å¼è¿™ä¸ªä»»åŠ¡æ˜¯å¼‚å¸¸å›°éš¾çš„</span>
</span></span><span style="display:flex;"><span>			Diraction1<span style="color:#f92672">.</span>append(d1list[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;å&#39;</span>,<span style="color:#e6db74">&#39;&#39;</span>))
</span></span><span style="display:flex;"><span>			Diraction2<span style="color:#f92672">.</span>append(d2list[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;å&#39;</span>,<span style="color:#e6db74">&#39;&#39;</span>))
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">#åœ¨ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¯»å–é£å‘çš„æ—¶å€™ï¼Œä¼šè¯»è¿›&#39;å&#39;å­—ç¬¦</span>
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">#åœ¨è¿›è¡Œæ•°æ®å¤„ç†æ—¶åˆ™å°†åå­—å»é™¤ä»¥å¤‡åæœŸè¿›è¡Œå­—å…¸ä»£æ¢</span>
</span></span><span style="display:flex;"><span>			minScale<span style="color:#f92672">.</span>append(minscale)
</span></span><span style="display:flex;"><span>			maxScale<span style="color:#f92672">.</span>append(maxscale)
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#æ‰‹åŠ¨å†™å…¥æ–¹å‘å’Œåº¦æ•°çš„å¯¹åº”å­—å…¸</span>
</span></span><span style="display:flex;"><span>	word_to_num<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;ä¸œ&#39;</span>:<span style="color:#ae81ff">0</span>,<span style="color:#e6db74">&#39;è¥¿&#39;</span>:<span style="color:#ae81ff">180</span>,<span style="color:#e6db74">&#39;å—&#39;</span>:<span style="color:#ae81ff">270</span>,<span style="color:#e6db74">&#39;åŒ—&#39;</span>:<span style="color:#ae81ff">90</span>,<span style="color:#e6db74">&#39;ä¸œå—&#39;</span>:<span style="color:#ae81ff">315</span>,<span style="color:#e6db74">&#39;ä¸œåŒ—&#39;</span>:<span style="color:#ae81ff">45</span>,<span style="color:#e6db74">&#39;è¥¿å—&#39;</span>:<span style="color:#ae81ff">225</span>,<span style="color:#e6db74">&#39;è¥¿åŒ—&#39;</span>:<span style="color:#ae81ff">135</span>}
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#é¢„å…ˆåˆ†é…è¯»å…¥è¯»æ•°çš„list</span>
</span></span><span style="display:flex;"><span>	Diraction1_num<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>	Diraction2_num<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#ä½¿ç”¨å·²å†™å¥½çš„å­—å…¸å¯¹æ–¹å‘è¿›è¡Œä»£æ¢</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(Time)):
</span></span><span style="display:flex;"><span>		Diraction1_num<span style="color:#f92672">.</span>append(word_to_num[Diraction1[i]])
</span></span><span style="display:flex;"><span>		Diraction2_num<span style="color:#f92672">.</span>append(word_to_num[Diraction2[i]])
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#ç”Ÿæˆæ–°å­—å…¸å¹¶ä¸”ç”Ÿæˆè¡¨æ ¼</span>
</span></span><span style="display:flex;"><span>	dira_and_scale<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;æ—¥æœŸ&#39;</span>:Time,<span style="color:#e6db74">&#39;é£å‘1&#39;</span>:Diraction1,<span style="color:#e6db74">&#39;é£å‘1num&#39;</span>:Diraction1_num,<span style="color:#e6db74">&#39;é£å‘2&#39;</span>:Diraction2,<span style="color:#e6db74">&#39;é£å‘2num&#39;</span>:Diraction2_num,<span style="color:#e6db74">&#39;å°é£çº§&#39;</span>:minScale,<span style="color:#e6db74">&#39;å¤§é£çº§&#39;</span>:maxScale}
</span></span><span style="display:flex;"><span>	df<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame(dira_and_scale)
</span></span><span style="display:flex;"><span>	processedPath<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;./ProcessedData/data.xlsx&#39;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">#å°†ç”Ÿæˆçš„è¡¨æ ¼è®°å½•ä¸‹</span>
</span></span><span style="display:flex;"><span>	file<span style="color:#f92672">=</span>df<span style="color:#f92672">.</span>to_excel(processedPath)
</span></span></code></pre></div><h1 id="ç»“è®º">ç»“è®º<a hidden class="anchor" aria-hidden="true" href="#ç»“è®º">#</a></h1>
<p>é¦–å…ˆæ˜¯å¾—åˆ°ä¸€å¼ åå¹´å°ºåº¦çš„æ—¥æœŸ-é£å‘é£çº§çš„è¡¨æ ¼, å…¶ä¸­å·²ç»åŒ…å«äº†å¯¹é£å‘è¯»ä¸ºåº¦æ•°çš„åˆ—.</p>
<p>ä½¿ç”¨ OriginPro çš„é£å‘ç«ç‘°å›¾çš„ç»˜åˆ¶åŠŸèƒ½ä¸éš¾ç»˜åˆ¶å‡ºé£å‘å’Œé£çº§åœ¨å¤§é£ç®¡åˆ¶æœŸé—´çš„è§„å¾‹. ç”±ä¸Šè¿°å›¾å¯ä»¥åˆ†æå¾—åˆ°çš„ç»“è®ºæ˜¯:</p>
<ol>
<li>å¤§é£ç®¡åˆ¶å‘ç”Ÿæ—¶ï¼Œé£å‘å„ä¸ªé£å‘éƒ½æœ‰ï¼Œä½†æ˜¯å¤§å¤šé›†ä¸­åœ¨è¥¿åŒ—æ–¹å‘ï¼Œè€Œä¸”ä¹Ÿæ˜¯è¥¿åŒ—æ–¹å‘çš„é£çº§æœ€å¤§;</li>
<li>é£çº§ä¸€èˆ¬è¦è¾¾åˆ°5çº§åŠä»¥ä¸Šæ—¶æ‰ä¼šè§¦å‘æ»¡è¶³å¤§é£ç®¡åˆ¶çš„æ¡ä»¶.</li>
</ol>
<p><img loading="lazy" src="https://s2.loli.net/2023/05/20/x6UIYmz9yED3ZiH.png" alt="Max Scale"  />
</p>
<p><img loading="lazy" src="https://s2.loli.net/2023/05/20/x6UIYmz9yED3ZiH.png" alt="Min Scale"  />
</p>


        </div>
        <div class="post-reward">
            <div style="padding: 0 0 0 0; margin: 0 0 0 0; width: 100%; font-size:16px; text-align: center;">
                <div id="QR" style="opacity: 0;">
                    <div id="wechat" style="display: inline-block">
                        <a class="fancybox" rel="group">
                            <img id="wechat_qr" src="https://s2.loli.net/2023/07/11/SAy54bkgO1HmKlD.jpg" alt="wechat_pay"></a>
                        <p>å¾®ä¿¡</p>
                    </div>
                    <div id="alipay" style="display: inline-block">
                        <a class="fancybox" rel="group">
                            <img id="alipay_qr" src="https://s2.loli.net/2023/07/11/8IYCUkW5QGXu16v.jpg" alt="alipay"></a>
                        <p>æ”¯ä»˜å®</p>
                    </div>
                </div>
                <button id="rewardButton"
                        onclick="
                    var qr = document.getElementById('QR');
                    if (qr.style.opacity === '0') {
                        qr.style.opacity='1';
                    } else {
                        qr.style.opacity='0'
                    }"
                >
                    <span>ğŸ§§ é¼“åŠ±</span>
                </button>
            </div>
        </div>

        <footer class="post-footer">
            
<nav class="paginav">
  <a class="prev" href="https://Muatyz.github.io/posts/phy/hcmp/density-generalized-function-theory/">
    <span class="title">Â« ä¸Šä¸€é¡µ</span>
    <br>
    <span>å¤šä½“: å¯†åº¦æ³›å‡½ç†è®º</span>
  </a>
  <a class="next" href="https://Muatyz.github.io/posts/cs/datastructure/wangdao/">
    <span class="title">ä¸‹ä¸€é¡µ Â»</span>
    <br>
    <span>æ•°æ®ç»“æ„åæ€æ€»ç»“</span>
  </a>
</nav>

        </footer>
    </div>

<style>
    .comments_details summary::marker {
        font-size: 20px;
        content: 'ğŸ‘‰å±•å¼€è¯„è®º';
        color: var(--content);
    }
    .comments_details[open] summary::marker{
        font-size: 20px;
        content: 'ğŸ‘‡å…³é—­è¯„è®º';
        color: var(--content);
    }
</style>





<div>
    <div class="pagination__title">
        <span class="pagination__title-h" style="font-size: 20px;">ğŸ’¬è¯„è®º</span>
        <hr />
    </div>
    <div id="tcomment"></div>
    <script src="https://cdn.staticfile.org/twikoo/1.6.16/twikoo.all.min.js"></script>
    <script>
        twikoo.init({
            envId: "https://twikoo-api-one-xi.vercel.app",  
            el: "#tcomment",
            lang: 'zh-CN',
            region: 'ap-shanghai',  
            path: window.TWIKOO_MAGIC_PATH||window.location.pathname,
        });
    </script>
</div>
</article>
</main>

<footer class="footer">
    <span>Muartz</span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <span class="topInner">
        <svg class="topSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z"/>
        </svg>
        <span id="read_progress"></span>
    </span>
</a>

<script>
    document.addEventListener('scroll', function (e) {
        const readProgress = document.getElementById("read_progress");
        const scrollHeight = document.documentElement.scrollHeight;
        const clientHeight = document.documentElement.clientHeight;
        const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
        readProgress.innerText = ((scrollTop / (scrollHeight - clientHeight)).toFixed(2) * 100).toFixed(0);
    })
</script><script>

    let detail = document.getElementsByClassName('details')
   
    details = [].slice.call(detail);
   
    for (let index = 0; index < details.length; index++) {
   
    let element = details[index]
   
    const summary = element.getElementsByClassName('details-summary')[0];
   
    if (summary) {
   
    summary.addEventListener('click', () => {
   
    element.classList.toggle('open');
   
    }, false);
   
    }
   
    }
   
   </script>   

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });
</script>
<script>
    let mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };
</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        (function() {
            document.cookie = "change-themes" + "="+ escape ("false");
        })()

        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    });
</script>

<script>
    document.body.addEventListener('copy', function (e) {
        if (window.getSelection().toString() && window.getSelection().toString().length > 50) {
            let clipboardData = e.clipboardData || window.clipboardData;
            if (clipboardData) {
                e.preventDefault();
                let htmlData = window.getSelection().toString() +
                    '\r\n\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\r\n' +
                    'ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºã€Œ'+"æ— å¤„æƒ¹å°˜åŸƒ"+'ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚' +
                '\r\nåŸæ–‡é“¾æ¥ï¼š' + location.href;
                let textData = window.getSelection().toString() +
                    '\r\n\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\r\n' +
                    'ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºã€Œ'+"æ— å¤„æƒ¹å°˜åŸƒ"+'ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚' +
                '\r\nåŸæ–‡é“¾æ¥ï¼š' + location.href;
                clipboardData.setData('text/html', htmlData);
                clipboardData.setData('text/plain', textData);
            }
        }
    });
</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;
        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'å¤åˆ¶';

        function copyingDone() {
            copybutton.innerText = 'å·²å¤åˆ¶ï¼';
            setTimeout(() => {
                copybutton.innerText = 'å¤åˆ¶';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                let text = codeblock.textContent +
                    '\r\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\r\n' +
                    'ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºã€Œ'+"æ— å¤„æƒ¹å°˜åŸƒ"+'ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚' +
                '\r\nåŸæ–‡é“¾æ¥ï¼š' + location.href;
                navigator.clipboard.writeText(text);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) {}
            selection.removeRange(range);
        });

        let language = codeblock.className.replaceAll("language-", "")
        let macTool = document.createElement("div")
        let macTool1 = document.createElement("div")
        let macTool2 = document.createElement("div")
        let macTool3 = document.createElement("div")
        let languageType = document.createElement("div")
        languageType.innerText = language
        macTool.setAttribute('class', 'mac-tool')
        macTool1.setAttribute('class', 'mac bb1')
        macTool2.setAttribute('class', 'mac bb2')
        macTool3.setAttribute('class', 'mac bb3')
        languageType.setAttribute('class', 'language-type')
        macTool.appendChild(macTool1)
        macTool.appendChild(macTool2)
        macTool.appendChild(macTool3)
        macTool.appendChild(languageType)

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
            container.appendChild(macTool)
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
            container.appendChild(macTool)
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
            container.appendChild(macTool)
        }
    });
</script>

<script>
    $("code[class^=language] ").on("mouseover", function () {
        if (this.clientWidth < this.scrollWidth) {
            $(this).css("width", "135%")
            $(this).css("border-top-right-radius", "var(--radius)")
        }
    }).on("mouseout", function () {
        $(this).css("width", "100%")
        $(this).css("border-top-right-radius", "unset")
    })
</script>


<script>
    
    document.addEventListener('keydown', function(event) {
      
      if (event.key === 'j') {
        
        var nextPageLink = document.querySelector('.pagination-item.pagination-next > a');
        if (nextPageLink) {
          nextPageLink.click();
        }
      } else if (event.key === 'k') {
        
        var prevPageLink = document.querySelector('.pagination-item.pagination-previous > a');
        if (prevPageLink) {
          prevPageLink.click();
        }
      }
    });
  </script>
  

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/fz6m/Private-web@1.2/js/custom/click.min.js"></script>

</body>





<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script>
  </head>


<body>

  <link rel="stylesheet" href="https://cdn.staticfile.org/lxgw-wenkai-screen-webfont/1.6.0/lxgwwenkaiscreen.css" media="print" onload="this.media='all'">
  
  </body>


</html>
