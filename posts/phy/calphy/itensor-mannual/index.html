<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>ITensoråŸºç¡€è¯­æ³•è¯´æ˜ | æ— å¤„æƒ¹å°˜åŸƒ</title>
<meta name="keywords" content="physics, DMRG">
<meta name="description" content="ä»‹ç»ä»¥DMRGç®—æ³•ä¸ºæ ¸å¿ƒçš„itensoråº“ä½¿ç”¨æ–¹æ³•">
<meta name="author" content="Muartz">
<link rel="canonical" href="https://Muatyz.github.io/posts/phy/calphy/itensor-mannual/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.js" onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://Muatyz.github.io/img/Head32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://Muatyz.github.io/img/Head16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://Muatyz.github.io/img/Head32.png">
<link rel="apple-touch-icon" href="https://Muatyz.github.io/img/Head32.png">
<link rel="mask-icon" href="https://Muatyz.github.io/img/Head32.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="https://Muatyz.github.io/posts/phy/calphy/itensor-mannual/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script defer src="https://unpkg.com/mermaid@8.8.1/dist/mermaid.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.3/dist/jquery.min.js"></script>



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "www.muartz.com"; 
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script type="text/javascript"
        async
        src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
  CommonHTML: {
  scale: 100
  },
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[\[','\]\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});

MathJax.Hub.Queue(function() {
  
  
  
  var all = MathJax.Hub.getAllJax(), i;
  for(i = 0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script>

<style>
  code.has-jax {
      font: "LXGW WenKai Screen", sans-serif, Arial;
      scale: 1;
      background: "LXGW WenKai Screen", sans-serif, Arial;
      border: "LXGW WenKai Screen", sans-serif, Arial;
      color: #515151;
  }
</style>
  

<meta property="og:title" content="ITensoråŸºç¡€è¯­æ³•è¯´æ˜" />
<meta property="og:description" content="ä»‹ç»ä»¥DMRGç®—æ³•ä¸ºæ ¸å¿ƒçš„itensoråº“ä½¿ç”¨æ–¹æ³•" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://Muatyz.github.io/posts/phy/calphy/itensor-mannual/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-05T00:18:23+08:00" />
<meta property="article:modified_time" content="2022-05-05T00:18:23+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="ITensoråŸºç¡€è¯­æ³•è¯´æ˜"/>
<meta name="twitter:description" content="ä»‹ç»ä»¥DMRGç®—æ³•ä¸ºæ ¸å¿ƒçš„itensoråº“ä½¿ç”¨æ–¹æ³•"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [

        {
          "@type": "ListItem",
          "position":  1 ,
          "name": "ğŸ“šæ–‡ç« ",
          "item": "https://Muatyz.github.io/posts/"
        },

        {
          "@type": "ListItem",
          "position":  2 ,
          "name": "ğŸ§± PHY",
          "item": "https://Muatyz.github.io/posts/phy/"
        },

        {
          "@type": "ListItem",
          "position":  3 ,
          "name": "ğŸ’» Computation Physics",
          "item": "https://Muatyz.github.io/posts/phy/calphy/"
        }, 
    {
      "@type": "ListItem",
      "position":  4 ,
      "name": "ITensoråŸºç¡€è¯­æ³•è¯´æ˜",
      "item": "https://Muatyz.github.io/posts/phy/calphy/itensor-mannual/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "ITensoråŸºç¡€è¯­æ³•è¯´æ˜",
  "name": "ITensoråŸºç¡€è¯­æ³•è¯´æ˜",
  "description": "ä»‹ç»ä»¥DMRGç®—æ³•ä¸ºæ ¸å¿ƒçš„itensoråº“ä½¿ç”¨æ–¹æ³•",
  "keywords": [
    "physics", "DMRG"
  ],
  "articleBody": "one site å•èŠ‚ç‚¹ Site\næ„æŒ‡\"èŠ‚ç‚¹\".\nå•èŠ‚ç‚¹çš„è‡ªæ—‹ä¸º $\\frac{1}{2}$ çš„æ³¢å‡½æ•°,æœ‰ä¸¤ä¸ªåŸºåº•.\n$|s=1\\rangle=|\\uparrow\\rangle;|s=2\\rangle=|\\downarrow\\rangle$\nå¯¹äºä¸€èˆ¬çš„è‡ªæ—‹ä¸º $\\frac{1}{2}$ çš„æ³¢å‡½æ•°,å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼:\n$|\\psi\\rangle=\\sum_{s=1}^{2}\\psi_s|s\\rangle(\\psi_s\\in\\mathcal{C})$\nä½¿ç”¨å¼ é‡æ•°å­¦æ¥å¤„ç†è¿™ä¸ªå•èŠ‚ç‚¹æ³¢å‡½æ•°, å³ $|\\psi_s\\rangle$ å¯¹åº”ä¸€ä¸ªæœ‰ä¸€ä¸ª\"è§¦æ‰‹\"çš„ç»“ç‚¹.å±•å¼€å½¢å¼ä¸º $(^{\\psi_1}_{\\psi_2})$ , $\\psi_1,\\psi_2$ åˆå„è‡ªæ˜¯ä¸€ä¸ªå•\"è§¦æ‰‹\"çš„ç»“ç‚¹.\nIndex s(\"s\",2); //\"s\"ä»£è¡¨çš„æ˜¯Indexçš„å‘½å //2æ˜¯Indexçš„ç»´åº¦ ITensor psi(s); //ç”±äºåªå£°æ˜ä¸å®šä¹‰,æ‰€ä»¥åˆå§‹å€¼ä¸º0 Index æŒ‡æ ‡\næŒ‡çš„æ˜¯è¡¨ç¤ºæŸç§ç‰©ç†é‡çš„ç¬¦å·.è¿™ä¸ªç¬¦å· å¯ä»¥æ˜¯çŸ¢é‡, å¼ é‡, ç®—ç¬¦.\nIndex s(2,\"s\"); Index t(3,\"t\"); ITensor T(s,t); è¿™ä¸ªè¡¨ç¤ºçš„å°±æ˜¯åˆ›å»ºäº†ä¸€ä¸ªäºŒç»´çš„ç‰©ç†é‡,æˆ‘ä»¬ç”¨$s$æ¥æ ‡è®°å®ƒ;ç‰©ç†é‡tåˆ™æ˜¯ä¸‰ç»´çš„. è€ŒItensorçš„å¤§å°åˆ™æ˜¯ $2\\times 3$.\nå¯¹ $|\\psi_s\\rangle$ è¿›è¡Œåˆå§‹åŒ–æ“ä½œ.æˆ‘ä»¬ä¸å¦¨å°†å…¶åˆå§‹åŒ–ä¸ºåŸºçŸ¢:\n$|\\psi_s\\rangle=|\\uparrow\\rangle$\nIndex s(2,\"s\"); //åœ¨æœ€æ–°çš„ITensorè¯­æ³•è§„èŒƒä¸­,Index (string, int)çš„è¯­æ³•å·²ç»è¢«å¼ƒç”¨ //ç›®å‰çš„è¯­æ³•åº”å½“æ˜¯Index (int, string) ITensor psi(s); psi(s(1)) = 1; PrintData(psi); æœ¬ç¤ºä¾‹ä»£ç åº”è¯¥ä¼šè¾“å‡º:\npsi = ITensor ord=1: (dim=2|id=414|\"s\") {norm=1.00 (Dense Real)} (1) 1.0000000 Operators æ“ä½œç¬¦/ç®—å­ $\\hat{A}$ ç®—å­ä½“ç°åœ¨å¼ é‡ç½‘ç»œä¸Šå°±æ˜¯ä¸€ä¸ªæ‹¥æœ‰ä¸¤ä¸ª\"è§¦æ‰‹\"çš„ç»“ç‚¹, å®ƒå¯ä»¥å’Œåªæœ‰ä¸€ä¸ª\"è§¦æ‰‹\"çš„ç»“ç‚¹ç»“åˆ, ä»è€Œç”Ÿæˆä¸€ä¸ªæ–°çš„åªæœ‰ä¸€ä¸ªè§¦æ‰‹çš„ç»“ç‚¹.\nITensor Sz(s,prime(s)); ITensor Sx(s,prime(s)); //prime(s)æ˜¯æŒ‡çš„å¯¹sè¿›è¡Œå…±è½­æ“ä½œ å¦‚æœè¦å¯¹ä¸€ä¸ªå‘é‡æˆ–è€…çŸ©é˜µè¿›è¡Œè½¬ç½®,å…±è½­ç­‰æ“ä½œ,æˆ‘ä»¬å¯ä»¥ç”¨è¢«ç§°ä¸ºä¸Šä¸‹æ ‡çš„æ“ä½œæ¥è¡¨ç¤º.æ¯”å¦‚, $A_{ij}^{â€™}=A_{ji}$, $A_{ij}^{\\dagger}=A_{ji}$ ç­‰.\nprime(s)å°±ä»£è¡¨äº†å¯¹æŒ‡æ ‡è¿›è¡Œä¸Šæ ‡æ“ä½œæ‰€å¾—åˆ°çš„é‡.\nPrime Level ä¸Šæ ‡çº§åˆ«\næŒ‡æ ‡æœ‰ä¸€ä¸ªå±æ€§è¢«ç§°ä¸ºprime level, è¡¨ç¤ºæ˜¯å¦è¢«æŸä¸ªæ“ä½œå‡é™çº§.é»˜è®¤æƒ…å†µä¸‹æŒ‡æ ‡çš„ä¸Šæ ‡çº§åˆ«ä¸º0.\nè¿™ä¸ªé‡çš„ä½œç”¨æ˜¯ç”¨æ¥å¯¹ä¸¤ä¸ªå¼ é‡è¿›è¡Œæ¯”è¾ƒ, åœ¨è¿›è¡ŒæŸäº›æ“ä½œæ—¶, ä¸Šæ ‡å¿…é¡»è¦æ»¡è¶³æŸäº›éœ€æ±‚è¿ç®—æ‰èƒ½å¤Ÿæˆç«‹.\næ¯”å¦‚\nIndex s(2,\"s\"); Index t(2,\"2\"); ITensor A(s,t); ITensor B(s,t);// s, t éƒ½æ˜¯ä¸Šæ ‡çº§åˆ«ä¸º 0 çš„æŒ‡æ ‡ C = A * prime(B);// prime(B) è¡¨ç¤ºå°† B ä¸­çš„æ‰€æœ‰æŒ‡æ ‡ä¸Šæ ‡çº§åˆ«åŠ  1 åœ¨è¿™é‡Œ, A * prime(B)å°±æ˜¯ä¸€ä¸ªä¸å…è®¸æŒ‡æ ‡é‡å¤çš„æ“ä½œ.æ‰€ä»¥ä¸ºäº†å®Œæˆè¿™ä¸ªè®¡ç®—,æˆ‘ä»¬éœ€è¦å¯¹Bè¿›è¡Œä¸Šæ ‡çº§åˆ«å‡çº§çš„æ“ä½œ,ä¹Ÿå°±æ˜¯ä½¿ç”¨prime()å‡½æ•°.\nç°åœ¨æˆ‘ä»¬æ¥å¯¹ $\\hat{S}_z,\\hat{S}_x$ ç®—å­è¿›è¡Œå®šä¹‰.\nITensor Sz(s,prime(s)),Sx(s,prime(s)); // commaInit(Sz,s,prime(s)) = 0.5, 0.0, // 0.0,-0.5; // commaInit(Sx,s,prime(s)) = 0.0, 0.5, // 0.5, 0.0; //commaInitçš„è¯­æ³•å·²ç»è¢«å¼ƒç”¨, åº”å½“ä½¿ç”¨.set() //Sz Sz.set(s(1),prime(s)(1),0.5); Sz.set(s(2),prime(s)(2),-0.5); //Sx Sx.set(s(1),prime(s)(2),0.5); Sx.set(s(2),prime(s)(1),0.5);//è®¾ç½®åˆ†é‡ ç°åœ¨æˆ‘ä»¬å°è¯•å¯¹æ³¢å‡½æ•° $|\\psi\\rangle$ è¿›è¡Œæ±‚æŸæ–¹å‘è‡ªæ—‹çš„æ“ä½œ.\nå³æ–¹ç¨‹ä¸Šçš„\n$$ (\\hat{S_{x}})_{sâ€™}^{s}\\psi_{s} $$\nå¯¹åº”çš„æ˜¯\nITensor phi = Sx * psi; (æ³¨æ„ç®—ç¬¦çš„ä¸Šæ ‡è¦å’Œæ³¢å‡½æ•°çš„ä¸‹æ ‡ç›¸åŒ, è¿™æ ·çš„æ“ä½œæ‰æ˜¯è¢«å…è®¸çš„. $s$å’Œ$sâ€™$çš„ä¸Šæ ‡ç­‰çº§ä¸åŒ, æ‰€ä»¥æ˜¯ä¸åŒ¹é…çš„)\nä¸ºäº†ç ”ç©¶ç»è¿‡æ±‚è‡ªæ—‹çš„é‡ $|\\phi\\rangle$ çš„å…·ä½“æƒ…å†µ, æˆ‘ä»¬å°†å…¶è¾“å‡ºåœ¨ç»ˆç«¯:\nITensor phi = Sx * psi; PrintData(phi); è¾“å‡ºçš„ç»“æœåº”è¯¥æ˜¯:\nphi = ITensor ord=1: (dim=2|id=816|\"s\")' {norm=0.50 (Dense Real)} (2) 0.5000000 æˆ‘ä»¬æ¥çœ‹çœ‹æ›´å¤šçš„ç»“æœ. å¦‚æœæœ‰ $|\\psi_s\\rangle=(|^{\\cos{\\frac{\\theta}{2}}}_{\\sin{\\frac{\\theta}{2}}}\\rangle)_{\\theta=\\frac{\\pi}{4}}$, é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿™æ ·æè¿°:\nReal theta = Pi/4; // psi(s(1)) = cos(theta/2); // psi(s(2)) = sin(theta/2); //è¯¥è¯­æ³•å·²è¢«å¼ƒç”¨,ä½¿ç”¨.set()æ›¿ä»£ psi.set(s(1),cos(theta/2)); psi.set(s(2),sin(theta/2)); PrintData(psi); ç»ˆç«¯ä¼šè¾“å‡º\npsi = ITensor ord=1: (dim=2|id=977|\"s\") {norm=1.00 (Dense Real)} (1) 0.9238795 (2) 0.3826834 æœŸæœ›å€¼ $\\langle\\hat{A}\\rangle$ åœ¨ç‰©ç†ä¸Šæˆ‘ä»¬å®šä¹‰ç®—ç¬¦ $\\hat{A}$ çš„æœŸæœ›å€¼ä¸º $\\langle\\psi|\\hat{A}|\\psi\\rangle$.\næˆ‘ä»¬ä¸å¦¨æ±‚è‡ªæ—‹ç®—ç¬¦ $\\hat{S_z}$ çš„æœŸæœ›å€¼. åœ¨å¼ é‡ç½‘ç»œä¸Š, è¿™ä¸ªè¿‡ç¨‹ä½“ç°ä¸º, ä½œä¸ºç®—ç¬¦çš„\"å…·æœ‰ä¸Šä¸‹ä¸¤ä¸ªè§¦æ‰‹çš„ç»“ç‚¹\"çš„æ¯ä¸ªè§¦æ‰‹åˆ†åˆ«è¿æ¥ä¸€ä¸ª\"åªæœ‰å•è§¦æ‰‹çš„ç»“ç‚¹\"(ä¹Ÿå°±æ˜¯ä»£è¡¨ç€å•èŠ‚ç‚¹æ³¢å‡½æ•°).\næˆ‘ä»¬ç”¨ç¨‹åºè¯­è¨€æ¥æè¿°è¿™ä¸ªè¿‡ç¨‹:\nITensor cpsi = dag(prime(psi)); // Real zz = (cpsi * Sz * psi).toReal(); // Real xx = (cpsi * Sx * psi).toReal(); // toReal()å‡½æ•°å·²å¼ƒç”¨,ä½¿ç”¨.real()æ›¿ä»£ Real zz = (cpsi * Sz * psi).real(); Real xx = (cpsi * Sx * psi).real(); // println(\"=\",zz); // println(\"=\",xx); // println()å·²å¼ƒç”¨,ä½¿ç”¨printfln()æ›¿ä»£ printfln(\"=\",zz); printfln(\"=\",xx); å…¶ä¸­ITensor cpsi = dag(prime(psi));å°±æ˜¯ä¸€ä¸ªå°† $\\psi$ å…ˆå–è½¬ç½®åå–å…±è½­çš„è¿‡ç¨‹, æ‰€ä»¥cpsiçš„ä¸Šæ ‡çº§æ•°ä¸º$2$. æˆ‘ä»¬ä¹Ÿå¯ä»¥æ¨æµ‹å¾—çŸ¥, ç®—ç¬¦ $\\hat{S}_x,\\hat{S}_z$çš„ä¸Šæ ‡çº§æ•°ä¸º$1$.\nç»ˆç«¯è¾“å‡ºä¸º\n=0.353553 =0.353553 è§‚å¯Ÿåˆ° $\\sqrt{\\langle S_z\\rangle ^2 + \\langle S_x\\rangle ^2} = \\frac{1}{2}$\næˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªè¿‡ç¨‹è¿›è¡Œç±»ä¼¼ç»“åˆç‡çš„åˆ†æ:\n$\\langle\\psi|\\hat{S}_z|\\psi\\rangle = \\langle\\psi|\\hat{S}_z\\psi\\rangle$.\nç”¨ä»£ç æ¥æè¿°ç»“åˆå¾‹çš„è¿‡ç¨‹:\nITensor Zpsi = Sz * psi; //å› ä¸ºSzä»¥sä¸ºä¸Šæ ‡,psiä»¥sä¸ºä¸‹æ ‡,æ‰€ä»¥å…è®¸è¿ç®— ITensor expect = cpsi * Zpsi; Real zz = expect.real() Quiz $1$ è§£æ æç¤º\nåŸæ–‡æ‰€æç¤ºçš„å‡½æ•°elt()å·²ç»å¼ƒç”¨.æ‰€ä»¥é‡‡ç”¨çš„æ˜¯ä¼ ç»Ÿçš„prime(A) * Bæ–¹å¼. å¦‚æœä½ æƒ³ä½¿ç”¨å‡½æ•°è€Œé *æ¥å¾—åˆ°å†…ç§¯, ä½ åº”å½“é‡‡ç”¨å‡½æ•°inner()\n#include \"itensor/all.h\" #include \"itensor/util/print_macro.h\" using namespace itensor; int main(){ // Define our Index // (the space we are working with) auto s = Index(2,\"s\"); // Operators auto Sx = ITensor(s,prime(s)); Sx.set(s(1),prime(s)(2),0.5); Sx.set(s(2),prime(s)(1),0.5); PrintData(Sx); // Single-site wavefunction auto psi = ITensor(s); //initialized to zero // TODO // 1. make the above wavefunction // the (normalized) positive Sx eigenstate psi.set(s(1),1/sqrt(2)); psi.set(s(2),1/sqrt(2)); PrintData(psi); // TODO // 2. Compute |phi\u003e = Sx |psi\u003e using // the Sx and psi ITensors above // AND // compute: auto olap = // using the * operator and elt(...) method. // Print the result with PrintData(...). auto phi = Sx * psi; auto olap = prime(psi) * phi; //auto olap = elt(prime(psi),phi); PrintData(olap); // TODO // 3. Try normalizing |phi\u003e and recompute // the inner product // Print the result with PrintData(...). // HINT: use phi /= norm(phi)) to normalize. phi /= norm(phi); //auto olap2 = eltC(prime(psi),phi); auto olap2 = prime(psi) * phi; PrintData(olap2); return 0; } è¾“å‡ºå¾—åˆ°:\nSx = ITensor ord=2: (dim=2|id=15|\"s\") (dim=2|id=15|\"s\")' {norm=0.71 (Dense Real)} (2,1) 0.5000000 (1,2) 0.5000000 psi = ITensor ord=1: (dim=2|id=15|\"s\") {norm=1.00 (Dense Real)} (1) 0.7071068 (2) 0.7071068 olap = ITensor ord=0: {norm=0.50 (Dense Real)} 0.5000000 olap2 = ITensor ord=0: {norm=1.00 (Dense Real)} 1.0000000 Two Sites åŒèŠ‚ç‚¹ çº ç¼ æ€ å¯¹äºåŒè‡ªæ—‹çš„æ³¢å‡½æ•°, æˆ‘ä»¬ä¸€èˆ¬çš„æè¿°æ–¹ç¨‹æ˜¯:\n$$ |\\Psi\\rangle = \\sum_{s_1,s_2 = 1}^{2}\\psi_{s_1s_2}|s_1\\rangle|s_2\\rangle $$\nä½“ç°åœ¨å¼ é‡ç½‘ç»œä¸Š, å°±æ˜¯ä¸€ä¸ªç»“ç‚¹åœ¨åŒä¸€æ–¹å‘ä¸ŠåŒæ—¶æœ‰ç€ä¸¤ä¸ª\"è§¦æ‰‹\". å¯¹äºæˆ‘ä»¬å†™å‡ºæ¥çš„æ€, æˆ‘ä»¬å¯ä»¥åˆ†ç¦»å‡ºä¸¤ä¸ªå•æ€(Singlet).\nç¨‹åºä¸Šçš„æè¿°æ–¹æ³•:\n// Index s1(2,\"s1\",Site), s2(2,\"s2\",Site); // è¯¥è¯­æ³•å·²ç»è¢«å¼ƒç”¨,ä½¿ç”¨ä¸¤æ­¥è¯­æ³•æ¥æ›¿ä»£ Index s1(2,\"s1\");s1.addTags(\"Site\"); Index s2(2,\"s2\");s1.addTags(\"Site\"); ITensor psi(s1,s2); //åªå£°æ˜ä¸å®šä¹‰,åˆ™é»˜è®¤ä¸º0 // psi(s1(1),s2(2)) = 1./sqrt(2); // psi(s1(2),s2(1)) =-1./sqrt(2); // è¯¥è¯­æ³•å·²è¢«å¼ƒç”¨,ä½¿ç”¨.set()æ¥æ›¿ä»£. psi.set(s1(1),s2(2), 1./sqrt(2)); psi.set(s1(2),s2(1),-1./sqrt(2)); PrintData(psi); Index s1(2,\"s1\");s1.addTags(\"Site\");ä»£è¡¨çš„å«ä¹‰æ˜¯åˆ›å»ºä¸€ä¸ªç»´æ•°ä¸ºint,æ ‡ç­¾(æˆ–è€…ç†è§£ä¸º\"åå­—\",ä¸€èˆ¬æ˜¯æŒ‡ç‰©ç†ä¸Šçš„çŠ¶æ€,æ¯”å¦‚è‡ªæ—‹,ç²’å­ä½ç½®ç­‰ç­‰)ä¸ºstring,æŒ‡æ ‡ç±»å‹ä¸ºSiteçš„ç‰©ç†é‡.åŒæ—¶ä½¿ç”¨ITensor psi(s1,s2)å°†s1å’Œs2è®¾ç½®ä¸ºçº ç¼ æ€(Entangled State).\nç°åœ¨è¦è¯´æ˜çš„å°±æ˜¯æŒ‡æ ‡(Index)çš„ç±»å‹:Siteå’ŒLink.\nSiteè¡¨ç¤ºå•ä¸ªé‡å­ä½çš„ç‰©ç†æ€. é€‚ç”¨äºè¡¨ç¤ºå•ä¸ªè‡ªæ—‹,å•ä¸ªç²’å­çš„ä½ç½®ç­‰ç­‰. ä¸ä¹‹é…å¯¹çš„ç»´æ•°intè¡¨ç¤ºçš„æ˜¯è¯¥é‡å­ä½å¯ä»¥å–çš„ç‰©ç†æ€çš„æ•°é‡;\nLinkè¡¨ç¤ºçš„æ˜¯ä¸åŒé‡å­ä½ä¹‹é—´çš„ç›¸äº’ä½œç”¨. è¿™ç§ç›¸äº’ä½œç”¨é€šå¸¸è¡¨ç¤ºä¸åŒé‡å­ä½çš„é“¾æ¥, é€‚ç”¨äºè¡¨ç¤ºå„ç§ç›¸äº’ä½œç”¨, æ¯”å¦‚å“ˆå¯†é¡¿é‡ç­‰.\n(è¿˜æœ‰è¡¨ç¤ºä¸åŒäºSiteå’ŒLinkç±»å‹çš„å…¶å®ƒæŒ‡æ ‡ç±»å‹, æ¯”å¦‚Bulk)\nä¸Šé¢çš„ä»£ç ä¸­æˆ‘ä»¬ç”¨Siteæ¥æ ‡è®°ä¸¤ä¸ªé‡å­ä½,å¹¶ä¸”ä½¿å…¶ç»“åˆä¸ºçº ç¼ æ€.\nç»“æœè¾“å‡ºä¸º\npsi = ITensor ord=2: (dim=2|id=324|\"s1,Site\") (dim=2|id=127|\"s2\") {norm=1.00 (Dense Real)} (2,1) -0.707107 (1,2) 0.7071068 å“ˆå¯†é¡¿é‡$\\hat{H}$ æˆ‘ä»¬å†™å‡ºåŒè‡ªæ—‹ç³»ç»Ÿçš„å“ˆå¯†é¡¿é‡æ–¹ç¨‹:\n$\\hat{H}=\\hat{S}_1\\cdot\\hat{S}_2=S_1^zS_2^z+\\frac{1}{2}S_1^+S_2^-+\\frac{1}{2}S_1^-S_2^+$\nå…¶ä¸­ $S_1^\\pm, S_2^\\pm$ æ˜¯å‡é™ç®—ç¬¦. æˆ‘ä»¬åœ¨ç¨‹åºä¸­è¿™æ ·åˆ›å»º:\nIndex s1(2,\"s1\");s1.addTags(\"Site\"); Index s2(2,\"s2\");s1.addTags(\"Site\"); ITensor Sz1(s1,prime(s1)),Sp1(s1,prime(s1)),Sm1(s1,prime(s1)); ITensor Sz2(s2,prime(s2)),Sp2(s2,prime(s2)),Sm2(s2,prime(s2)); // commaInit(Sp1,s1,prime(s1)) = 0, 1, // 0, 0; // commaInitè¯­æ³•å·²è¢«å¼ƒç”¨. //Sz1,Sz2 Sz1.set(s1(1),prime(s1)(1),0.5);Sz1.set(s1(2),prime(s1)(2),-0.5); Sz2.set(s2(1),prime(s2)(1),0.5);Sz2.set(s2(2),prime(s2)(2),-0.5); //Sp1,Sp2 Sp1.set(s1(1),prime(s1)(2),1);Sp2.set(s2(1),prime(s2)(2),1); //Sm1,Sm2 Sm1.set(s1(2),prime(s1)(1),1);Sm2.set(s2(2),prime(s2)(1),1); ITensor H = Sz1 * Sz2 + 0.5 * Sp1 * Sm2 + 0.5 * Sm1 * Sp2; PrintData(H);//ä½ ä¹Ÿå¯ä»¥å°è¯•æ‰§è¡Œprintfln(\"H=\",H); æ‰§è¡Œåå¯ä»¥å¾—åˆ°ç»“æœ\nH = ITensor ord=4: (dim=2|id=397|\"s1,Site\") (dim=2|id=397|\"s1,Site\")' (dim=2|id=53|\"s2\") (dim=2|id=53|\"s2\")' {norm=0.87 (Dense Real)} (1,1,1,1) 0.2500000 (2,2,1,1) -0.250000 (1,2,2,1) 0.5000000 (2,1,1,2) 0.5000000 (1,1,2,2) -0.250000 (2,2,2,2) 0.2500000 è¿™è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªå››é˜¶å¼ é‡,å¹¶ä¸”ç”±ç´¢å¼•s1, s1', s2, s2'æ¥æè¿°. å®ƒä»¬å„è‡ªçš„ç»´åº¦éƒ½æ˜¯$2$, å³å®ƒä»¬å¯ä»¥å–å€¼ä¸º$1$æˆ–$2$.è¿™å°±æ˜¯(i,j,k,l)ä¸­1æˆ–è€…2çš„å«ä¹‰, åé¢çš„å€¼æ˜¯å¯¹åº”çš„å¼ é‡å…ƒç´ .\nè¿™æ ·è®¡ç®—å¾—æ¥çš„ $\\hat{H}$ åœ¨å¼ é‡ç½‘ç»œä¸­è¡¨ç¤ºä¸€ä¸ªä¸Šä¸‹å„è‡ªæœ‰ä¸¤ä¸ª\"è§¦æ‰‹\"çš„ç»“ç‚¹, æ°å¥½å¯ä»¥å’Œè¡¨ç°ä¸ºåœ¨æŸä¸€æ–¹å‘ä¸Šæ‹¥æœ‰ä¸¤ä¸ª\"è§¦æ‰‹\"çš„çº ç¼ æ€ç»“ç‚¹è¿›è¡Œç»“åˆ.\næ›´å…·ä½“åœ°è¯´, æˆ‘ä»¬ä¸Šé¢åˆ›å»ºçš„ $\\hat{H}$ çš„ä¸Šæ ‡æ˜¯s1'å’Œs2',ä¸‹æ ‡æ˜¯s1å’Œs2; è€Œ $\\psi$ çš„ä¸Šæ ‡æ˜¯s1å’Œs2,ä¸¤è€…è¿›è¡Œç»“åˆå°±å¯ä»¥å¾—åˆ°åªæœ‰ä¸¤ä¸ªä¸Šæ ‡s1'å’Œs2'çš„æ–°èŠ‚ç‚¹ $\\hat{H}\\psi$ .\nç¨‹åºä¸Šè¿™æ ·æè¿°è¿™ä¸ªç»“åˆçš„è¿‡ç¨‹:\nITensor Hpsi = H * psi; //Hpsi.mapprime(1,0);//è¯¥è¯­å¥çš„ä½œç”¨æ˜¯å°†Hpsiä¸­æ‰€æœ‰ä¸Šæ ‡çº§åˆ«ä¸º1çš„ç´¢å¼•å…¨éƒ¨é™ä¸º0,ä½¿å¾—ä¹‹åçš„è¿ç®—èƒ½å¤Ÿè¢«å…è®¸ //è¯¥è¯­æ³•å·²è¢«å¼ƒç”¨. ä½¿ç”¨.noPrime()æ¥ä»£æ›¿ Hpsi.noPrime(); Real E = (dag(psi) * Hpsi).real(); //Print()è¯­æ³•å·²è¢«å¼ƒç”¨, ä½¿ç”¨PrintData()æ¥ä»£æ›¿. PrintData(E); èƒ½å¤Ÿåœ¨ç»ˆç«¯å¾—åˆ°è¾“å‡º\nE = -0.75 å½“ç„¶è¿™ä¸ªè¿‡ç¨‹ä¹Ÿå¯ä»¥ä¸€è¡Œè¯­å¥å®Œæˆ:\nReal E = (dag(prime(psi)) * H * psi).real(); PrintData(E); è¾“å‡ºçš„ç»“æœåŒæ ·æ˜¯\nE = -0.75 Quiz $2$ è§£æ è¿™ä¸ªé¢˜ç›®çš„èƒŒæ™¯æ˜¯, ä½¿ç”¨è™šæ—¶é—´æ¼”åŒ–çš„æ–¹å¼æ¥æ‰¾åˆ°å“ˆå¯†é¡¿é‡æ‰€å¯¹åº”çš„åŸºæ€. å¯¹åº”çš„æ–¹ç¨‹æ˜¯\n$e^{-\\beta H/2}|0\\rangle\\propto|\\Psi_0\\rangle$\n#include \"itensor/all.h\" #include \"itensor/util/print_macro.h\" using namespace itensor; //å®šä¹‰ç”ŸæˆSp Sm Szçš„å‡½æ•° ITensor makeSp(Index const\u0026 s){ auto Sp = ITensor(s,prime(s)); Sp.set(s=2,prime(s)=1, 1); return Sp; } ITensor makeSm(Index const\u0026 s){ auto Sm = ITensor(s,prime(s)); Sm.set(s=1,prime(s)=2,1); return Sm; } ITensor makeSz(Index const\u0026 s){ auto Sz = ITensor(s,prime(s)); Sz.set(s=1,prime(s)=1,+0.5); Sz.set(s=2,prime(s)=2,-0.5); return Sz; } int main(){ // Initial product state auto s1 = Index(2,\"s1\");auto s2 = Index(2,\"s2\"); auto psi = ITensor(s1,s2); psi.set(s1=1,s2=2,1.0); PrintData(psi); // Single-site operators auto Sz1 = makeSz(s1);auto Sz2 = makeSz(s2); auto Sp1 = makeSp(s1);auto Sp2 = makeSp(s2); auto Sm1 = makeSm(s1);auto Sm2 = makeSm(s2); // Two-site Heisenberg Hamiltonian auto H = Sz1 * Sz2 + 0.5 * Sp1 * Sm2 + 0.5 * Sm1 * Sp2; // Initial energy expectation value auto initEn = elt(dag(prime(psi)) * H * psi); printfln(\"\\nInitial energy = %.10f\",initEn); // Make exp(-beta*H) // TODO // 3. Adjust beta to get the ground state Real beta = 0.1; auto expH = expHermitian(H,-beta); // Here we apply exp(-beta*H), normalize // and unprime auto psibeta = expH * psi; psibeta.noPrime(); psibeta /= norm(psibeta); PrintData(psibeta); auto En = elt(dag(prime(psibeta)) * H * psibeta); printfln(\"At beta=%.1f, energy = %.10f\",beta,En); // TODO // 1. Adjust the following code to // truncate to dimension 1. // HINT: use the ITensor named argument // system, e.g. {\"MaxDim=\",...} auto [U,D,V] = svd(psibeta,{s1},{\"MaxDim=\",1}); PrintData(D); // TODO // 2. Calculate the overlap of the new // wavefunction with the old wavefunction. // Print your results with PrintData(...). // HINT: use U*D*V to calculate the new, // truncated wavefunction auto newpsi = U * D * V; PrintData(newpsi); Real op = (dag(prime(newpsi)) * H * psibeta).real(); PrintData(op); // TODO // 3. Increase beta (defined above) to get the // ground state. How does the overlap // change? return 0; } è¾“å‡ºå¾—åˆ°.\npsi = ITensor ord=2: (dim=2|id=311|\"s1\") (dim=2|id=239|\"s2\") {norm=1.00 (Dense Real)} (1,2) 1.0000000 Initial energy = -0.2500000000 psibeta = ITensor ord=2: (dim=2|id=311|\"s1\") (dim=2|id=239|\"s2\") {norm=1.00 (Dense Real)} (2,1) -0.049896 (1,2) 0.9987544 At beta=0.1, energy = -0.2998339973 D = ITensor ord=2: (dim=1|id=426|\"U,Link\") (dim=1|id=228|\"V,Link\") {norm=1.00 (Diag Real)} (1,1) 0.9987544 newpsi = ITensor ord=2: (dim=2|id=311|\"s1\") (dim=2|id=239|\"s2\") {norm=1.00 (Dense Real)} (1,2) 0.9987544 op = -0.274295 æ‰€ä»¥åªè¦æˆ‘ä»¬ä¸€ç›´è°ƒæ•´betaçš„å–å€¼åå¤ç¼–è¯‘æ‰§è¡Œ, æœ€åå°±èƒ½å¤Ÿæ‰¾åˆ°èƒ½é‡æœ€ä½æ—¶æ‰€å¯¹åº”çš„betaå€¼.\nSVD å¥‡å¼‚å€¼åˆ†è§£ Singular Value Decomposition\nå¦‚æœMæ˜¯ $m\\times m$ çš„çŸ©é˜µ, é‚£ä¹ˆä¸€å®šå­˜åœ¨è¿™æ ·ä¸€ä¸ªå¼å­:\n$M = U \\Sigma V^*$\nå…¶ä¸­$U$æ˜¯ $m\\times m$ çš„é…‰çŸ©é˜µ, $\\Sigma$ æ˜¯ $m\\times n$ éè´Ÿå®æ•°å¯¹ç„¦çŸ©é˜µ, $V^*$ æ˜¯ $n\\times n$ çš„é…‰çŸ©é˜µ.\nå…¶ä¸­ $\\Sigma$ å¯¹è§’çº¿ä¸Šçš„å…ƒç´  $\\Sigma_{i,i}$ æ˜¯ $M$ çš„å¥‡å¼‚å€¼.\nå¯†åº¦çŸ©é˜µé‡æ•´åŒ–ç¾¤ Density Matrix Renormalization Group\nè¯¥æ–¹æ³•é€šè¿‡çŸ©é˜µä¹˜ç§¯æ€(Matrix Product State,MPS)æ¥è¡¨ç¤ºé‡å­å¤šä½“ç³»ç»Ÿçš„æ³¢å‡½æ•°ç­‰. DMRGæ–¹æ³•æ¥æºäºå¯†åº¦çŸ©é˜µçš„ç†è®ºå’Œé‡æ•´åŒ–ç¾¤çš„æ€æƒ³, å¤§å¹…å‡å°‘ç³»ç»Ÿè‡ªç”±åº¦çš„åŒæ—¶ä¿ç•™äº†ç³»ç»Ÿä¸­çš„ç‰©ç†ç‰¹å¾.\nå¯¹äº\n$$ M= \\begin{bmatrix} 0.435839 \u0026 0.223707 \u0026 0.10\\\\ 0.435839 \u0026 0.223707 \u0026 -0.10 \\\\ 0.223707 \u0026 0.435839 \u0026 0.10 \\\\ 0.223707 \u0026 0.435839 \u0026 -0.10 \\\\ \\end{bmatrix} $$\nå¯ä»¥åˆ†è§£ä¸º $A * D * B$:\n$$ \\begin{bmatrix} 0.5 \u0026-0.5 \u0026 0.5 \\\\ 0.5 \u0026-0.5 \u0026-0.5 \\\\ 0.5 \u0026 0.5 \u0026 0.5 \\\\ 0.5 \u0026 0.5 \u0026-0.5 \\\\ \\end{bmatrix}* \\begin{bmatrix} 0.933 \u0026 0 \u0026 0 \\\\ 0 \u0026 0.300 \u0026 0 \\\\ 0 \u0026 0 \u0026 0.200 \\\\ \\end{bmatrix}* \\begin{bmatrix} 0.707107 \u0026 0.707107 \u0026 0 \\\\ -0.707107 \u0026 0.707107 \u0026 0 \\\\ 0 \u0026 0 \u0026 1 \\\\ \\end{bmatrix} $$\nå¯ä»¥çœ‹å‡º, ä¸¤è¾¹çš„çŸ©é˜µ $A,B$ æ»¡è¶³é…‰çŸ©é˜µçš„å®šä¹‰, å³æœ‰ $A^{\\dagger}A=I,BB^{\\dagger}=I$.è€Œå¯¹è§’çŸ©é˜µ $D$ ,å…ƒç´ æ˜¯éè´Ÿå®æ•°ä¸”é™åºæ’åˆ—.\nå¦‚æœæˆ‘ä»¬ä»åå¾€å‰ä¸€æ­¥æ­¥å»é™¤ $D$ å¯¹è§’çº¿ä¸Šçš„å…ƒç´ , å³\n$$ \\begin{bmatrix} 0.933 \u0026 0 \u0026 0 \\\\ 0 \u0026 0.300 \u0026 0 \\\\ 0 \u0026 0 \u0026 0.200 \\\\ \\end{bmatrix} \\rightarrow \\begin{bmatrix} 0.933 \u0026 0 \u0026 0 \\\\ 0 \u0026 0.300 \u0026 0 \\\\ 0 \u0026 0 \u0026 0 \\\\ \\end{bmatrix} \\rightarrow \\begin{bmatrix} 0.933 \u0026 0 \u0026 0 \\\\ 0 \u0026 0 \u0026 0 \\\\ 0 \u0026 0 \u0026 0 \\\\ \\end{bmatrix} $$\nè¿™ç§æ“ä½œè¢«ç§°ä¸ºæˆªæ–­(Truncating).\nç„¶åä¾æ¬¡é‡æ–°è¿›è¡Œ $M_{i} = A * D_{i} * B$ åˆæˆ, å¹¶ä¸”ä½¿ç”¨èŒƒæ•° $||M_i - M||^2$ æ¥å¯¹åˆæˆåçš„çŸ©é˜µäº§ç”Ÿçš„åå·®ç¨‹åº¦è¿›è¡Œè¯„ä¼°.æˆ‘ä»¬å°†å¯ä»¥çœ‹åˆ°:\n$$ ||M - M||^2 = 0;\\ ||M - M_1||^2 = (0.2)^2;\\ ||M - M_2||^2 = (0.2)^2 + (0.3)^2; $$\næˆ‘ä»¬ä¸éš¾çœ‹å‡º, å…¶å®æˆªæ–­å°±æ˜¯åœ¨é™ä½çŸ©é˜µ $D$ çš„ç§©, é€šè¿‡æŠŠæ¡è¿™ä¸ªæˆªæ–­çš„å¹…åº¦, æˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶æœ€åäº§ç”Ÿ $M_i$ çŸ©é˜µçš„åå·®ç¨‹åº¦. è¿™æ˜¯ä¸€ä¸ªç”¨ç²¾åº¦æ¢é€Ÿåº¦çš„è¿‡ç¨‹.\nåŒè‡ªæ—‹æ³¢å‡½æ•° æˆ‘ä»¬ä¸å¦¨ç”¨æ›´ç‰©ç†ä¸€ç‚¹çš„èƒŒæ™¯æ¥åˆ†æå¥‡å¼‚å€¼åˆ†è§£çš„è¿‡ç¨‹.\nå¯¹äºä¸€ä¸ªçº ç¼ æ€çš„åŒè‡ªæ—‹ç³»ç»Ÿ, æˆ‘ä»¬å·²ç»çŸ¥é“å¯ä»¥å¤„ç†ä¸ºä¸€ä¸ªå…·æœ‰ä¸¤ä¸ª\"è§¦æ‰‹\"(å³ä¸Šæ ‡)çš„ç»“ç‚¹. ä½†æ˜¯æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å…¶ä½œä¸ºä¸€ä¸ªçŸ©é˜µæ¥å¤„ç†, å³ä¸€ä¸ªæ‹¥æœ‰å·¦å³ä¸¤ä¸ª\"è§¦æ‰‹\"çš„ç»“ç‚¹.\n$-^{s_1} -\\square\\square\\square^{\\psi}-^{s_2}-$\nè¿™æ ·, æˆ‘ä»¬å°±å¯ä»¥å¯¹ä¸­é—´çš„ç»“ç‚¹è¿›è¡ŒSVDæ“ä½œ, è¿™æ ·å°±å½¢æˆäº†ä¸€ä¸ªé¡¹é“¾å¼çš„ç»“æ„:\n$-^{s_1} -\\square^{A}-\\square^{D}-\\square^{B}-^{s_2}-$\nè¿™ç§æ³¢å‡½æ•°å½¢å¼, æˆ‘ä»¬å°†å…¶ç§°ä¹‹ä¸º\"çŸ©é˜µä¹˜ç§¯æ€\"(Matrix Product State,MPS).\nä¸ºäº†è®©è¿™ä¸ªç»“æ„çœ‹ä¸Šå»æ›´åƒæ˜¯ä¸€ä¸ªæ³¢å‡½æ•°,å¯ä»¥æƒ³è±¡ä¸¤ä¾§çš„\"è§¦æ‰‹\"æ˜¯å‘ä¸Šçš„(ä¸Šæ ‡).\nä¸å¦¨ç”¨ç¨‹åºæ¥æè¿°è¿™ä¸ªè¿‡ç¨‹.\nITensor A(s1),D,B; //å…ˆå£°æ˜åä½¿ç”¨ svd(psi,A,D,B); æˆ‘ä»¬å·²ç»çŸ¥é“, å¯¹äºä¸€ä¸ªå¯»å¸¸çš„åŒè‡ªæ—‹æ³¢å‡½æ•°, æˆ‘ä»¬éœ€è¦ $(2s + 1)^2$ ä¸ªå‚æ•°æ¥è¿›è¡Œæè¿°. è€Œä¸”ä¸€èˆ¬æƒ…å†µä¸‹, æˆ‘ä»¬å¯¹äºè¿™äº›å‚æ•°çš„é‡è¦ç¨‹åº¦æ˜¯æ— çŸ¥çš„.æ— æ³•æ”¾å¼ƒä»»ä½•ä¸€ä¸ªå‚æ•°, è¿™å°±ä¼šæ€¥å‰§å¢åŠ è®¡ç®—é‡.\nè€ŒSVDç»™äº†æˆ‘ä»¬ä¸€ç§å¯èƒ½: æˆ‘ä»¬ä¸ä»…èƒ½çŸ¥é“å“ªäº›å‚æ•°æœ€é‡è¦, æˆ‘ä»¬è¿˜å¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸ŠæŒæ¡å®ƒä»¬çš„æ•°é‡, è€Œä¸”è¿™ä¸ªæ•°é‡å¾ˆæœ‰å¯èƒ½å¾ˆå°‘(æœ‰åˆ©äºè®¡ç®—!).\næˆ‘ä»¬ç”¨æ–¹ç¨‹æ¥è¡¨è¾¾çŸ©é˜µä¹˜ç§¯æ€çš„æ€æƒ³:\n$$ |\\Psi\\rangle=\\sum_{s_1,\\alpha,\\alphaâ€™,s_2}A_{s_1\\alpha}D_{\\alpha\\alphaâ€™}B_{\\alphaâ€™s_2}|s_1\\rangle|s_2\\rangle $$\nå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†çŸ©é˜µ $A,D$ é¢„å…ˆç›¸ä¹˜å½¢æˆæ–°çŸ©é˜µ $\\psi$, å¼ é‡ç½‘ç»œçš„å½¢å¼å³ä¸º:\n$-^{s_1} -\\square^{A}-\\square^{D}-\\square^{B}-^{s_2}-$\n$\\downarrow$\n$-^{s_1} -\\square\\square^{\\psi}-\\square^{B}-^{s_2}-$\nè¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†\n$$ |\\Psi\\rangle=\\sum_{s_1,\\alphaâ€™,s_2}\\psi_{s_1\\alphaâ€™}B_{\\alphaâ€™s_2}|s_1\\rangle|s_2\\rangle $$\nåŒç†, æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†çŸ©é˜µ $D,B$ é¢„å…ˆç›¸ä¹˜å½¢æˆæ–°çŸ©é˜µ $\\psi$, å¼ é‡ç§¯ç®—ç½‘ç»œçš„å½¢å¼ä¸º\n$-^{s_1} -\\square^{A}-\\square^{D}-\\square^{B}-^{s_2}-$\n$\\downarrow$\n$-^{s_1} -\\square^{A}-\\square\\square^{\\psi}-^{s_2}-$\nè¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†\n$$ |\\Psi\\rangle=\\sum_{s_1,\\alpha,s_2}A_{s_1\\alpha}\\psi_{\\alpha s_2}|s_1\\rangle|s_2\\rangle $$\nQuiz $3$ è§£æ #include \"itensor/all.h\" #include \"itensor/util/print_macro.h\" using namespace itensor; int main(){ // SVD of matrix M int Nrow = 4;int Ncol = 3; auto maxdim = std::min(Nrow,Ncol);//ç¡®å®šæˆªæ–­ç»´åº¦ auto M = Matrix(Nrow,Ncol); M(0,0) = 0.435839; M(0,1) = 0.223707; M(0,2) = 0.10; M(1,0) = 0.435839; M(1,1) = 0.223707; M(1,2) = -0.10; M(2,0) = 0.223707; M(2,1) = 0.435839; M(2,2) = 0.10; M(3,0) = 0.223707; M(3,1) = 0.435839; M(3,2) = -0.10;//åˆå§‹åŒ–çŸ©é˜µ Print(M); //å£°æ˜å˜é‡çš„æ•°æ®ç±»å‹ Matrix U,V; Vector d;//ç”¨æ¥æ¥æ”¶å¯¹è§’å…ƒç´ ,å³å¥‡å¼‚å€¼ SVD(M,U,d,V); Print(U);Print(d);Print(V); int nkeep = 2;//å–çŸ©é˜µçš„æˆªæ–­ç»´åº¦ auto Dtrunc = Matrix(maxdim,maxdim);//åªå£°æ˜ä¸å®šä¹‰,åˆ™åˆå§‹åŒ–ä¸º0 for(auto j : range(nkeep)){ Dtrunc(j,j) = d(j); }//åœ¨å¯¹è§’çº¿ä¸Šå¡«ä¸Šæˆªæ–­ä¿ç•™çš„å¥‡å¼‚å€¼ auto Mtrunc = U*Dtrunc*transpose(V);//é‡æ–°ç»“åˆå½¢æˆé‡‡å–æˆªæ–­åçš„çŸ©é˜µ Print(Mtrunc); auto diff = norm(M-Mtrunc);auto diff2 = sqr(diff);//å–çŸ©é˜µå·®çš„èŒƒæ•°æ¥è¯„ä¼°æˆªæ–­çš„æ•ˆæœ(diff) printfln(\"|M-Mtrunc|^2 = %.2f\",diff2); // SVD of two-site wavefunction auto s1 = Index(2,\"s1\");auto s2 = Index(2,\"s2\");//å£°æ˜æŒ‡æ ‡ auto sing = ITensor(s1,s2);auto prod = ITensor(s1,s2); //Make sing a singlet sing.set(s1=1,s2=2, 1./sqrt(2));sing.set(s1=2,s2=1,-1./sqrt(2)); //Make prod a product state prod.set(s1=1,s2=2,1.); for(Real mix = 0; mix \u003c= 1.; mix += 0.1){ // TODO: ADD CODE here to create // a new wavefunction that is // (1-mix) times a product state plus (mix) // times a singlet (i.e. maximally entangled state). auto wf = (1. - mix) * prod + mix * sing; wf /= norm(wf); //PrintData(wf); // SVD this wavefunction and analyze the results. // Try computing and plotting the entanglement entropy. ITensor A(s1),D,B; Spectrum spec = svd(wf,A,D,B); //PrintData(U);PrintData(D);PrintData(V); auto ent = 0.; //.eig(n)è¿”å›çš„æ˜¯ç¬¬(n+1)ä¸ªæœ¬å¾å€¼,è¿™æ˜¯å› ä¸ºæ•°ç»„ä¸‹æ ‡ä»0å¼€å§‹;.numEigsKept()åˆ™æ˜¯è¡¨ç¤ºçš„ç‰¹å¾å€¼çš„æ•°ç›® for(int n = 0;n \u003c spec.numEigsKept();n++){ auto P = sqr(spec.eig(n)); if(P \u003e 0) ent -= P*log(P); } //åˆ†åˆ«ä»¥ä¸¤ä½å°æ•°å’Œå…­ä½å°æ•°çš„å½¢å¼è¾“å‡º printfln(\"mix = %.2f, entropy = %.6f\\n\", mix, ent); } return 0; } ä¸ºäº†èŠ‚çœç¯‡å¹…,åŸæœ¬éœ€è¦å¤šæ¬¡æ‰§è¡Œçš„PrintData()å‡½æ•°è¢«æ³¨é‡Šäº†. å¦‚æœä½ æœ‰æŸ¥çœ‹å…¶å…·ä½“æ•°å€¼çš„éœ€è¦å¯ä»¥åœ¨è‡ªå·±ä½¿ç”¨çš„æ—¶å€™å¯ç”¨.\nç¼–è¯‘å®Œæˆæ‰§è¡Œ,åœ¨ç»ˆç«¯è¾“å‡º:\nM = |0.4358390 0.2237070 0.1000000| |0.4358390 0.2237070 -0.100000| |0.2237070 0.4358390 0.1000000| |0.2237070 0.4358390 -0.100000| U = |0.5000000 0.5000000 0.5000000| |0.5000000 0.5000000 -0.500000| |0.5000000 -0.500000 0.5000000| |0.5000000 -0.500000 -0.500000| d = 0.932739 0.3 0.2 V = |0.7071068 0.7071068 1.11671818E-16| |0.7071068 -0.707107 -8.81355030E-17| |-1.66426876E-17 -1.41285111E-16 1.0000000| Mtrunc = |0.4358390 0.2237070 -2.89544043E-17| |0.4358390 0.2237070 -2.89544043E-17| |0.2237070 0.4358390 1.34311222E-17| |0.2237070 0.4358390 1.34311222E-17| |M-Mtrunc|^2 = 0.04 mix = 0.00, entropy = 0.000000 mix = 0.10, entropy = 0.010473 mix = 0.20, entropy = 0.042683 mix = 0.30, entropy = 0.094817 mix = 0.40, entropy = 0.160729 mix = 0.50, entropy = 0.230729 mix = 0.60, entropy = 0.293765 mix = 0.70, entropy = 0.340279 mix = 0.80, entropy = 0.364548 mix = 0.90, entropy = 0.365602 mix = 1.00, entropy = 0.346574 Four å››ç»“ç‚¹ å¯¹äºå››èŠ‚ç‚¹çš„çŸ©é˜µä¹˜ç§¯æ€ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™æ ·ä¸€ä¸ªæ–¹ç¨‹å¼æ¥æè¿°ï¼š\n$$ |\\Psi\\rangle=\\sum_{{s},{\\alpha}}M_{\\alpha_1}^{s_1}M_{\\alpha_1\\alpha_2}^{s_2}M_{\\alpha_2\\alpha_3}^{s_3}M_{\\alpha_4}^{s_4}|s_1s_2s_3s_4\\rangle $$\nå‰é¢æˆ‘ä»¬å·²ç»å­¦ä¹ è¿‡æ€ä¹ˆå¤„ç†å°†ä¸¤ä¸ªå•èŠ‚ç‚¹ç»“åˆä¸ºçº ç¼ æ€çš„åŒèŠ‚ç‚¹. æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œå¯ä»¥å°†å…·æœ‰ $s_3$ å’Œ $s_4$ ä¸Šæ ‡çš„ä¸¤ä¸ªå•èŠ‚ç‚¹ç»„åˆå½¢æˆå…·æœ‰ $s_3$ å’Œ $s_4$ ä¸Šæ ‡çš„çº ç¼ æ€åŒèŠ‚ç‚¹.\nç„¶åå°±æ˜¯åˆšæ‰æ‰€å­¦çš„å°†åŒèŠ‚ç‚¹è¿›è¡ŒSVDåˆ†è§£, è€Œè¿™é‡Œæˆ‘ä»¬è¦åˆ†è§£çš„å¯¹è±¡å°±æ˜¯åˆšæ‰åˆæˆçš„çº ç¼ æ€åŒèŠ‚ç‚¹ã€‚\nä¸ºäº†ç»§ç»­ä¿æŒå››èŠ‚ç‚¹çš„æ€§è´¨ï¼Œæˆ‘ä»¬å°†åˆ†è§£å‡ºçš„A,Då’ŒBä¸­çš„Aä¸Dç»“åˆ,å…¶ä¸Šæ ‡æ˜¯ $s_3$ ,è€Œå‰©ä¸‹æ¥çš„Båˆ™å•ç‹¬ä½œä¸ºç»“ç‚¹, å…¶ä¸Šæ ‡æ˜¯ $s_4$.\nä»¥è¿™ç§æ–¹å¼å¾—åˆ°çš„æ–°çš„å››èŠ‚ç‚¹å¼ é‡, æˆ‘ä»¬ç§°ä¹‹ä¸º\"å³æ­£äº¤\"(Right Orthogonal)æˆ–è€…è¯´\"å³è§„èŒƒ\", è¿™æ˜¯å› ä¸ºå•ç‹¬ä½œä¸ºç»“ç‚¹çš„ $B$ æ˜¯ é…‰çš„ ($BB^{\\dagger}=I$).\næ˜¾ç„¶, è¿™ç§å³æ­£äº¤çš„æ€§è´¨æ˜¯å¯ä»¥å‘å·¦ä¼ é€’çš„. æ¯”å¦‚, æˆ‘ä»¬å–å·²ç»å®Œæˆäº†SVDå’ŒADç»“åˆçš„å››èŠ‚ç‚¹å¼ é‡ä¸­çš„å…·æœ‰ $s_2$ å’Œ $s_3$ ä¸Šæ ‡çš„å•èŠ‚ç‚¹é‡å¤ä¸Šè¿°æ“ä½œ, ä¾¿å¯ä»¥è®©å…·æœ‰ä¸Šæ ‡ $s_3$ çš„å•èŠ‚ç‚¹ä¹Ÿå…·æœ‰å³æ­£äº¤çš„æ€§è´¨.ä¾æ­¤ç±»æ¨, ä½¿å¾—é™¤äº† $s_1$ ä¹‹å¤–çš„æ‰€æœ‰å•èŠ‚ç‚¹éƒ½å…·æœ‰å³æ­£äº¤çš„æ€§è´¨.\næœŸæœ›å€¼ $\\langle\\hat{A}_1\\rangle$ æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªå…·æœ‰4é‡å­ä½çš„çº ç¼ æ€æ³¢å‡½æ•°æ±‚ç¬¬ä¸€é‡å­ä½ç®—ç¬¦çš„æœŸæœ›å€¼çš„è¿‡ç¨‹.\nåœ¨ä¸€èˆ¬æƒ…å†µä¸‹,æˆ‘ä»¬é€šå¸¸æ˜¯è¿™æ ·æ±‚è§£çš„(å‡è®¾ $|\\psi\\rangle$ å·²ç»è§„ä¸€åŒ–):\n$$ \\langle\\hat{A_1}\\rangle=\\sum_{s}\\overline{\\psi}_{sâ€™_{1}s_{2}s_{3}s_{4}}A_{sâ€™_{1}s_{1}}\\psi_{s_{1}s_{2}s_{3}s_{4}} $$\nè¿™ä¸ªè¿‡ç¨‹æ˜¾ç„¶æ˜¯åŠå…¶ç¹æ‚çš„, åœ¨è¿™ç§æƒ…å†µä¸‹æ—¶é—´å¤æ‚åº¦ä»¥ $O(2^n)$ çš„é€Ÿåº¦å¢é•¿, å¦‚æœä¸ä»¥æŸç§ç®—æ³•è¿›è¡Œç®€åŒ–å¿…ç„¶æå…¶è€—æ—¶.\nå¦‚æœæ˜¯å·²ç»ç»è¿‡äº† SVD åˆ†è§£çš„çº ç¼ æ€æ³¢å‡½æ•°, é™¤äº†ç¬¬ä¸€é‡å­ä½ $s_1$ , å…¶ä½™çš„æ‰€æœ‰å•èŠ‚ç‚¹å…¨éƒ¨éƒ½å…·æœ‰å³æ­£äº¤æ€§è´¨, è€Œæˆ‘ä»¬æ±‚çš„æ˜¯ç¬¬ä¸€é‡å­ä½çš„ç®—ç¬¦çš„æœŸæœ›å€¼, è¿™ä¹Ÿæ„å‘³ç€å…¶ä½™é‡å­ä½ç»“åˆä¸ä¼šå¯¹ç¬¬ä¸€é‡å­ä½çš„è¿ç®—äº§ç”Ÿä»»ä½•å½±å“.\né€šè¿‡è¿™æ ·çš„ç®—æ³•, è®¡ç®—é‡å¾—åˆ°äº†å¤§é‡ç®€åŒ–.\nç”¨ç¨‹åºè¯­è¨€æ¥æè¿°è¿™ä¸ªè¿‡ç¨‹:\nSpinHalf sites(N); //è¡¨ç¤ºsitesæ˜¯Nä¸ª1/2è‡ªæ—‹é‡å­ä½çš„ä½“ç³» MPS psi(sites); //ä»¥çŸ©é˜µä¹˜ç§¯æ€è¡¨ç¤ºsitesä½“ç³»çš„æ³¢å‡½æ•°, å¹¶ä¸”ç”¨psiæ¥ç§°å‘¼è¿™ä¸ªæ³¢å‡½æ•° computeGroundState(H,psi);//å¯»æ‰¾å“ˆå¯†é¡¿é‡Hä¸‹çš„åŸºæ€, psiè¢«ç”¨ä»¥è¿›è¡Œåˆå§‹åŒ– psi.position(2);//å°†psiçš„æ­£åˆ™ä½ç½®è®¾ç½®ä¸ºç¬¬äºŒä¸ªä½ç½®. Real sz_expect = (dag(prime(psi.A(2),Site)) * sites.op(\"Sz\",2) * psi.A(2)).real(); æ­£åˆ™ä½ç½®Canonical Position\nåœ¨å‰é¢çš„SVDå’Œregroupè¿‡ç¨‹ä¸­æˆ‘ä»¬åªæåˆ°äº†\"å³è§„èŒƒ\", å®é™…ä¸Šæˆ‘ä»¬ä¹Ÿå¾ˆå®¹æ˜“å°†å…¶æ¨å¹¿åˆ°\"å·¦è§„èŒƒ\", è¿™æ ·çš„è¯æˆ‘ä»¬å°±å¯ä»¥å°†æ­£åˆ™ä½ç½®å®šä¹‰ä¸º\"å·¦è§„èŒƒ\"å’Œ\"å³è§„èŒƒ\"åŒæ—¶æˆç«‹çš„ä½ç½®.\nåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­,å› ä¸ºæˆ‘ä»¬è¦æ±‚çš„æ˜¯ç¬¬äºŒé‡å­ä½çš„è‡ªæ—‹æœŸæœ›å€¼, ä¸ºäº†ç®€åŒ–æˆ‘ä»¬å°±è¦å°†å…¶å·¦å³çš„å…¨éƒ¨ç»“ç‚¹éƒ½è§„èŒƒåŒ–(å…·ä½“ç»“åˆçš„æ–¹å‘çœ‹æ­£åˆ™ä½ç½®çš„å·¦å³).\nQuiz $4$ è§£æ çŸ©é˜µä¹˜ç§¯ç®—å­Matrix Product Operator(MPO)\nå’ŒçŸ©é˜µä¹˜ç§¯æ€(MPS)ç›¸ä¼¼, MPOä¹Ÿæ˜¯ä¸€ç§å¼ é‡ç½‘ç»œçš„è¡¨ç¤ºæ–¹æ³•. å®ƒå¯ä»¥ç”¨æ¥æè¿°å¤æ‚é‡å­ç³»ç»Ÿçš„å“ˆå¯†é¡¿é‡.\n#include \"itensor/all.h\" #include \"itensor/util/print_macro.h\" using namespace itensor; using std::vector; int main(){ int N = 50;//å®šä¹‰ä¸€ä¸ªåŒ…å«50ä¸ª1/2è‡ªæ—‹çš„ç³»ç»Ÿ'sites' auto sites = SpinHalf(N,{\"ConserveQNs=\",false});//\"ConserveQNs=\"è®¾ä¸ºfalse,è¡¨ç¤ºä¸è€ƒè™‘é‡å­æ•°å®ˆæ’. // TODO // 3. Adjust the external field to see how the // magnetization changes Real h = 0.5; //è°ƒæ•´hæ¥æ‰¾åˆ°ç›¸å˜ç‚¹.h = 1 æ—¶,ç³»ç»Ÿä»ç£æ€§ç›¸å˜æ— åºç›¸. // Create the MPO for the transverse field // Ising model auto ampo = AutoMPO(sites); //åˆ›å»ºä¸€ä¸ªè‡ªåŠ¨æ„é€ MPOçš„å¯¹è±¡'ampo' //ä¾æ¬¡èµ‹å€¼ for(int j = 1; j \u003c N; ++j){ ampo += -4.0,\"Sz\",j,\"Sz\",j+1; } for(int j = 1; j \u003c= N; ++j){ ampo += -2*h,\"Sx\",j; } //å“ˆå¯†é¡¿é‡çš„ç±»å‹æ˜¯MPO, åˆ©ç”¨toMPO()å‡½æ•°å°†ampoé‡Œè•´å«çš„ä¿¡æ¯è½¬åŒ–ä¸ºå“ˆå¯†é¡¿é‡ auto H = toMPO(ampo); // Create a random starting state // For DMRG //éšæœºç”Ÿæˆä¸€ä¸ªåˆå§‹æ€ auto psi0 = randomMPS(sites); // Run DMRG to get the ground state auto sweeps = Sweeps(5); //è®¾ç½®å¯†åº¦çŸ©é˜µé‡æ•´åŒ–ç¾¤ç®—æ³•(DMRG)çš„æœ€å¤§è¿­ä»£æ¬¡æ•° sweeps.maxdim() = 5,10,20; //è®¾ç½®å¯†åº¦çŸ©é˜µé‡æ•´åŒ–ç¾¤ç®—æ³•(DMRG)çš„æœ€å¤§çº ç¼ çŸ©é˜µç»´åº¦çš„åºåˆ— sweeps.cutoff() = 1E-10; //è®¾ç½®å¥‡å¼‚å€¼çš„æˆªæ–­ç²¾åº¦, åªæœ‰å¤§äºè¯¥å€¼çš„å¥‡å¼‚å€¼æ‰ä¼šè¢«ä¿ç•™ auto [E,psi] = dmrg(H,psi0,sweeps,{\"Quiet\",true}); //Hä¸ºç³»ç»Ÿçš„å“ˆå¯†é¡¿é‡, ä»¥psi0ä½œä¸ºè¿­ä»£èµ·ç‚¹è¿è¡Œç®—æ³•, //'sweeps'æ˜¯è¿­ä»£çš„å‚æ•°, //'{\"Quiet\",true}'è¡¨ç¤ºé™é»˜è¿è¡Œ(ä¸è¾“å‡ºè¯¦ç»†çš„è¿­ä»£ä¿¡æ¯) //è¿”å›å€¼ä¸ºåŸºæ€èƒ½é‡å’ŒåŸºæ€æ³¢å‡½æ•°, ä»¥é‡ E å’Œ psi å¯¹è®¡ç®—ç»“æœè¿›è¡Œå­˜å‚¨ //åœ¨ç»ˆç«¯æŸ¥çœ‹åŸºæ€èƒ½é‡å€¼ printfln(\"Ground state energy = \",E); // å¯¹psiè¿›è¡Œå…±è½­è½¬ç½®. æ­¤æ—¶psidagä¸Šæ ‡çº§åˆ«ä¸º2. auto psidag = dag(prime(psi)); // A vector holding the operators used // in the expectation value. // All set to identity operators to start. // Note: this is one-indexed // (O[n] is the operator on site n) //åˆ›å»ºé•¿ä¸ºN+1çš„å‘é‡, ç”¨äºå­˜å‚¨æµ‹é‡ç®—ç¬¦.O[j]ä»£è¡¨åœ¨ç¬¬jä¸ªé‡å­ä½ä¸Šçš„æµ‹é‡ç®—ç¬¦ auto O = vector\u003cITensor\u003e(N+1); //å¯¹Oè¿›è¡Œåˆå§‹åŒ–,æ–¹æ³•æ˜¯å°†æ‰€æœ‰çš„æµ‹é‡ç®—ç¬¦éƒ½è®¾ä¸ºå•ä½ç®—ç¬¦ for(auto j : range1(N)){ O[j] = op(sites,\"Id\",j); //\"Id\"æ„æŒ‡\"Identity\", å³å•ä½ç®—ç¬¦ } // Position we will place our operator // å°†æœ¬å¾ä½ç½®é€‰ä¸ºæ­£ä¸­, å³N/2.ä»¥è¿™ä¸ªä½ç½®æ¥æ‰§è¡Œæµ‹é‡ int Npos = N/2; // TODO // 1. Add an operator to measure the magnetization // in the z direction at Npos. // HINT: use the op(...) function. // It provides spin operators \"Sx\", \"Sy\", \"Sz\", // you may want to scale your operator // to make it a Pauli matrix auto op_z = 2.0 * op(sites,\"Sz\",Npos); O[Npos] = op_z; // TODO // 2. Complete the following code // to measure the magnetization. // Print your results with PrintData(...) auto o = psidag(1) * O[1] * psi(1); for(auto j : range1(2,N)){ o *= psidag(j) * O[j] * psi(j); } PrintData(o); // TODO // 3. Adjust the transverse field h at the top of the // file to find the critical point. // HINT: think about the field limits h -\u003e 0 // and h -\u003e infinity return 0; } ç¼–è¯‘æ‰§è¡Œåç»ˆç«¯è¾“å‡ºï¼š\nvN Entropy at center bond b=25 = 0.002062540436 Eigs at center bond b=25: 0.9998 Largest link dim during sweep 1/5 was 4 Largest truncation error: 4.11222e-11 Energy after sweep 1/5 is -51.205898332822 Sweep 1/5 CPU time = 0.0146s (Wall time = 0.0177s) vN Entropy at center bond b=25 = 0.006828488484 Eigs at center bond b=25: 0.9992 Largest link dim during sweep 2/5 was 10 Largest truncation error: 1.88078e-08 Energy after sweep 2/5 is -51.298393038956 Sweep 2/5 CPU time = 0.0181s (Wall time = 0.0181s) vN Entropy at center bond b=25 = 0.002920154202 Eigs at center bond b=25: 0.9997 Largest link dim during sweep 3/5 was 18 Largest truncation error: 9.69913e-11 Energy after sweep 3/5 is -52.306536772989 Sweep 3/5 CPU time = 0.0210s (Wall time = 0.0210s) vN Entropy at center bond b=25 = 0.002920148259 Eigs at center bond b=25: 0.9997 Largest link dim during sweep 4/5 was 6 Largest truncation error: 9.45633e-11 Energy after sweep 4/5 is -52.306549436787 Sweep 4/5 CPU time = 0.0179s (Wall time = 0.0180s) vN Entropy at center bond b=25 = 0.002920145615 Eigs at center bond b=25: 0.9997 Largest link dim during sweep 5/5 was 5 Largest truncation error: 9.18628e-11 Energy after sweep 5/5 is -52.306549436806 Sweep 5/5 CPU time = 0.0168s (Wall time = 0.0168s) Ground state energy = -52.3065 o = ITensor ord=0: {norm=0.96 (Dense Real)} -0.964679 â€œå°è½¦â€ Trotter â€“ Suzuki formula ä¸Šä¸€ç« ä¸­æˆ‘ä»¬æµ‹é‡çš„æ˜¯å•ä¸ªé‡å­ä½çš„æœŸæœ›å€¼, å½“æˆ‘ä»¬å¢åŠ æœ‰æ•ˆç®—å­(æŒ‡åœ¨è¯¥é‡å­ä½ä¸Šå¹¶éå•ä½ç®—ç¬¦\"Id\")çš„æ•°é‡, å¼ é‡ç½‘ç»œçœ‹ä¸Šå»å°±å¦‚åŒå°è½¦ä¸€èˆ¬.\nä¸Šè¿°è¯­å¥å‡ä¸ºå¼ºè¡Œè§£é‡Š.äº‹å®ä¸Šè¿™ä¸ªç®—æ³•æ¥æºäºæ¨¡æ‹Ÿå“ˆå¯†é¡¿é‡åŠ¨åŠ›å­¦ä¸­çš„Trotter â€“ Suzuki formula, Trotteråˆ°åº•æ˜¯å½¢å®¹\"å°è½¦\"è¿˜æ˜¯äººåå®é™…ä¸Šå¹¶ä¸å¤ªæ¸…æ¥š.\nç°åœ¨æˆ‘ä»¬è®¾æƒ³ä¸€ä¸ªå·²ç»å¯¹äºç›¸é‚»çš„ä¸¤ä¸ªé‡å­ä½çš„å·¦/å³éƒ½å·²ç»å®Œæˆå·¦/å³è§„èŒƒåŒ–,é‚£ä¹ˆç°åœ¨è¦åšçš„å°±æ˜¯è®¡ç®—è¿™ä¸¤ä¸ªç›¸é‚»é‡å­ä½ä¸Šå¯¹åº”ç®—ç¬¦çš„æœŸæœ›å€¼.\nå’Œå‰é¢ç« èŠ‚ä¸­å¤„ç†äºŒé‡å­ä½çš„çº ç¼ æ€ç±»ä¼¼, æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸¤ä¸ªé‡å­ä½è¿›è¡Œåˆå¹¶, è¿›è¡ŒSVDåˆ†è§£, å†é‡ç»„(è‡³äºæ˜¯ADç»„åˆè¿˜æ˜¯DBç»„åˆ,å¯ä»¥æ ¹æ®è‡ªå·±éœ€æ±‚æ¥è°ƒæ•´).\næ³¨æ„: è¿™ç§ç®—æ³•ä»…é€‚ç”¨äºç›¸é‚»é‡å­ä½å¹¶ä¸å±äºåŒä¸€æ–¹å‘è§„èŒƒçš„æƒ…å†µ(æ¯”å¦‚å¹¶ä¸æ˜¯ä¸¤ä¸ªæ­£åˆ™ä½ç½®, è€Œæ˜¯åœ¨æ­£åˆ™ä½ç½®çš„åŒä¸€è¾¹), å¦åˆ™ä»¥æˆªæ–­SVDæ–¹æ³•è®¡ç®—å¾—åˆ°çš„ç»“æœå¹¶éå…¨å±€æœ€ä¼˜.\nTrotterç®—æ³•çš„ç²¾é«“åœ¨äº,å°†å“ˆå¯†é¡¿é‡(ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€ç”¨çš„ç®—å­)åˆ†è§£ä¸ºè‹¥å¹²ä¸ªå¯ä»¥ç‹¬ç«‹æ¼”åŒ–çš„å°å—, è€Œä¸”å¦‚æœå“ˆå¯†é¡¿é‡æ˜¯çŸ­ç¨‹ç›¸äº’ä½œç”¨, é‚£ä¹ˆè¿™ç§åˆ†è§£çš„æ•ˆæœå°±æ›´å¥½. å¯¹äºé•¿ç¨‹ä½œç”¨çš„å“ˆå¯†é¡¿é‡Trotterç®—æ³•çš„æ•ˆç‡å°±ä¼šæ˜æ˜¾é™ä½.åœ¨ä¸Šé¢æˆ‘ä»¬æ‰€ä¸¾çš„ä¾‹å­é‡Œ, æœ‰æ•ˆçš„å“ˆå¯†é¡¿é‡ä»…æ¶‰åŠä¸¤ä¸ªç›¸é‚»çš„é‡å­ä½, å¯ä»¥è¯´æ˜¯ç¬¦åˆçŸ­ç¨‹çš„å®šä¹‰.\nå¦‚æœå“ˆå¯†é¡¿é‡ä¸­çš„ç›¸äº’ä½œç”¨éƒ½æ˜¯çŸ­ç¨‹çš„, æˆ‘ä»¬å¯ä»¥å°†å“ˆå¯†é¡¿é‡åˆ†è§£ä¸ºå°å—, ç”¨è‡ªæ—‹ç³»ç»Ÿä¸ºä¾‹, æˆ‘ä»¬å¯ä»¥ç”¨è¿™æ ·çš„æ–¹ç¨‹æ¥æè¿°:\n$$ \\begin{equation} \\hat{H}=\\hat{H_1}+\\hat{H_2}+\\hat{H_3}+\\dots \\\\ =\\sum_{j}\\hat{S_{j}}\\cdot\\hat{S_{j+1}} \\\\ =(\\hat{S_{1}}\\cdot\\hat{S_{2}})+(\\hat{S_{2}}\\cdot\\hat{S_{3}})+(\\hat{S_{3}}\\cdot\\hat{S_{4}})\\dots \\end{equation} $$\né‚£ä¹ˆå‡è®¾ç³»ç»Ÿæ¼”åŒ–äº†ä¸€æçŸ­çš„è™šæ—¶é—´ $\\tau$,æˆ‘ä»¬å¯ä»¥å°†ç³»ç»Ÿçš„æ¼”åŒ–å†™ä½œ:\n$$ \\begin{aligned} e^{-\\tau\\hat{H}}\\approxeq \u0026e^{-\\tau\\hat{H_1}/2}e^{-\\tau\\hat{H_2}/2}e^{-\\tau\\hat{H}_3/2}\\dots\\ \u0026\\dots e^{-\\tau\\hat{H}_3/2}e^{-\\tau\\hat{H_2}/2}e^{-\\tau\\hat{H_1}/2}+O(\\tau^3) \\end{aligned} $$\nè™šæ—¶æ¼”åŒ–\nå¯¹äºä¸€ä¸ªä¸€èˆ¬çš„è¡¨è¾¾å¼ $|\\psiâ€™\\rangle=e^{-\\tau\\hat{H}}|\\psi\\rangle$ (çœç•¥äº† $\\hbar$ ),æœ‰ä¸¤ç§æƒ…å†µ:\n$\\tau$ æ˜¯å®æ•°, é‚£ä¹ˆç›¸å½“äº $\\tau = i\\tauâ€™$, å…¶ä¸­ $\\tauâ€™$æ˜¯è™šæ—¶é—´. é‚£ä¹ˆæˆ‘ä»¬åªè¦æ‰§è¡Œè¶³å¤Ÿå¤šæ­¥, å°±å¯ä»¥æœç´¢åˆ°åŸºæ€. $\\tau$ æ˜¯è™šæ•°, é‚£ä¹ˆå°±æ˜¯ä¸€èˆ¬çš„åŠ¨åŠ›å­¦è¡¨è¿°, ç›¸å½“äº $\\tau = it$, åŸæ–¹ç¨‹å˜ä¸º $|\\psiâ€™\\rangle=e^{-it\\hat{H}}|\\psi\\rangle$ å¯¹äºç¬¬ä¸€ç§æƒ…å†µ, æœ‰ä¸€ç§åº”ç”¨çš„ä¾‹å­, å³é€šè¿‡å– $\\beta/2=1/(2T)$ çš„è™šæ—¶æ¼”åŒ–æ¥æ¨¡æ‹Ÿæœ‰é™æ¸©åº¦.\næ›´è¯¦ç»†çš„è¯´, å°±æ˜¯å– $\\tau = \\frac{1}{k_BT}$ ,å°±ç›¸å½“äºè¿›è¡Œäº†ä¸€æ¬¡è™šæ—¶é—´æ¼”åŒ–. åœ¨æ¯ä¸€æ­¥æ‰§è¡Œå®Œæˆåæˆ‘ä»¬è¦å¯¹ç³»ç»Ÿçš„çŠ¶æ€è¿›è¡Œè®°å½•, ä»è€Œå¯¹ç³»ç»Ÿçš„åœ¨æ¸©åº¦Tä¸‹çš„æ€§è´¨è¿›è¡Œç»Ÿè®¡å¹³å‡.\næˆ‘ä»¬ç”¨.gif æ¥æ¼”ç¤ºè¿™ä¸€è¿‡ç¨‹:\nå› ä¸ºæˆ‘ä»¬æ¯ä¸€æ­¥éƒ½åªå–äº†æ¯ä¸ªé‡å­ä½å¯¹åº”åˆ†å—å“ˆå¯†é¡¿é‡çš„ $\\frac{1}{2}$ ,æ‰€ä»¥é€šè¿‡å¾€è¿”æ‰§è¡Œä¸€éå¯ä»¥ä¸æ”¹å˜çº ç¼ æ€çš„è§„èŒƒæ€§.\nQuiz 5 è§£æ #include \"itensor/all.h\" #include \"itensor/util/print_macro.h\" using std::vector; using std::move; using namespace itensor; struct TGate{ int i1 = 0;int i2 = 0; //i1, i2æ˜¯ç”¨æ¥æŒ‡å®šè™šæ—¶æ¼”åŒ–ç®—å­ä¸­äº§ç”Ÿä½œç”¨çš„ä¸¤ä¸ªè‡ªæ—‹é‡å­ä½ç¼–å· ITensor G; //Gè¢«å£°æ˜ä¸ºITensorç±»å‹ï¼Œç”¨æ¥å­˜å‚¨å…·ä½“çš„è™šæ—¶æ¼”åŒ–ç®—å­å€¼ TGate() { } TGate(int i1_, int i2_, ITensor G_) : i1(i1_), i2(i2_), G(G_) { } }; int main(){ int N = 20; auto sites = SpinHalf(N);//å£°æ˜ç³»ç»Ÿæ˜¯20ä¸ª1/2è‡ªæ—‹å­çš„ç³»ç»Ÿ auto init = InitState(sites); for(auto n : range1(N)){ init.set(n, n%2 == 1 ? \"Up\" : \"Dn\"); }//å¹¶ä¸”å°†è¯¥ç³»ç»Ÿåˆå§‹åŒ–ä¸ºNeelæ€(ç›¸é‚»è‡ªæ—‹æ€»ç›¸å) //å°†è¯¥çŠ¶æ€inité€šè¿‡MPS()è½¬è¯‘ä¸ºçŸ©é˜µä¹˜ç§¯æ€(MPS)çš„å½¢å¼ auto psi = MPS(init); //å®šä¹‰è™šæ—¶æ¼”åŒ–çš„æ€»æ—¶é—´å’Œæ—¶é—´é—´éš”(æ­¥é•¿) Real ttotal = 2;Real tstep = 0.1; //æ£€æŸ¥æ—¶é—´æ­¥é•¿å’Œæ€»æ—¶é—´æ˜¯å¦åˆæ³• auto nt = int(ttotal/tstep+(1e-9*(ttotal/tstep))); if(std::fabs(nt*tstep-ttotal) \u003e 1E-9){ Error(\"Timestep not commensurate with total time\"); } //Create Trotter gates (imaginary time) //å®šä¹‰æ•°æ®ç±»å‹ä¸ºTGateçš„vectorå®¹å™¨ï¼Œç”¨æ¥å­˜å‚¨è™šæ—¶æ¼”åŒ–ç®—å­ auto gates = vector\u003cTGate\u003e{}; for(int b = 1; b \u003c N; ++b){ //ä»å¤´å¼€å§‹æ„å»ºå“ˆå¯†é¡¿é‡ auto hh = op(sites,\"Sz\",b)*op(sites,\"Sz\",b+1); hh += 0.5*op(sites,\"Sp\",b)*op(sites,\"Sm\",b+1); hh += 0.5*op(sites,\"Sm\",b)*op(sites,\"Sp\",b+1); //è®¡ç®—åŠæ­¥é•¿çš„è™šæ—¶æ¼”åŒ–ç®—å­ auto G = expHermitian(hh,-tstep/2.); //å°†è™šæ—¶æ¼”åŒ–ç®—å­å­˜å‚¨åˆ°åä¸ºgatesçš„å®¹å™¨ä¸­(åºåˆ—å°¾éƒ¨) //båœ¨æ¯ä¸ªå¾ªç¯ä¸­éƒ½æœ‰ä¸€ä¸ªå€¼. ä¸‹é¢çš„bå’Œb+1æ˜¯æŒ‡åº”ç”¨ç®—å­çš„ä½ç½®. gates.emplace_back(b,b+1,move(G)); } for(int b = N-1; b \u003e= 1; --b){ //ä»å°¾å¼€å§‹æ„å»ºå“ˆå¯†é¡¿é‡ ITensor hh = op(sites,\"Sz\",b)*op(sites,\"Sz\",b+1); hh += 0.5*op(sites,\"Sp\",b)*op(sites,\"Sm\",b+1); hh += 0.5*op(sites,\"Sm\",b)*op(sites,\"Sp\",b+1); //è®¡ç®—åŠæ­¥é•¿çš„è™šæ—¶æ¼”åŒ–ç®—å­ auto G = expHermitian(hh,-tstep/2.); //å°†è™šæ—¶æ¼”åŒ–ç®—å­å­˜å‚¨åˆ°åä¸ºgatesçš„å®¹å™¨ä¸­(åºåˆ—å°¾éƒ¨) //båœ¨æ¯ä¸ªå¾ªç¯ä¸­éƒ½æœ‰ä¸€ä¸ªå€¼. ä¸‹é¢çš„bå’Œb+1æ˜¯æŒ‡åº”ç”¨ç®—å­çš„ä½ç½®. gates.emplace_back(b,b+1,move(G)); } for(int step = 1; step \u003c= nt; ++step){ //å°†ä¹‹å‰è®¡ç®—å­˜å‚¨å¥½çš„åˆ†å—ç®—å­ä¸€ä¸€å–å‡º for(auto\u0026 gate : gates){ //è¯»å–åˆ†å—ç®—å­å¯¹åº”çš„ä½œç”¨ä½ç½® auto b = gate.i1; //è¯»å–åˆ†å—ç®—å­çš„å…·ä½“å€¼ auto\u0026 G = gate.G; //è®¾ç½®æ­£åˆ™ä½ç½®ä¸ºå½“å‰å¾ªç¯ä¸­çš„b psi.position(b); //å°†ç›¸é‚»é‡å­ä½bå’Œb+1åˆæˆä¸ºæ–°å¼ é‡AA auto AA = psi(b) * psi(b+1); // TODO: ADD CODE here that applies // the gate G to the MPS bond // tensor \"AA\" by multiplying // G and AA using the * operator // G is an ITensor // with index structure: // s_{b}' s_{b+1}' // | | // ======== // | | // s_{b} s_{b+1} // After applying G to AA, don't forget // to reset the prime level to 0 by using // the noPrime method. //å°†Gå’ŒAAç›¸ä¹˜ AA *= G; AA.noPrime();//å°†AAçš„ä¸Šæ ‡çº§åˆ«é™ä¸º0, å› ä¸ºSVDæ“ä½œè¦æ±‚ä¸Šæ ‡çº§åˆ«æ˜¯ä¸€è‡´çš„ //Normalize AA after applying G AA /= norm(AA); //SVD AA to restore MPS form auto [U,D,V] = svd(AA,inds(psi(b)),{\"Cutoff\",1E-10}); psi.set(b,U); psi.set(b+1,D*V); } printfln(\"Step %d/%d\",step,nt); } //Make Heisenberg H to //conveniently measure energy auto ampo = AutoMPO(sites); for(auto j : range1(N-1)){ ampo += 0.5,\"S+\",j,\"S-\",j+1; ampo += 0.5,\"S-\",j,\"S+\",j+1; ampo += \"Sz\",j,\"Sz\",j+1; } auto H = toMPO(ampo); printfln(\"Energy = %.20f\",inner(psi,H,psi)); // Exact ground state energy of N=20 // Heisenberg model:E0 = -8.6824733306 return 0; } ç¼–è¯‘æ‰§è¡Œå, åœ¨ç»ˆç«¯è¾“å‡ºçš„ç»“æœ:\nStep 1/20 Step 2/20 Step 3/20 Step 4/20 Step 5/20 Step 6/20 Step 7/20 Step 8/20 Step 9/20 Step 10/20 Step 11/20 Step 12/20 Step 13/20 Step 14/20 Step 15/20 Step 16/20 Step 17/20 Step 18/20 Step 19/20 Step 20/20 Energy = -8.51422469470028886462 æœ€åçš„ç»“æœå’Œç†è®ºä¸Šè®¡ç®—å¾—åˆ°çš„ $-8.6824733306$ ç›¸å·®çº¦ä¸º $1.94%$, å¯ä»¥è¯´å·®è·ä¸å¤§.\nçŸ©é˜µä¹˜ç§¯ç®—å­ MPO æˆ‘ä»¬å·²ç»çŸ¥é“, åœ¨å¼ é‡ç½‘ç»œä¸­, ä¸€ä¸ªå“ˆå¯†é¡¿é‡ $\\hat{H}$ çœ‹ä¸Šå»å¤§æ¦‚æ˜¯è¿™ä¸ªæ ·å­:\n$$ \\sum_{|}^{|}\\sum_{|}^{|}\\sum_{|}^{|}\\sum_{|}^{|}\\sum_{|}^{|} $$\nè€Œä¸€ä¸ªå¯¹åº”é‡å­ä½æ•°çš„çº ç¼ æ€æ³¢å‡½æ•° $|\\Psi\\rangle$ åˆ™æ˜¯è¿™æ ·:\n$$ \\sum^{|}-\\sum^{|}-\\sum^{|}-\\sum^{|}-\\sum^{|} $$\nåœ¨ä¸Šé¢çš„å­¦ä¹ ä¸­æˆ‘ä»¬å·²ç»çŸ¥é“, è¦è®© $\\hat{H}$ ä½œç”¨åˆ° $|\\Psi\\rangle$ ä¸Š, å…¶å®å°±æ˜¯å°†ä¸Šä¸‹æ ‡è¿›è¡Œç»“åˆçš„è¿‡ç¨‹.\né‚£ä¹ˆæ—¢ç„¶ $|\\Psi\\rangle$ èƒ½å¤Ÿå†™ä½œçŸ©é˜µä¹˜ç§¯çš„å½¢å¼, æˆ‘ä»¬è‡ªç„¶ä¹Ÿå¯ä»¥å¯¹ $\\hat{H}$ è¿›è¡ŒåŒæ ·çš„è¦æ±‚,å°†å…¶åŒ–ä¸ºå¼ é‡ç½‘ç»œä¸­çš„è¿™ç§å½¢å¼:\n$$ \\sum_{|}^{|}-\\sum_{|}^{|}-\\sum_{|}^{|}-\\sum_{|}^{|}-\\sum_{|}^{|} $$\næˆ‘ä»¬å–å…¶ä¸­ä¸€ä¸ªå¼ é‡è¿›è¡Œåˆ†æ:\n$$ ^{1}-\\sum_{|_{4}}^{|^{3}}-^{2} $$\nè¿™é‡Œé¢çš„$1$å’Œ$2$ä»£è¡¨çš„æ—¶å¼ é‡å·¦å³çš„æŒ‡æ ‡, è€Œ$3$å’Œ$4$ä»£è¡¨çš„æ˜¯å¼ é‡ä¸Šä¸‹çš„æŒ‡æ ‡(é€šå¸¸å’Œä½œç”¨ä¸æŸé‡å­ä½æˆ–å…¶å®ƒç‰©ç†é‡æœ‰å…³). å¤šä¸ªè¿™æ ·çš„å¼ é‡ä¹˜åœ¨ä¸€èµ·å°±èƒ½åŒ–æˆçŸ©é˜µä¹˜ç§¯ç®—å­çš„å½¢å¼.\næˆ‘ä»¬ä¸å¦¨ç”¨ä¸€ä¸ªæ›´å…·ä½“çš„ä¾‹å­:\n$$\\hat{H} = \\begin{bmatrix} 0 \u0026 1\\\\ \\end{bmatrix}_{A} \\begin{bmatrix} \\hat{I} \u0026 \\\\ \\hat{\\sigma}^{z} \u0026 \\hat{I}\\\\ \\end{bmatrix}_{B} \\begin{bmatrix} \\hat{I} \u0026 \\\\ \\hat{\\sigma}^{z} \u0026 \\hat{I}\\\\ \\end{bmatrix}_{C} \\begin{bmatrix} 1 \\\\ 0\\\\ \\end{bmatrix}_{D} $$\nåœ¨çŸ©é˜µçš„å³ä¸‹è§’ä½¿ç”¨A B C Dæ¥è¿›è¡Œæ ‡è®°.å®ƒä»¬ä»¥å¼ é‡ç½‘ç»œç”»å‡ºçš„å½¢å¼å¤§æ¦‚åƒè¿™æ ·:\n$$ \\sum{A}-\\sum_{|}^{|}{B}-\\sum_{|}^{|}{C}-\\sum{D} $$\nä¸éš¾çœ‹å‡ºå®é™…ä¸ŠAå’ŒB,ä»¥åŠCå’ŒDæ˜¯èƒ½å¤Ÿå„è‡ªç»“åˆå½¢æˆæ–°çŸ©é˜µçš„, æˆ‘ä»¬å†™å‡ºç›¸ä¹˜å¾—åˆ°çš„ç»“æœ:\n$$ \\hat{H} = \\begin{bmatrix} \\hat{\\sigma}^{z} \u0026 \\hat{I}\\\\ \\end{bmatrix}_{Aâ€™} \\begin{bmatrix} \\hat{I}\\\\ \\hat{\\sigma}^{z} \\\\ \\end{bmatrix}_{Bâ€™} $$\nåœ¨æ–¹ç¨‹ä¸Šæˆ‘ä»¬è¿™æ ·è¡¨è¿°:\n$$ \\hat{H} = \\hat{\\sigma_{1}}^{z}\\bigotimes\\hat{I_{2}} + \\hat{I_{1}}\\bigotimes\\hat{\\sigma_{2}}^{z} $$\nå½“ç„¶è¿™ä¸€ä¸ªå¼å­æˆ‘ä»¬è¿˜å¯ä»¥è¿›è¡Œç»§ç»­çš„ç®€åŒ–, å®Œæˆæœ€åä¸€æ­¥çš„ä¹˜æ³•:\n$$ \\hat{H} = \\hat{\\sigma_{1}}^{z}+\\hat{\\sigma_{2}}^{z} =\\sum_{i}\\hat{\\sigma_{i}}^{z} $$\nç°åœ¨å†åŠ¨æ‰‹ç®—æ›´å¤æ‚çš„ä¾‹å­.\n$$\\hat{H}= \\begin{bmatrix} 0 \u0026 0 \u0026 1\\\\ \\end{bmatrix} \\begin{bmatrix} \\hat{I} \u0026 \u0026 \\\\ \\hat{\\sigma}^{z} \u0026 \u0026 \\\\ -h\\hat{\\sigma}^{x} \u0026 \\hat{\\sigma}^{z} \u0026 \\hat{I}\\\\ \\end{bmatrix} \\begin{bmatrix} \\hat{I} \u0026 \u0026 \\\\ \\hat{\\sigma}^{z} \u0026 \u0026 \\\\ -h\\hat{\\sigma}^{x} \u0026 \\hat{\\sigma}^{z} \u0026 \\hat{I}\\\\ \\end{bmatrix} \\begin{bmatrix} 1\\\\ 0\\\\ 0\\\\ \\end{bmatrix} $$\nå…ˆç®—ä¸¤è¾¹, å†ç®—ä¸­é—´, å³æœ‰\n$$ \\hat{H}=[-h\\hat{\\sigma}^{x},\\hat{\\sigma}^{z},\\hat{I}][\\hat{I},\\hat{\\sigma}^{z},-h\\hat{\\sigma}^{x}]^{T}=\\sum_{j}\\hat{\\sigma_{j}}^{z}\\hat{\\sigma_{j+1}}^{z}-h\\hat{\\sigma_{j}}^{x} $$\næœ¬ç« æ²¡æœ‰å¯¹åº”çš„Quiz\nDMRG å¯†åº¦çŸ©é˜µé‡æ•´åŒ–ç¾¤ è­¦å‘Š\nä»¥ä¸‹éƒ¨åˆ†å†…å®¹, å¯èƒ½ä»…é€‚ç”¨äº1Dçš„æƒ…å†µ, è™½ç„¶ITensorå¼€å‘äº†ä¸€äº›åŸºäºåŸºäºDMRGç®—æ³•çš„æ‰©å±•ç”¨ä»¥åº”å¯¹äºŒç»´æƒ…å†µä¸‹ç³»ç»Ÿ, ä½†æ˜¯è¿™äº›æ–¹æ³•çš„å®ç°å¤æ‚åº¦é€šå¸¸è¾ƒé«˜, éœ€è¦è¾ƒé•¿çš„è®¡ç®—æ—¶é—´å’Œæ›´é«˜çš„è®¡ç®—èµ„æº.\nå¦‚æœä½ æƒ³è¦å¯¹äºŒç»´ç³»ç»Ÿè¿›è¡Œè®¡ç®—, è¯·è€ƒè™‘ä½¿ç”¨PEPS(æŠ•å½±çº ç¼ å¯¹æ€ç®—æ³•)æˆ–è€…MERA(Multi-scale Entanglement Renormalization Ansatz,å¤šå°ºåº¦åµŒå¥—æ­£äº¤æ¨¡å‹)ç®—æ³•, é™¤äº†ITensorå¤–ä½ ä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨Qiskit, PyQuanteç­‰è®¡ç®—åº“, ä»è€Œå®ç°åŸºäºå“ˆå¯†é¡¿é‡å¯¹è§’åŒ–çš„èƒ½å¸¦è®¡ç®—.\næ‰€ä»¥ä¸ºä»€ä¹ˆè¦å­¦ITensorå‘¢? ç›´æ¥ç”¨matlabæ¨¡æ‹Ÿä¸å°±å¥½äº†\nå¦‚æœæˆ‘ä»¬æƒ³è¦æ±‚è§£ä¸€ç»´å“ˆå¯†é¡¿é‡çš„åŸºæ€, DMRG å°†æ˜¯æœ€å¥½çš„æ–¹æ³•.\næ–¹ç¨‹å¼çš„å½¢å¼å¦‚ä¸‹:\n$\\hat{H}|\\Psi\\rangle = E|\\Psi\\rangle$\nå…¶ä¸­ $\\hat{H}$ å’Œ $|\\Psi\\rangle$ éƒ½åŒ–ä¸ºå¯¹åº”é‡å­ä½æ•°çš„ çŸ©é˜µä¹˜ç§¯å½¢å¼(MPO å’Œ MPS).\nMPSçš„æ„é€ ä¸­ä¸åªæ˜¯ç”¨åˆ°äº†æˆ‘ä»¬ä¹‹å‰æ‰€å­¦çš„SVDå’ŒReGroup, å®ƒè¿˜åŒ…æ‹¬äº†ä¸€äº›æˆ‘ä»¬æ²¡æœ‰æåˆ°çš„å¤„ç†æ“ä½œ, è¿™äº›æ“ä½œè¢«ç»Ÿç§°ä¸º\"è§„èŒƒåŒ–å˜æ¢\", æ¯”å¦‚å¯¹å¼ é‡è¿›è¡Œå•ä½åŒ–(unitarization).\nè¿™äº›å¤„ç†æ˜¯ä¸ºäº†MPSåœ¨è®¡ç®—æ—¶å…·æœ‰è‰¯å¥½æ€§è´¨, æ¯”å¦‚è®¡ç®—ç‰©ç†é‡æ—¶å…·æœ‰æœ€å°è¯¯å·®.\nImporttant: MPS should be in definite gauge. I.e.most tensors unitary.\nå°±æ˜¯åœ¨è¦æ±‚çŸ©é˜µä¹˜ç§¯æ€åº”å½“å·²ç»è¢«è§„èŒƒåŒ–, ä¹Ÿå°±æ˜¯å¤§å¤šæ•°é‡å­ä½çš„å¼ é‡éƒ½æ˜¯å¹ºæ­£çš„.\nå¹ºæ­£ Unitary\nå¹ºæ­£æœ¬èº«æ˜¯ä¸€ä¸ªçº¿æ€§ä»£æ•°é‡Œçš„æ¦‚å¿µ, åœ¨è¿™é‡Œæˆ‘ä»¬ç”¨æ›´ç‰©ç†ä¸€äº›çš„è¯­è¨€æ¥æè¿°è¿™ä¸ªæ€§è´¨.\nå¦‚æœä¸€ä¸ªç®—å­ $\\hat{U}$ , è¿˜æœ‰ä¸€ä¸ªæ€çŸ¢é‡ $|\\psi\\rangle$ ,èƒ½å¤Ÿæ»¡è¶³ä»¥ä¸‹æ¡ä»¶:\n$\\hat{U}|\\psi\\rangle\\neq 0$; $||\\hat{U}|\\psi\\rangle|| = ||\\psi\\rangle||$; $\\langle\\Phi|\\hat{U}|\\psi\\rangle = \\langle\\Phi|\\psi\\rangle$ å…¶ä¸­ $||\\psi\\rangle||$ ä»£è¡¨æ€åŠ¿ $|\\psi\\rangle$ çš„é•¿åº¦, è¿™ä¸ªé‡å¯ä»¥é€šè¿‡æ±‚å†…ç§¯æ¥å¾—åˆ°. é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç§°è¿™ä¸ªç®—å­æ˜¯å¹ºæ­£çš„. æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€‰å®šä¸€ä¸ªç‰¹å®šçš„ä½ç½®(æ­£åˆ™ä½ç½®), å°†å…¶å·¦å³ä¸¤è¾¹çš„å¼ é‡å…¨éƒ¨éƒ½è§„èŒƒåŒ–å¤„ç†, ä»è€Œå®šä¹‰å‡ºæ­£äº¤å½’ä¸€çš„åŸº.\nè¿™æ ·, æˆ‘ä»¬å°±å¯ä»¥è®¡ç®—å‡ºæœŸæœ›å€¼ $\\langle\\Psi|\\hat{H}|\\Psi\\rangle$ .å…¶ä¸­ $|\\Psi\\rangle$ å’Œ $\\hat{H}$ éƒ½æ˜¯çŸ©é˜µä¹˜ç§¯å½¢å¼. æŒ‰ç…§æˆ‘ä»¬å‰é¢æ‰€è¯´çš„,\nMERAç®—æ³• Multi-scale Entanglement Renormalization Ansatz\nå¤šå°ºåº¦åµŒå¥—æ­£äº¤çŸ©å½¢æ¨¡å‹. è¿™æ˜¯å¯¹é‡æ•´åŒ–ç¾¤æ–¹æ³•çš„æ‰©å±•. MERAå°†ç³»ç»Ÿåˆ†è§£ä¸ºä¸€ç³»åˆ—çš„å¼ é‡, æ¯ä¸ªå¼ é‡ä»£è¡¨äº†ç³»ç»Ÿä¸åŒå°ºåº¦ä¸‹çš„çŠ¶æ€. æ¯ä¸ªå¼ é‡çš„å¤§å°è¡¨ç¤ºè¯¥å°ºåº¦çš„è‡ªç”±åº¦æ•°ç›®.\nè¿™äº›å¼ é‡é€šè¿‡ç‰¹å®šçš„å˜åŒ–ç›¸äº’è¿æ¥, ä»è€Œå½¢æˆå…·æœ‰åˆ†å½¢ç»“æ„çš„ç½‘ç»œ. è¿™æ ·, æˆ‘ä»¬å°±å¯ä»¥å°†ç³»ç»Ÿçš„çº ç¼ ç»“æ„è¡¨ç¤ºä¸ºä¸åŒå°ºåº¦ä¸Šçš„ç®€å•å¼ é‡ç½‘ç»œ.\nå…·ä½“æ¥è¯´, æ¯ä¸ªå¼ é‡è¢«åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†, å³ä¸Šéƒ¨åˆ†å’Œä¸‹éƒ¨åˆ†. ä¸Šéƒ¨åˆ†è¡¨ç¤ºçš„æ˜¯ä½å°ºåº¦çš„ä¿¡æ¯, ä¸‹éƒ¨åˆ†è¡¨ç¤ºçš„æ˜¯é«˜å°ºåº¦çš„ä¿¡æ¯. é€šè¿‡é‡å¤åº”ç”¨åŠ å¯†å’Œè§£å¯†æ“ä½œ, å°±å¯ä»¥å¾—åˆ°ä¸åŒå°ºåº¦ä¸‹çš„ç³»ç»ŸçŠ¶æ€.\n",
  "wordCount" : "11181",
  "inLanguage": "zh",
  "datePublished": "2022-05-05T00:18:23+08:00",
  "dateModified": "2022-05-05T00:18:23+08:00",
  "author":[{
    "@type": "Person",
    "name": "Muartz"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://Muatyz.github.io/posts/phy/calphy/itensor-mannual/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "æ— å¤„æƒ¹å°˜åŸƒ",
    "logo": {
      "@type": "ImageObject",
      "url": "https://Muatyz.github.io/img/Head32.png"
    }
  }
}
</script><script type="text/javascript"
        async
        src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
  CommonHTML: {
  scale: 100
  },
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[\[','\]\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});

MathJax.Hub.Queue(function() {
  
  
  
  var all = MathJax.Hub.getAllJax(), i;
  for(i = 0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script>

<style>
  code.has-jax {
      font: "LXGW WenKai Screen", sans-serif, Arial;
      scale: 1;
      background: "LXGW WenKai Screen", sans-serif, Arial;
      border: "LXGW WenKai Screen", sans-serif, Arial;
      color: #515151;
  }
</style>
</head>

<body class="" id="top">
<script>
    (function () {
        let  arr,reg = new RegExp("(^| )"+"change-themes"+"=([^;]*)(;|$)");
        if(arr = document.cookie.match(reg)) {
        } else {
            if (new Date().getHours() >= 19 || new Date().getHours() < 6) {
                document.body.classList.add('dark');
                localStorage.setItem("pref-theme", 'dark');
            } else {
                document.body.classList.remove('dark');
                localStorage.setItem("pref-theme", 'light');
            }
        }
    })()

    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }
</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://Muatyz.github.io/" accesskey="h" title="è®¡ç®—ç‰©ç†å­¦ä¹ æ—¥å¿— (Alt + H)">
            <img src="https://Muatyz.github.io/img/Head64.png" alt="logo" aria-label="logo"
                 height="35">è®¡ç®—ç‰©ç†å­¦ä¹ æ—¥å¿—</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                         stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                         stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://Muatyz.github.io/search" title="ğŸ” æœç´¢ (Alt &#43; /)" accesskey=/>
                <span>ğŸ” æœç´¢</span>
                </a>
            </li>
            <li>
                <a href="https://Muatyz.github.io/" title="ğŸ  ä¸»é¡µ">
                <span>ğŸ  ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://Muatyz.github.io/posts" title="ğŸ“š æ–‡ç« ">
                <span>ğŸ“š æ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://Muatyz.github.io/tags" title="ğŸ§© æ ‡ç­¾">
                <span>ğŸ§© æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://Muatyz.github.io/archives/" title="â±ï¸ æ—¶é—´è½´">
                <span>â±ï¸ æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="https://Muatyz.github.io/about" title="ğŸ™‹ğŸ»â€â™‚ï¸ å…³äº">
                <span>ğŸ™‹ğŸ»â€â™‚ï¸ å…³äº</span>
                </a>
            </li>
            <li>
                <a href="https://Muatyz.github.io/links" title="ğŸ¤ å‹é“¾">
                <span>ğŸ¤ å‹é“¾</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main page">
<style>
    i[id*="post_meta_style"] {
        display: flex;
        align-items: center;
        margin: 0 0 10px 0;
    }
</style>

<article class="post-single">
    <div id="single-content">
        <header class="post-header">
            <div class="breadcrumbs"><a href="https://Muatyz.github.io/">ğŸ  ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href="https://Muatyz.github.io/posts/">ğŸ“šæ–‡ç« </a>&nbsp;Â»&nbsp;<a href="https://Muatyz.github.io/posts/phy/">ğŸ§± PHY</a>&nbsp;Â»&nbsp;<a href="https://Muatyz.github.io/posts/phy/calphy/">ğŸ’» Computation Physics</a></div>
            <h1 class="post-title">
                ITensoråŸºç¡€è¯­æ³•è¯´æ˜
            </h1>
            <div class="post-description">
                ä»‹ç»ä»¥DMRGç®—æ³•ä¸ºæ ¸å¿ƒçš„itensoråº“ä½¿ç”¨æ–¹æ³•
            </div>
            <div class="post-meta">

<style>
    i[id*="post_meta_style"] {
        display: flex;
        align-items: center;
        margin: 0 0 10px 0;
    }

    .parent-post-meta {
        display: flex;
        flex-wrap: wrap;
        opacity: 0.8;
    }
</style>

<span class="parent-post-meta">
    <span id="post_meta_style_1">
        <span class="fa fa-calendar-check-o"></span>
        <span>2022-05-05
            &nbsp;&nbsp;
        </span>
    </span>
    
    
    
    
    
    
    
    <span id="post_meta_style_3">
        <span class="fa fa-file-word-o"></span>
        <span>11181å­—
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_4">
        <span class="fa fa-clock-o"></span>
        <span>23åˆ†é’Ÿ
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_5">
        <span class="fa fa-user-o"></span>
        <span>Muartz
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_6">
        <span class="fa fa-tags" style="opacity: 0.8"></span>
        <span>
            <span class="post-tags-meta">
                <a href="https://Muatyz.github.io/tags/physics/" style="color: var(--secondary)!important;">Physics</a>
                &nbsp;<a href="https://Muatyz.github.io/tags/numerical-calculation/" style="color: var(--secondary)!important;">Numerical Calculation</a>
            </span>
        </span>
    </span>
</span>
<span style="opacity: 0.8;">
                    <span id="post_meta_style_7">
                        &nbsp;&nbsp;
                        <span class="fa fa-eye" ></span>
                        <span>
                            <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv"></span></span>
                            &nbsp;&nbsp;
                        </span>
                    </span>
                    <span id="post_meta_style_8">
                        <span class="fa fa-commenting-o"></span>
                        <span>
                            <script src="https://cdn.staticfile.org/twikoo/1.6.16/twikoo.all.min.js"></script>
                            <script>
                                let url = document.documentURI
                                
                                let dnsUrl = "https://Muatyz.github.io/"
                                let urlSplit = url.split(dnsUrl)
                                let finalUrl = urlSplit[1]
                                if (finalUrl[0] !== '/') {
                                    finalUrl = '/'+finalUrl
                                }
                                twikoo.getCommentsCount({
                                    envId: "https://www.muartz.com", 
                                region: "ap-shanghai", 
                                urls: [ 
                                    
                                    finalUrl,
                                ],
                                    includeReply: false 
                                }).then(function (res) {
                                    let count = res[0].count
                                    const obj = document.getElementById("comment_count");
                                    obj.innerText = count
                                    
                                    
                                    
                                }).catch(function (err) {
                                    
                                    console.error(err);
                                });
                            </script>
                            <span id="comment_count"></span>
                        </span>
                    </span>
                </span>

</div>
        </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">ç›®å½•</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#one-site-%e5%8d%95%e8%8a%82%e7%82%b9" aria-label="one site å•èŠ‚ç‚¹">one site å•èŠ‚ç‚¹</a><ul>
                        
                <li>
                    <a href="#operators-%e6%93%8d%e4%bd%9c%e7%ac%a6%e7%ae%97%e5%ad%90-hata" aria-label="Operators æ“ä½œç¬¦/ç®—å­ $\hat{A}$">Operators æ“ä½œç¬¦/ç®—å­ $\hat{A}$</a></li>
                <li>
                    <a href="#%e6%9c%9f%e6%9c%9b%e5%80%bc-langlehatarangle" aria-label="æœŸæœ›å€¼ $\langle\hat{A}\rangle$">æœŸæœ›å€¼ $\langle\hat{A}\rangle$</a></li>
                <li>
                    <a href="#quiz-1-%e8%a7%a3%e6%9e%90" aria-label="Quiz $1$ è§£æ">Quiz $1$ è§£æ</a></li></ul>
                </li>
                <li>
                    <a href="#two-sites-%e5%8f%8c%e8%8a%82%e7%82%b9" aria-label="Two Sites åŒèŠ‚ç‚¹">Two Sites åŒèŠ‚ç‚¹</a><ul>
                        
                <li>
                    <a href="#%e7%ba%a0%e7%bc%a0%e6%80%81" aria-label="çº ç¼ æ€">çº ç¼ æ€</a></li>
                <li>
                    <a href="#%e5%93%88%e5%af%86%e9%a1%bf%e9%87%8fhath" aria-label="å“ˆå¯†é¡¿é‡$\hat{H}$">å“ˆå¯†é¡¿é‡$\hat{H}$</a></li>
                <li>
                    <a href="#quiz-2-%e8%a7%a3%e6%9e%90" aria-label="Quiz $2$ è§£æ">Quiz $2$ è§£æ</a></li></ul>
                </li>
                <li>
                    <a href="#svd-%e5%a5%87%e5%bc%82%e5%80%bc%e5%88%86%e8%a7%a3" aria-label="SVD å¥‡å¼‚å€¼åˆ†è§£">SVD å¥‡å¼‚å€¼åˆ†è§£</a><ul>
                        
                <li>
                    <a href="#%e5%8f%8c%e8%87%aa%e6%97%8b%e6%b3%a2%e5%87%bd%e6%95%b0" aria-label="åŒè‡ªæ—‹æ³¢å‡½æ•°">åŒè‡ªæ—‹æ³¢å‡½æ•°</a></li>
                <li>
                    <a href="#quiz-3-%e8%a7%a3%e6%9e%90" aria-label="Quiz $3$ è§£æ">Quiz $3$ è§£æ</a></li></ul>
                </li>
                <li>
                    <a href="#four-%e5%9b%9b%e7%bb%93%e7%82%b9" aria-label="Four å››ç»“ç‚¹">Four å››ç»“ç‚¹</a><ul>
                        
                <li>
                    <a href="#%e6%9c%9f%e6%9c%9b%e5%80%bc-langlehata_1rangle" aria-label="æœŸæœ›å€¼ $\langle\hat{A}_1\rangle$">æœŸæœ›å€¼ $\langle\hat{A}_1\rangle$</a></li>
                <li>
                    <a href="#quiz-4-%e8%a7%a3%e6%9e%90" aria-label="Quiz $4$ è§£æ">Quiz $4$ è§£æ</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%b0%8f%e8%bd%a6-trotter--suzuki-formula" aria-label="&ldquo;å°è½¦&rdquo; Trotter â€“ Suzuki formula"><del>&ldquo;å°è½¦&rdquo;</del> Trotter â€“ Suzuki formula</a></li>
                <li>
                    <a href="#quiz-5-%e8%a7%a3%e6%9e%90" aria-label="Quiz 5 è§£æ">Quiz 5 è§£æ</a></li>
                <li>
                    <a href="#%e7%9f%a9%e9%98%b5%e4%b9%98%e7%a7%af%e7%ae%97%e5%ad%90-mpo" aria-label="çŸ©é˜µä¹˜ç§¯ç®—å­ MPO">çŸ©é˜µä¹˜ç§¯ç®—å­ <strong>MPO</strong></a></li>
                <li>
                    <a href="#dmrg-%e5%af%86%e5%ba%a6%e7%9f%a9%e9%98%b5%e9%87%8d%e6%95%b4%e5%8c%96%e7%be%a4" aria-label="DMRG å¯†åº¦çŸ©é˜µé‡æ•´åŒ–ç¾¤"><strong>DMRG</strong> å¯†åº¦çŸ©é˜µé‡æ•´åŒ–ç¾¤</a></li>
                <li>
                    <a href="#mera%e7%ae%97%e6%b3%95" aria-label="MERAç®—æ³•"><strong>MERA</strong>ç®—æ³•</a>
                </li>
            </ul>
        </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
        
        activeElement = elements[0];
        const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
        document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
    }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 &&
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
            const id = encodeURI(element.getAttribute('id')).toLowerCase();
            if (element === activeElement){
                document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
            } else {
                document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
            }
        })
    }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;
        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;
    }
</script>
        <div class="post-content"><h1 id="one-site-å•èŠ‚ç‚¹">one site å•èŠ‚ç‚¹<a hidden class="anchor" aria-hidden="true" href="#one-site-å•èŠ‚ç‚¹">#</a></h1>
<blockquote>
<p>Site</p>
<p>æ„æŒ‡&quot;èŠ‚ç‚¹&quot;.</p>
</blockquote>
<p>å•èŠ‚ç‚¹çš„è‡ªæ—‹ä¸º $\frac{1}{2}$ çš„æ³¢å‡½æ•°,æœ‰ä¸¤ä¸ªåŸºåº•.</p>
<p>$|s=1\rangle=|\uparrow\rangle;|s=2\rangle=|\downarrow\rangle$</p>
<p>å¯¹äºä¸€èˆ¬çš„è‡ªæ—‹ä¸º $\frac{1}{2}$ çš„æ³¢å‡½æ•°,å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼:</p>
<p>$|\psi\rangle=\sum_{s=1}^{2}\psi_s|s\rangle(\psi_s\in\mathcal{C})$</p>
<p>ä½¿ç”¨å¼ é‡æ•°å­¦æ¥å¤„ç†è¿™ä¸ªå•èŠ‚ç‚¹æ³¢å‡½æ•°,
å³ $|\psi_s\rangle$ å¯¹åº”ä¸€ä¸ªæœ‰ä¸€ä¸ª&quot;è§¦æ‰‹&quot;çš„ç»“ç‚¹.å±•å¼€å½¢å¼ä¸º $(^{\psi_1}_{\psi_2})$ , $\psi_1,\psi_2$ åˆå„è‡ªæ˜¯ä¸€ä¸ªå•&quot;è§¦æ‰‹&quot;çš„ç»“ç‚¹.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>Index <span style="color:#a6e22e">s</span>(<span style="color:#e6db74">&#34;s&#34;</span>,<span style="color:#ae81ff">2</span>);
</span></span><span style="display:flex;"><span><span style="color:#75715e">//&#34;s&#34;ä»£è¡¨çš„æ˜¯Indexçš„å‘½å
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//2æ˜¯Indexçš„ç»´åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>ITensor <span style="color:#a6e22e">psi</span>(s);
</span></span><span style="display:flex;"><span><span style="color:#75715e">//ç”±äºåªå£°æ˜ä¸å®šä¹‰,æ‰€ä»¥åˆå§‹å€¼ä¸º0
</span></span></span></code></pre></div><blockquote>
<p><strong>Index æŒ‡æ ‡</strong></p>
<p>æŒ‡çš„æ˜¯è¡¨ç¤ºæŸç§ç‰©ç†é‡çš„ç¬¦å·.è¿™ä¸ªç¬¦å·
å¯ä»¥æ˜¯çŸ¢é‡, å¼ é‡, ç®—ç¬¦.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>Index <span style="color:#a6e22e">s</span>(<span style="color:#ae81ff">2</span>,<span style="color:#e6db74">&#34;s&#34;</span>);
</span></span><span style="display:flex;"><span>Index <span style="color:#a6e22e">t</span>(<span style="color:#ae81ff">3</span>,<span style="color:#e6db74">&#34;t&#34;</span>);
</span></span><span style="display:flex;"><span>ITensor <span style="color:#a6e22e">T</span>(s,t);
</span></span></code></pre></div><p>è¿™ä¸ªè¡¨ç¤ºçš„å°±æ˜¯åˆ›å»ºäº†ä¸€ä¸ªäºŒç»´çš„ç‰©ç†é‡,æˆ‘ä»¬ç”¨$s$æ¥æ ‡è®°å®ƒ;ç‰©ç†é‡tåˆ™æ˜¯ä¸‰ç»´çš„.
è€ŒItensorçš„å¤§å°åˆ™æ˜¯ $2\times 3$.</p>
</blockquote>
<p>å¯¹ $|\psi_s\rangle$ è¿›è¡Œåˆå§‹åŒ–æ“ä½œ.æˆ‘ä»¬ä¸å¦¨å°†å…¶åˆå§‹åŒ–ä¸ºåŸºçŸ¢:</p>
<p>$|\psi_s\rangle=|\uparrow\rangle$</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>Index <span style="color:#a6e22e">s</span>(<span style="color:#ae81ff">2</span>,<span style="color:#e6db74">&#34;s&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#75715e">//åœ¨æœ€æ–°çš„ITensorè¯­æ³•è§„èŒƒä¸­,Index (string, int)çš„è¯­æ³•å·²ç»è¢«å¼ƒç”¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//ç›®å‰çš„è¯­æ³•åº”å½“æ˜¯Index (int, string)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>ITensor <span style="color:#a6e22e">psi</span>(s);
</span></span><span style="display:flex;"><span>psi(s(<span style="color:#ae81ff">1</span>)) <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>PrintData(psi);
</span></span></code></pre></div><p>æœ¬ç¤ºä¾‹ä»£ç åº”è¯¥ä¼šè¾“å‡º:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>psi <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>ITensor ord<span style="color:#f92672">=</span>1: <span style="color:#f92672">(</span>dim<span style="color:#f92672">=</span>2|id<span style="color:#f92672">=</span>414|<span style="color:#e6db74">&#34;s&#34;</span><span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>norm<span style="color:#f92672">=</span>1.00 <span style="color:#f92672">(</span>Dense Real<span style="color:#f92672">)}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>1<span style="color:#f92672">)</span> 1.0000000
</span></span></code></pre></div><h2 id="operators-æ“ä½œç¬¦ç®—å­-hata">Operators æ“ä½œç¬¦/ç®—å­ $\hat{A}$<a hidden class="anchor" aria-hidden="true" href="#operators-æ“ä½œç¬¦ç®—å­-hata">#</a></h2>
<p>ç®—å­ä½“ç°åœ¨å¼ é‡ç½‘ç»œä¸Šå°±æ˜¯ä¸€ä¸ªæ‹¥æœ‰ä¸¤ä¸ª&quot;è§¦æ‰‹&quot;çš„ç»“ç‚¹, å®ƒå¯ä»¥å’Œåªæœ‰ä¸€ä¸ª&quot;è§¦æ‰‹&quot;çš„ç»“ç‚¹ç»“åˆ, ä»è€Œç”Ÿæˆä¸€ä¸ªæ–°çš„åªæœ‰ä¸€ä¸ªè§¦æ‰‹çš„ç»“ç‚¹.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>ITensor <span style="color:#a6e22e">Sz</span>(s,prime(s));
</span></span><span style="display:flex;"><span>ITensor <span style="color:#a6e22e">Sx</span>(s,prime(s));
</span></span><span style="display:flex;"><span><span style="color:#75715e">//prime(s)æ˜¯æŒ‡çš„å¯¹sè¿›è¡Œå…±è½­æ“ä½œ
</span></span></span></code></pre></div><p>å¦‚æœè¦å¯¹ä¸€ä¸ªå‘é‡æˆ–è€…çŸ©é˜µè¿›è¡Œè½¬ç½®,å…±è½­ç­‰æ“ä½œ,æˆ‘ä»¬å¯ä»¥ç”¨è¢«ç§°ä¸º<strong>ä¸Šä¸‹æ ‡</strong>çš„æ“ä½œæ¥è¡¨ç¤º.æ¯”å¦‚, $A_{ij}^{&rsquo;}=A_{ji}$, $A_{ij}^{\dagger}=A_{ji}$ ç­‰.</p>
<p><code>prime(s)</code>å°±ä»£è¡¨äº†å¯¹æŒ‡æ ‡è¿›è¡Œä¸Šæ ‡æ“ä½œæ‰€å¾—åˆ°çš„é‡.</p>
<blockquote>
<p><strong>Prime Level</strong> ä¸Šæ ‡çº§åˆ«</p>
<p>æŒ‡æ ‡æœ‰ä¸€ä¸ªå±æ€§è¢«ç§°ä¸º<strong>prime level</strong>, è¡¨ç¤ºæ˜¯å¦è¢«æŸä¸ªæ“ä½œå‡é™çº§.é»˜è®¤æƒ…å†µä¸‹æŒ‡æ ‡çš„ä¸Šæ ‡çº§åˆ«ä¸º0.</p>
<p>è¿™ä¸ªé‡çš„ä½œç”¨æ˜¯ç”¨æ¥å¯¹ä¸¤ä¸ªå¼ é‡è¿›è¡Œæ¯”è¾ƒ, åœ¨è¿›è¡ŒæŸäº›æ“ä½œæ—¶, ä¸Šæ ‡å¿…é¡»è¦æ»¡è¶³æŸäº›éœ€æ±‚è¿ç®—æ‰èƒ½å¤Ÿæˆç«‹.</p>
<p>æ¯”å¦‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>Index <span style="color:#a6e22e">s</span>(<span style="color:#ae81ff">2</span>,<span style="color:#e6db74">&#34;s&#34;</span>);
</span></span><span style="display:flex;"><span>Index <span style="color:#a6e22e">t</span>(<span style="color:#ae81ff">2</span>,<span style="color:#e6db74">&#34;2&#34;</span>);
</span></span><span style="display:flex;"><span>ITensor <span style="color:#a6e22e">A</span>(s,t);
</span></span><span style="display:flex;"><span>ITensor <span style="color:#a6e22e">B</span>(s,t);<span style="color:#75715e">// s, t éƒ½æ˜¯ä¸Šæ ‡çº§åˆ«ä¸º 0 çš„æŒ‡æ ‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>C <span style="color:#f92672">=</span> A <span style="color:#f92672">*</span> prime(B);<span style="color:#75715e">// prime(B) è¡¨ç¤ºå°† B ä¸­çš„æ‰€æœ‰æŒ‡æ ‡ä¸Šæ ‡çº§åˆ«åŠ  1
</span></span></span></code></pre></div><p>åœ¨è¿™é‡Œ, <code>A * prime(B)</code>å°±æ˜¯ä¸€ä¸ªä¸å…è®¸æŒ‡æ ‡é‡å¤çš„æ“ä½œ.æ‰€ä»¥ä¸ºäº†å®Œæˆè¿™ä¸ªè®¡ç®—,æˆ‘ä»¬éœ€è¦å¯¹<code>B</code>è¿›è¡Œä¸Šæ ‡çº§åˆ«å‡çº§çš„æ“ä½œ,ä¹Ÿå°±æ˜¯ä½¿ç”¨<code>prime()</code>å‡½æ•°.</p>
</blockquote>
<p>ç°åœ¨æˆ‘ä»¬æ¥å¯¹ $\hat{S}_z,\hat{S}_x$ ç®—å­è¿›è¡Œå®šä¹‰.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>ITensor <span style="color:#a6e22e">Sz</span>(s,prime(s)),Sx(s,prime(s));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// commaInit(Sz,s,prime(s)) =  0.5, 0.0,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//                             0.0,-0.5;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// commaInit(Sx,s,prime(s)) =  0.0, 0.5,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//                             0.5, 0.0;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//commaInitçš„è¯­æ³•å·²ç»è¢«å¼ƒç”¨, åº”å½“ä½¿ç”¨.set()
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//Sz
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>Sz.set(s(<span style="color:#ae81ff">1</span>),prime(s)(<span style="color:#ae81ff">1</span>),<span style="color:#ae81ff">0.5</span>);
</span></span><span style="display:flex;"><span>Sz.set(s(<span style="color:#ae81ff">2</span>),prime(s)(<span style="color:#ae81ff">2</span>),<span style="color:#f92672">-</span><span style="color:#ae81ff">0.5</span>);
</span></span><span style="display:flex;"><span><span style="color:#75715e">//Sx
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>Sx.set(s(<span style="color:#ae81ff">1</span>),prime(s)(<span style="color:#ae81ff">2</span>),<span style="color:#ae81ff">0.5</span>);
</span></span><span style="display:flex;"><span>Sx.set(s(<span style="color:#ae81ff">2</span>),prime(s)(<span style="color:#ae81ff">1</span>),<span style="color:#ae81ff">0.5</span>);<span style="color:#75715e">//è®¾ç½®åˆ†é‡
</span></span></span></code></pre></div><p>ç°åœ¨æˆ‘ä»¬å°è¯•å¯¹æ³¢å‡½æ•° $|\psi\rangle$ è¿›è¡Œæ±‚æŸæ–¹å‘è‡ªæ—‹çš„æ“ä½œ.</p>
<p>å³æ–¹ç¨‹ä¸Šçš„</p>
<p>$$
(\hat{S_{x}})_{s&rsquo;}^{s}\psi_{s}
$$</p>
<p>å¯¹åº”çš„æ˜¯</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>ITensor phi <span style="color:#f92672">=</span> Sx <span style="color:#f92672">*</span> psi;
</span></span></code></pre></div><p>(æ³¨æ„ç®—ç¬¦çš„ä¸Šæ ‡è¦å’Œæ³¢å‡½æ•°çš„ä¸‹æ ‡ç›¸åŒ, è¿™æ ·çš„æ“ä½œæ‰æ˜¯è¢«å…è®¸çš„. $s$å’Œ$s&rsquo;$çš„ä¸Šæ ‡ç­‰çº§ä¸åŒ, æ‰€ä»¥æ˜¯ä¸åŒ¹é…çš„)</p>
<p>ä¸ºäº†ç ”ç©¶ç»è¿‡æ±‚è‡ªæ—‹çš„é‡ $|\phi\rangle$ çš„å…·ä½“æƒ…å†µ, æˆ‘ä»¬å°†å…¶è¾“å‡ºåœ¨ç»ˆç«¯:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>ITensor phi <span style="color:#f92672">=</span> Sx <span style="color:#f92672">*</span> psi;
</span></span><span style="display:flex;"><span>PrintData(phi);
</span></span></code></pre></div><p>è¾“å‡ºçš„ç»“æœåº”è¯¥æ˜¯:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>phi <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>ITensor ord<span style="color:#f92672">=</span>1: <span style="color:#f92672">(</span>dim<span style="color:#f92672">=</span>2|id<span style="color:#f92672">=</span>816|<span style="color:#e6db74">&#34;s&#34;</span><span style="color:#f92672">)</span><span style="color:#960050;background-color:#1e0010">&#39;</span> 
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>norm<span style="color:#f92672">=</span>0.50 <span style="color:#f92672">(</span>Dense Real<span style="color:#f92672">)}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>2<span style="color:#f92672">)</span> 0.5000000
</span></span></code></pre></div><p>æˆ‘ä»¬æ¥çœ‹çœ‹æ›´å¤šçš„ç»“æœ. å¦‚æœæœ‰ $|\psi_s\rangle=(|^{\cos{\frac{\theta}{2}}}_{\sin{\frac{\theta}{2}}}\rangle)_{\theta=\frac{\pi}{4}}$, é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿™æ ·æè¿°:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>Real theta <span style="color:#f92672">=</span> Pi<span style="color:#f92672">/</span><span style="color:#ae81ff">4</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// psi(s(1)) = cos(theta/2);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// psi(s(2)) = sin(theta/2);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//è¯¥è¯­æ³•å·²è¢«å¼ƒç”¨,ä½¿ç”¨.set()æ›¿ä»£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>psi.set(s(<span style="color:#ae81ff">1</span>),cos(theta<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>));
</span></span><span style="display:flex;"><span>psi.set(s(<span style="color:#ae81ff">2</span>),sin(theta<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>));
</span></span><span style="display:flex;"><span>PrintData(psi);
</span></span></code></pre></div><p>ç»ˆç«¯ä¼šè¾“å‡º</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>psi <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>ITensor ord<span style="color:#f92672">=</span>1: <span style="color:#f92672">(</span>dim<span style="color:#f92672">=</span>2|id<span style="color:#f92672">=</span>977|<span style="color:#e6db74">&#34;s&#34;</span><span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>norm<span style="color:#f92672">=</span>1.00 <span style="color:#f92672">(</span>Dense Real<span style="color:#f92672">)}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>1<span style="color:#f92672">)</span> 0.9238795
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>2<span style="color:#f92672">)</span> 0.3826834
</span></span></code></pre></div><h2 id="æœŸæœ›å€¼-langlehatarangle">æœŸæœ›å€¼ $\langle\hat{A}\rangle$<a hidden class="anchor" aria-hidden="true" href="#æœŸæœ›å€¼-langlehatarangle">#</a></h2>
<p>åœ¨ç‰©ç†ä¸Šæˆ‘ä»¬å®šä¹‰ç®—ç¬¦ $\hat{A}$ çš„æœŸæœ›å€¼ä¸º $\langle\psi|\hat{A}|\psi\rangle$.</p>
<p>æˆ‘ä»¬ä¸å¦¨æ±‚è‡ªæ—‹ç®—ç¬¦ $\hat{S_z}$ çš„æœŸæœ›å€¼. åœ¨å¼ é‡ç½‘ç»œä¸Š, è¿™ä¸ªè¿‡ç¨‹ä½“ç°ä¸º, ä½œä¸ºç®—ç¬¦çš„&quot;å…·æœ‰ä¸Šä¸‹ä¸¤ä¸ªè§¦æ‰‹çš„ç»“ç‚¹&quot;çš„æ¯ä¸ªè§¦æ‰‹åˆ†åˆ«è¿æ¥ä¸€ä¸ª&quot;åªæœ‰å•è§¦æ‰‹çš„ç»“ç‚¹&quot;(ä¹Ÿå°±æ˜¯ä»£è¡¨ç€å•èŠ‚ç‚¹æ³¢å‡½æ•°).</p>
<p>æˆ‘ä»¬ç”¨ç¨‹åºè¯­è¨€æ¥æè¿°è¿™ä¸ªè¿‡ç¨‹:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>ITensor cpsi <span style="color:#f92672">=</span> dag(prime(psi));
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Real zz = (cpsi * Sz * psi).toReal();
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// Real xx = (cpsi * Sx * psi).toReal();
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// toReal()å‡½æ•°å·²å¼ƒç”¨,ä½¿ç”¨.real()æ›¿ä»£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>Real zz <span style="color:#f92672">=</span> (cpsi <span style="color:#f92672">*</span> Sz <span style="color:#f92672">*</span> psi).real();
</span></span><span style="display:flex;"><span>Real xx <span style="color:#f92672">=</span> (cpsi <span style="color:#f92672">*</span> Sx <span style="color:#f92672">*</span> psi).real();
</span></span><span style="display:flex;"><span><span style="color:#75715e">// println(&#34;&lt;Sz&gt;=&#34;,zz);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// println(&#34;&lt;Sx&gt;=&#34;,xx);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// println()å·²å¼ƒç”¨,ä½¿ç”¨printfln()æ›¿ä»£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>printfln(<span style="color:#e6db74">&#34;&lt;Sz&gt;=&#34;</span>,zz);
</span></span><span style="display:flex;"><span>printfln(<span style="color:#e6db74">&#34;&lt;Sx&gt;=&#34;</span>,xx);
</span></span></code></pre></div><p>å…¶ä¸­<code>ITensor cpsi = dag(prime(psi));</code>å°±æ˜¯ä¸€ä¸ªå°† $\psi$ å…ˆå–è½¬ç½®åå–å…±è½­çš„è¿‡ç¨‹, æ‰€ä»¥<code>cpsi</code>çš„ä¸Šæ ‡çº§æ•°ä¸º$2$. æˆ‘ä»¬ä¹Ÿå¯ä»¥æ¨æµ‹å¾—çŸ¥, ç®—ç¬¦ $\hat{S}_x,\hat{S}_z$çš„ä¸Šæ ‡çº§æ•°ä¸º$1$.</p>
<p>ç»ˆç«¯è¾“å‡ºä¸º</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&lt;Sz&gt;<span style="color:#f92672">=</span>0.353553
</span></span><span style="display:flex;"><span>&lt;Sx&gt;<span style="color:#f92672">=</span>0.353553
</span></span></code></pre></div><p>è§‚å¯Ÿåˆ° $\sqrt{\langle S_z\rangle ^2 + \langle S_x\rangle ^2} = \frac{1}{2}$</p>
<p>æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªè¿‡ç¨‹è¿›è¡Œç±»ä¼¼ç»“åˆç‡çš„åˆ†æ:</p>
<p>$\langle\psi|\hat{S}_z|\psi\rangle = \langle\psi|\hat{S}_z\psi\rangle$.</p>
<p>ç”¨ä»£ç æ¥æè¿°ç»“åˆå¾‹çš„è¿‡ç¨‹:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>ITensor Zpsi <span style="color:#f92672">=</span> Sz <span style="color:#f92672">*</span> psi;
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å› ä¸ºSzä»¥sä¸ºä¸Šæ ‡,psiä»¥sä¸ºä¸‹æ ‡,æ‰€ä»¥å…è®¸è¿ç®—
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>ITensor expect <span style="color:#f92672">=</span> cpsi <span style="color:#f92672">*</span> Zpsi;
</span></span><span style="display:flex;"><span>Real zz <span style="color:#f92672">=</span> expect.real()
</span></span></code></pre></div><h2 id="quiz-1-è§£æ">Quiz $1$ è§£æ<a hidden class="anchor" aria-hidden="true" href="#quiz-1-è§£æ">#</a></h2>
<blockquote>
<p>æç¤º</p>
<p>åŸæ–‡æ‰€æç¤ºçš„å‡½æ•°<code>elt()</code>å·²ç»å¼ƒç”¨.æ‰€ä»¥é‡‡ç”¨çš„æ˜¯ä¼ ç»Ÿçš„<code>prime(A) * B</code>æ–¹å¼. å¦‚æœä½ æƒ³ä½¿ç”¨å‡½æ•°è€Œé <code>*</code>æ¥å¾—åˆ°å†…ç§¯, ä½ åº”å½“é‡‡ç”¨å‡½æ•°<code>inner()</code></p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;itensor/all.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;itensor/util/print_macro.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> itensor;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(){
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Define our Index 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// (the space we are working with)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> s <span style="color:#f92672">=</span> Index(<span style="color:#ae81ff">2</span>,<span style="color:#e6db74">&#34;s&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Operators 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> Sx <span style="color:#f92672">=</span> ITensor(s,prime(s));
</span></span><span style="display:flex;"><span>    Sx.set(s(<span style="color:#ae81ff">1</span>),prime(s)(<span style="color:#ae81ff">2</span>),<span style="color:#ae81ff">0.5</span>);
</span></span><span style="display:flex;"><span>    Sx.set(s(<span style="color:#ae81ff">2</span>),prime(s)(<span style="color:#ae81ff">1</span>),<span style="color:#ae81ff">0.5</span>);
</span></span><span style="display:flex;"><span>    PrintData(Sx);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Single-site wavefunction
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> psi <span style="color:#f92672">=</span> ITensor(s); <span style="color:#75715e">//initialized to zero
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// TODO 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// 1. make the above wavefunction
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    the (normalized) positive Sx eigenstate
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    psi.set(s(<span style="color:#ae81ff">1</span>),<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>sqrt(<span style="color:#ae81ff">2</span>));
</span></span><span style="display:flex;"><span>    psi.set(s(<span style="color:#ae81ff">2</span>),<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>sqrt(<span style="color:#ae81ff">2</span>));
</span></span><span style="display:flex;"><span>    PrintData(psi);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// TODO
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// 2. Compute |phi&gt; = Sx |psi&gt; using
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    the Sx and psi ITensors above
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    AND
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    compute: auto olap = &lt;psi|phi&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    using the * operator and elt(...) method.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    Print the result with PrintData(...).
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> phi <span style="color:#f92672">=</span> Sx <span style="color:#f92672">*</span> psi;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> olap <span style="color:#f92672">=</span> prime(psi) <span style="color:#f92672">*</span> phi;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//auto olap = elt(prime(psi),phi);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    PrintData(olap);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// TODO
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// 3. Try normalizing |phi&gt; and recompute
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    the inner product &lt;psi|phi&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    Print the result with PrintData(...).
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    HINT: use phi /= norm(phi)) to normalize.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    phi <span style="color:#f92672">/=</span> norm(phi);
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//auto olap2 = eltC(prime(psi),phi);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> olap2 <span style="color:#f92672">=</span> prime(psi) <span style="color:#f92672">*</span> phi;
</span></span><span style="display:flex;"><span>    PrintData(olap2);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>è¾“å‡ºå¾—åˆ°:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Sx <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>ITensor ord<span style="color:#f92672">=</span>2: <span style="color:#f92672">(</span>dim<span style="color:#f92672">=</span>2|id<span style="color:#f92672">=</span>15|<span style="color:#e6db74">&#34;s&#34;</span><span style="color:#f92672">)</span> <span style="color:#f92672">(</span>dim<span style="color:#f92672">=</span>2|id<span style="color:#f92672">=</span>15|<span style="color:#e6db74">&#34;s&#34;</span><span style="color:#f92672">)</span><span style="color:#960050;background-color:#1e0010">&#39;</span> 
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>norm<span style="color:#f92672">=</span>0.71 <span style="color:#f92672">(</span>Dense Real<span style="color:#f92672">)}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>2,1<span style="color:#f92672">)</span> 0.5000000
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>1,2<span style="color:#f92672">)</span> 0.5000000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>psi <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>ITensor ord<span style="color:#f92672">=</span>1: <span style="color:#f92672">(</span>dim<span style="color:#f92672">=</span>2|id<span style="color:#f92672">=</span>15|<span style="color:#e6db74">&#34;s&#34;</span><span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>norm<span style="color:#f92672">=</span>1.00 <span style="color:#f92672">(</span>Dense Real<span style="color:#f92672">)}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>1<span style="color:#f92672">)</span> 0.7071068
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>2<span style="color:#f92672">)</span> 0.7071068
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>olap <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>ITensor ord<span style="color:#f92672">=</span>0: 
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>norm<span style="color:#f92672">=</span>0.50 <span style="color:#f92672">(</span>Dense Real<span style="color:#f92672">)}</span>
</span></span><span style="display:flex;"><span>  0.5000000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>olap2 <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>ITensor ord<span style="color:#f92672">=</span>0: 
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>norm<span style="color:#f92672">=</span>1.00 <span style="color:#f92672">(</span>Dense Real<span style="color:#f92672">)}</span>
</span></span><span style="display:flex;"><span>  1.0000000
</span></span></code></pre></div><h1 id="two-sites-åŒèŠ‚ç‚¹">Two Sites åŒèŠ‚ç‚¹<a hidden class="anchor" aria-hidden="true" href="#two-sites-åŒèŠ‚ç‚¹">#</a></h1>
<h2 id="çº ç¼ æ€">çº ç¼ æ€<a hidden class="anchor" aria-hidden="true" href="#çº ç¼ æ€">#</a></h2>
<p>å¯¹äºåŒè‡ªæ—‹çš„æ³¢å‡½æ•°, æˆ‘ä»¬ä¸€èˆ¬çš„æè¿°æ–¹ç¨‹æ˜¯:</p>
<p>$$
|\Psi\rangle = \sum_{s_1,s_2 = 1}^{2}\psi_{s_1s_2}|s_1\rangle|s_2\rangle
$$</p>
<p>ä½“ç°åœ¨å¼ é‡ç½‘ç»œä¸Š, å°±æ˜¯ä¸€ä¸ªç»“ç‚¹åœ¨åŒä¸€æ–¹å‘ä¸ŠåŒæ—¶æœ‰ç€ä¸¤ä¸ª&quot;è§¦æ‰‹&quot;.
å¯¹äºæˆ‘ä»¬å†™å‡ºæ¥çš„æ€, æˆ‘ä»¬å¯ä»¥åˆ†ç¦»å‡ºä¸¤ä¸ªå•æ€(Singlet).</p>
<p>ç¨‹åºä¸Šçš„æè¿°æ–¹æ³•:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">// Index s1(2,&#34;s1&#34;,Site), s2(2,&#34;s2&#34;,Site);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// è¯¥è¯­æ³•å·²ç»è¢«å¼ƒç”¨,ä½¿ç”¨ä¸¤æ­¥è¯­æ³•æ¥æ›¿ä»£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>Index <span style="color:#a6e22e">s1</span>(<span style="color:#ae81ff">2</span>,<span style="color:#e6db74">&#34;s1&#34;</span>);s1.addTags(<span style="color:#e6db74">&#34;Site&#34;</span>);
</span></span><span style="display:flex;"><span>Index <span style="color:#a6e22e">s2</span>(<span style="color:#ae81ff">2</span>,<span style="color:#e6db74">&#34;s2&#34;</span>);s1.addTags(<span style="color:#e6db74">&#34;Site&#34;</span>);
</span></span><span style="display:flex;"><span>ITensor <span style="color:#a6e22e">psi</span>(s1,s2);                 <span style="color:#75715e">//åªå£°æ˜ä¸å®šä¹‰,åˆ™é»˜è®¤ä¸º0
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// psi(s1(1),s2(2)) = 1./sqrt(2);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// psi(s1(2),s2(1)) =-1./sqrt(2);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// è¯¥è¯­æ³•å·²è¢«å¼ƒç”¨,ä½¿ç”¨.set()æ¥æ›¿ä»£.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>psi.set(s1(<span style="color:#ae81ff">1</span>),s2(<span style="color:#ae81ff">2</span>), <span style="color:#ae81ff">1.</span><span style="color:#f92672">/</span>sqrt(<span style="color:#ae81ff">2</span>));
</span></span><span style="display:flex;"><span>psi.set(s1(<span style="color:#ae81ff">2</span>),s2(<span style="color:#ae81ff">1</span>),<span style="color:#f92672">-</span><span style="color:#ae81ff">1.</span><span style="color:#f92672">/</span>sqrt(<span style="color:#ae81ff">2</span>));
</span></span><span style="display:flex;"><span>PrintData(psi);
</span></span></code></pre></div><blockquote>
<p><code>Index s1(2,&quot;s1&quot;);s1.addTags(&quot;Site&quot;);</code>ä»£è¡¨çš„å«ä¹‰æ˜¯åˆ›å»ºä¸€ä¸ªç»´æ•°ä¸º<code>int</code>,æ ‡ç­¾(æˆ–è€…ç†è§£ä¸º&quot;åå­—&quot;,ä¸€èˆ¬æ˜¯æŒ‡ç‰©ç†ä¸Šçš„çŠ¶æ€,æ¯”å¦‚è‡ªæ—‹,ç²’å­ä½ç½®ç­‰ç­‰)ä¸º<code>string</code>,æŒ‡æ ‡ç±»å‹ä¸º<code>Site</code>çš„ç‰©ç†é‡.åŒæ—¶ä½¿ç”¨<code>ITensor psi(s1,s2)</code>å°†<code>s1</code>å’Œ<code>s2</code>è®¾ç½®ä¸ºçº ç¼ æ€(<strong>Entangled State</strong>).</p>
</blockquote>
<p>ç°åœ¨è¦è¯´æ˜çš„å°±æ˜¯æŒ‡æ ‡(<code>Index</code>)çš„ç±»å‹:<code>Site</code>å’Œ<code>Link</code>.</p>
<p><code>Site</code>è¡¨ç¤ºå•ä¸ªé‡å­ä½çš„ç‰©ç†æ€. é€‚ç”¨äºè¡¨ç¤ºå•ä¸ªè‡ªæ—‹,å•ä¸ªç²’å­çš„ä½ç½®ç­‰ç­‰. ä¸ä¹‹é…å¯¹çš„ç»´æ•°<code>int</code>è¡¨ç¤ºçš„æ˜¯è¯¥é‡å­ä½å¯ä»¥å–çš„ç‰©ç†æ€çš„æ•°é‡;</p>
<p><code>Link</code>è¡¨ç¤ºçš„æ˜¯ä¸åŒé‡å­ä½ä¹‹é—´çš„ç›¸äº’ä½œç”¨. è¿™ç§ç›¸äº’ä½œç”¨é€šå¸¸è¡¨ç¤ºä¸åŒé‡å­ä½çš„é“¾æ¥, é€‚ç”¨äºè¡¨ç¤ºå„ç§ç›¸äº’ä½œç”¨, æ¯”å¦‚å“ˆå¯†é¡¿é‡ç­‰.</p>
<p><del>(è¿˜æœ‰è¡¨ç¤ºä¸åŒäº<code>Site</code>å’Œ<code>Link</code>ç±»å‹çš„å…¶å®ƒæŒ‡æ ‡ç±»å‹, æ¯”å¦‚<code>Bulk</code>)</del></p>
<p>ä¸Šé¢çš„ä»£ç ä¸­æˆ‘ä»¬ç”¨<code>Site</code>æ¥æ ‡è®°ä¸¤ä¸ªé‡å­ä½,å¹¶ä¸”ä½¿å…¶ç»“åˆä¸ºçº ç¼ æ€.</p>
<p>ç»“æœè¾“å‡ºä¸º</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>psi <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>ITensor ord<span style="color:#f92672">=</span>2: <span style="color:#f92672">(</span>dim<span style="color:#f92672">=</span>2|id<span style="color:#f92672">=</span>324|<span style="color:#e6db74">&#34;s1,Site&#34;</span><span style="color:#f92672">)</span> <span style="color:#f92672">(</span>dim<span style="color:#f92672">=</span>2|id<span style="color:#f92672">=</span>127|<span style="color:#e6db74">&#34;s2&#34;</span><span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>norm<span style="color:#f92672">=</span>1.00 <span style="color:#f92672">(</span>Dense Real<span style="color:#f92672">)}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>2,1<span style="color:#f92672">)</span> -0.707107
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>1,2<span style="color:#f92672">)</span> 0.7071068
</span></span></code></pre></div><h2 id="å“ˆå¯†é¡¿é‡hath">å“ˆå¯†é¡¿é‡$\hat{H}$<a hidden class="anchor" aria-hidden="true" href="#å“ˆå¯†é¡¿é‡hath">#</a></h2>
<p>æˆ‘ä»¬å†™å‡ºåŒè‡ªæ—‹ç³»ç»Ÿçš„å“ˆå¯†é¡¿é‡æ–¹ç¨‹:</p>
<p>$\hat{H}=\hat{S}_1\cdot\hat{S}_2=S_1^zS_2^z+\frac{1}{2}S_1^+S_2^-+\frac{1}{2}S_1^-S_2^+$</p>
<p>å…¶ä¸­ $S_1^\pm, S_2^\pm$ æ˜¯å‡é™ç®—ç¬¦. æˆ‘ä»¬åœ¨ç¨‹åºä¸­è¿™æ ·åˆ›å»º:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>Index <span style="color:#a6e22e">s1</span>(<span style="color:#ae81ff">2</span>,<span style="color:#e6db74">&#34;s1&#34;</span>);s1.addTags(<span style="color:#e6db74">&#34;Site&#34;</span>);
</span></span><span style="display:flex;"><span>Index <span style="color:#a6e22e">s2</span>(<span style="color:#ae81ff">2</span>,<span style="color:#e6db74">&#34;s2&#34;</span>);s1.addTags(<span style="color:#e6db74">&#34;Site&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ITensor <span style="color:#a6e22e">Sz1</span>(s1,prime(s1)),Sp1(s1,prime(s1)),Sm1(s1,prime(s1));
</span></span><span style="display:flex;"><span>ITensor <span style="color:#a6e22e">Sz2</span>(s2,prime(s2)),Sp2(s2,prime(s2)),Sm2(s2,prime(s2));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// commaInit(Sp1,s1,prime(s1)) =   0, 1,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//                                 0, 0;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// commaInitè¯­æ³•å·²è¢«å¼ƒç”¨.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//Sz1,Sz2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>Sz1.set(s1(<span style="color:#ae81ff">1</span>),prime(s1)(<span style="color:#ae81ff">1</span>),<span style="color:#ae81ff">0.5</span>);Sz1.set(s1(<span style="color:#ae81ff">2</span>),prime(s1)(<span style="color:#ae81ff">2</span>),<span style="color:#f92672">-</span><span style="color:#ae81ff">0.5</span>);
</span></span><span style="display:flex;"><span>Sz2.set(s2(<span style="color:#ae81ff">1</span>),prime(s2)(<span style="color:#ae81ff">1</span>),<span style="color:#ae81ff">0.5</span>);Sz2.set(s2(<span style="color:#ae81ff">2</span>),prime(s2)(<span style="color:#ae81ff">2</span>),<span style="color:#f92672">-</span><span style="color:#ae81ff">0.5</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//Sp1,Sp2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>Sp1.set(s1(<span style="color:#ae81ff">1</span>),prime(s1)(<span style="color:#ae81ff">2</span>),<span style="color:#ae81ff">1</span>);Sp2.set(s2(<span style="color:#ae81ff">1</span>),prime(s2)(<span style="color:#ae81ff">2</span>),<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//Sm1,Sm2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>Sm1.set(s1(<span style="color:#ae81ff">2</span>),prime(s1)(<span style="color:#ae81ff">1</span>),<span style="color:#ae81ff">1</span>);Sm2.set(s2(<span style="color:#ae81ff">2</span>),prime(s2)(<span style="color:#ae81ff">1</span>),<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ITensor H <span style="color:#f92672">=</span> Sz1 <span style="color:#f92672">*</span> Sz2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.5</span> <span style="color:#f92672">*</span> Sp1 <span style="color:#f92672">*</span> Sm2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.5</span> <span style="color:#f92672">*</span> Sm1 <span style="color:#f92672">*</span> Sp2;
</span></span><span style="display:flex;"><span>PrintData(H);<span style="color:#75715e">//ä½ ä¹Ÿå¯ä»¥å°è¯•æ‰§è¡Œprintfln(&#34;H=&#34;,H);
</span></span></span></code></pre></div><p>æ‰§è¡Œåå¯ä»¥å¾—åˆ°ç»“æœ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>H <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>ITensor ord<span style="color:#f92672">=</span>4: <span style="color:#f92672">(</span>dim<span style="color:#f92672">=</span>2|id<span style="color:#f92672">=</span>397|<span style="color:#e6db74">&#34;s1,Site&#34;</span><span style="color:#f92672">)</span> <span style="color:#f92672">(</span>dim<span style="color:#f92672">=</span>2|id<span style="color:#f92672">=</span>397|<span style="color:#e6db74">&#34;s1,Site&#34;</span><span style="color:#f92672">)</span><span style="color:#e6db74">&#39; (dim=2|id=53|&#34;s2&#34;) (dim=2|id=53|&#34;s2&#34;)&#39;</span> 
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>norm<span style="color:#f92672">=</span>0.87 <span style="color:#f92672">(</span>Dense Real<span style="color:#f92672">)}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>1,1,1,1<span style="color:#f92672">)</span> 0.2500000
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>2,2,1,1<span style="color:#f92672">)</span> -0.250000
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>1,2,2,1<span style="color:#f92672">)</span> 0.5000000
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>2,1,1,2<span style="color:#f92672">)</span> 0.5000000
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>1,1,2,2<span style="color:#f92672">)</span> -0.250000
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>2,2,2,2<span style="color:#f92672">)</span> 0.2500000
</span></span></code></pre></div><blockquote>
<p>è¿™è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªå››é˜¶å¼ é‡,å¹¶ä¸”ç”±ç´¢å¼•<code>s1</code>, <code>s1'</code>, <code>s2</code>, <code>s2'</code>æ¥æè¿°. å®ƒä»¬å„è‡ªçš„ç»´åº¦éƒ½æ˜¯$2$, å³å®ƒä»¬å¯ä»¥å–å€¼ä¸º$1$æˆ–$2$.è¿™å°±æ˜¯<code>(i,j,k,l)</code>ä¸­<code>1</code>æˆ–è€…<code>2</code>çš„å«ä¹‰, åé¢çš„å€¼æ˜¯å¯¹åº”çš„å¼ é‡å…ƒç´ .</p>
</blockquote>
<p>è¿™æ ·è®¡ç®—å¾—æ¥çš„ $\hat{H}$ åœ¨å¼ é‡ç½‘ç»œä¸­è¡¨ç¤ºä¸€ä¸ªä¸Šä¸‹å„è‡ªæœ‰ä¸¤ä¸ª&quot;è§¦æ‰‹&quot;çš„ç»“ç‚¹, æ°å¥½å¯ä»¥å’Œè¡¨ç°ä¸ºåœ¨æŸä¸€æ–¹å‘ä¸Šæ‹¥æœ‰ä¸¤ä¸ª&quot;è§¦æ‰‹&quot;çš„çº ç¼ æ€ç»“ç‚¹è¿›è¡Œç»“åˆ.</p>
<p>æ›´å…·ä½“åœ°è¯´, æˆ‘ä»¬ä¸Šé¢åˆ›å»ºçš„ $\hat{H}$ çš„ä¸Šæ ‡æ˜¯<code>s1'</code>å’Œ<code>s2'</code>,ä¸‹æ ‡æ˜¯<code>s1</code>å’Œ<code>s2</code>;
è€Œ $\psi$ çš„ä¸Šæ ‡æ˜¯<code>s1</code>å’Œ<code>s2</code>,ä¸¤è€…è¿›è¡Œç»“åˆå°±å¯ä»¥å¾—åˆ°åªæœ‰ä¸¤ä¸ªä¸Šæ ‡<code>s1'</code>å’Œ<code>s2'</code>çš„æ–°èŠ‚ç‚¹ $\hat{H}\psi$ .</p>
<p>ç¨‹åºä¸Šè¿™æ ·æè¿°è¿™ä¸ªç»“åˆçš„è¿‡ç¨‹:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>ITensor Hpsi <span style="color:#f92672">=</span> H <span style="color:#f92672">*</span> psi;
</span></span><span style="display:flex;"><span><span style="color:#75715e">//Hpsi.mapprime(1,0);//è¯¥è¯­å¥çš„ä½œç”¨æ˜¯å°†Hpsiä¸­æ‰€æœ‰ä¸Šæ ‡çº§åˆ«ä¸º1çš„ç´¢å¼•å…¨éƒ¨é™ä¸º0,ä½¿å¾—ä¹‹åçš„è¿ç®—èƒ½å¤Ÿè¢«å…è®¸
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//è¯¥è¯­æ³•å·²è¢«å¼ƒç”¨. ä½¿ç”¨.noPrime()æ¥ä»£æ›¿
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>Hpsi.noPrime();
</span></span><span style="display:flex;"><span>Real E <span style="color:#f92672">=</span> (dag(psi) <span style="color:#f92672">*</span> Hpsi).real();
</span></span><span style="display:flex;"><span><span style="color:#75715e">//Print()è¯­æ³•å·²è¢«å¼ƒç”¨, ä½¿ç”¨PrintData()æ¥ä»£æ›¿.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>PrintData(E);
</span></span></code></pre></div><p>èƒ½å¤Ÿåœ¨ç»ˆç«¯å¾—åˆ°è¾“å‡º</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>E <span style="color:#f92672">=</span> -0.75
</span></span></code></pre></div><p>å½“ç„¶è¿™ä¸ªè¿‡ç¨‹ä¹Ÿå¯ä»¥ä¸€è¡Œè¯­å¥å®Œæˆ:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>Real E <span style="color:#f92672">=</span> (dag(prime(psi)) <span style="color:#f92672">*</span> H <span style="color:#f92672">*</span> psi).real();
</span></span><span style="display:flex;"><span>PrintData(E);
</span></span></code></pre></div><p>è¾“å‡ºçš„ç»“æœåŒæ ·æ˜¯</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>E <span style="color:#f92672">=</span> -0.75
</span></span></code></pre></div><h2 id="quiz-2-è§£æ">Quiz $2$ è§£æ<a hidden class="anchor" aria-hidden="true" href="#quiz-2-è§£æ">#</a></h2>
<blockquote>
<p>è¿™ä¸ªé¢˜ç›®çš„èƒŒæ™¯æ˜¯, ä½¿ç”¨è™šæ—¶é—´æ¼”åŒ–çš„æ–¹å¼æ¥æ‰¾åˆ°å“ˆå¯†é¡¿é‡æ‰€å¯¹åº”çš„åŸºæ€. å¯¹åº”çš„æ–¹ç¨‹æ˜¯</p>
<p>$e^{-\beta H/2}|0\rangle\propto|\Psi_0\rangle$</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;itensor/all.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;itensor/util/print_macro.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> itensor;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//å®šä¹‰ç”ŸæˆSp Sm Szçš„å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>ITensor <span style="color:#a6e22e">makeSp</span>(Index <span style="color:#66d9ef">const</span><span style="color:#f92672">&amp;</span> s){
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> Sp <span style="color:#f92672">=</span> ITensor(s,prime(s));
</span></span><span style="display:flex;"><span>    Sp.set(s<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,prime(s)<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> Sp;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ITensor <span style="color:#a6e22e">makeSm</span>(Index <span style="color:#66d9ef">const</span><span style="color:#f92672">&amp;</span> s){
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> Sm <span style="color:#f92672">=</span> ITensor(s,prime(s));
</span></span><span style="display:flex;"><span>    Sm.set(s<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,prime(s)<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> Sm;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ITensor <span style="color:#a6e22e">makeSz</span>(Index <span style="color:#66d9ef">const</span><span style="color:#f92672">&amp;</span> s){
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> Sz <span style="color:#f92672">=</span> ITensor(s,prime(s));
</span></span><span style="display:flex;"><span>    Sz.set(s<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,prime(s)<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,<span style="color:#f92672">+</span><span style="color:#ae81ff">0.5</span>);
</span></span><span style="display:flex;"><span>    Sz.set(s<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,prime(s)<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">0.5</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> Sz;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(){
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Initial product state
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> s1 <span style="color:#f92672">=</span> Index(<span style="color:#ae81ff">2</span>,<span style="color:#e6db74">&#34;s1&#34;</span>);<span style="color:#66d9ef">auto</span> s2 <span style="color:#f92672">=</span> Index(<span style="color:#ae81ff">2</span>,<span style="color:#e6db74">&#34;s2&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> psi <span style="color:#f92672">=</span> ITensor(s1,s2);
</span></span><span style="display:flex;"><span>    psi.set(s1<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,s2<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1.0</span>);
</span></span><span style="display:flex;"><span>    PrintData(psi);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Single-site operators
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> Sz1 <span style="color:#f92672">=</span> makeSz(s1);<span style="color:#66d9ef">auto</span> Sz2 <span style="color:#f92672">=</span> makeSz(s2);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> Sp1 <span style="color:#f92672">=</span> makeSp(s1);<span style="color:#66d9ef">auto</span> Sp2 <span style="color:#f92672">=</span> makeSp(s2);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> Sm1 <span style="color:#f92672">=</span> makeSm(s1);<span style="color:#66d9ef">auto</span> Sm2 <span style="color:#f92672">=</span> makeSm(s2);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Two-site Heisenberg Hamiltonian
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> H <span style="color:#f92672">=</span> Sz1 <span style="color:#f92672">*</span> Sz2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.5</span> <span style="color:#f92672">*</span> Sp1 <span style="color:#f92672">*</span> Sm2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.5</span> <span style="color:#f92672">*</span> Sm1 <span style="color:#f92672">*</span> Sp2;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Initial energy expectation value
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> initEn <span style="color:#f92672">=</span> elt(dag(prime(psi)) <span style="color:#f92672">*</span> H <span style="color:#f92672">*</span> psi);
</span></span><span style="display:flex;"><span>    printfln(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Initial energy = %.10f&#34;</span>,initEn);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Make exp(-beta*H)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// TODO
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// 3. Adjust beta to get the ground state
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    Real beta <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> expH <span style="color:#f92672">=</span> expHermitian(H,<span style="color:#f92672">-</span>beta);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Here we apply exp(-beta*H), normalize
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// and unprime
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> psibeta <span style="color:#f92672">=</span> expH <span style="color:#f92672">*</span> psi;
</span></span><span style="display:flex;"><span>    psibeta.noPrime();
</span></span><span style="display:flex;"><span>    psibeta <span style="color:#f92672">/=</span> norm(psibeta);
</span></span><span style="display:flex;"><span>    PrintData(psibeta);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> En <span style="color:#f92672">=</span> elt(dag(prime(psibeta)) <span style="color:#f92672">*</span> H <span style="color:#f92672">*</span> psibeta);
</span></span><span style="display:flex;"><span>    printfln(<span style="color:#e6db74">&#34;At beta=%.1f, energy = %.10f&#34;</span>,beta,En);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// TODO
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// 1. Adjust the following code to
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    truncate to dimension 1.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    HINT: use the ITensor named argument
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    system, e.g. {&#34;MaxDim=&#34;,...}
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> [U,D,V] <span style="color:#f92672">=</span> svd(psibeta,{s1},{<span style="color:#e6db74">&#34;MaxDim=&#34;</span>,<span style="color:#ae81ff">1</span>});
</span></span><span style="display:flex;"><span>    PrintData(D);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// TODO
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// 2. Calculate the overlap of the new
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    wavefunction with the old wavefunction.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    Print your results with PrintData(...).
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    HINT: use U*D*V to calculate the new,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    truncated wavefunction 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> newpsi <span style="color:#f92672">=</span> U <span style="color:#f92672">*</span> D <span style="color:#f92672">*</span> V;
</span></span><span style="display:flex;"><span>    PrintData(newpsi);
</span></span><span style="display:flex;"><span>    Real op <span style="color:#f92672">=</span> (dag(prime(newpsi)) <span style="color:#f92672">*</span> H <span style="color:#f92672">*</span> psibeta).real();
</span></span><span style="display:flex;"><span>    PrintData(op);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// TODO
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// 3. Increase beta (defined above) to get the
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    ground state. How does the overlap 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    change?
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>è¾“å‡ºå¾—åˆ°.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>psi <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>ITensor ord<span style="color:#f92672">=</span>2: <span style="color:#f92672">(</span>dim<span style="color:#f92672">=</span>2|id<span style="color:#f92672">=</span>311|<span style="color:#e6db74">&#34;s1&#34;</span><span style="color:#f92672">)</span> <span style="color:#f92672">(</span>dim<span style="color:#f92672">=</span>2|id<span style="color:#f92672">=</span>239|<span style="color:#e6db74">&#34;s2&#34;</span><span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>norm<span style="color:#f92672">=</span>1.00 <span style="color:#f92672">(</span>Dense Real<span style="color:#f92672">)}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>1,2<span style="color:#f92672">)</span> 1.0000000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Initial energy <span style="color:#f92672">=</span> -0.2500000000
</span></span><span style="display:flex;"><span>psibeta <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>ITensor ord<span style="color:#f92672">=</span>2: <span style="color:#f92672">(</span>dim<span style="color:#f92672">=</span>2|id<span style="color:#f92672">=</span>311|<span style="color:#e6db74">&#34;s1&#34;</span><span style="color:#f92672">)</span> <span style="color:#f92672">(</span>dim<span style="color:#f92672">=</span>2|id<span style="color:#f92672">=</span>239|<span style="color:#e6db74">&#34;s2&#34;</span><span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>norm<span style="color:#f92672">=</span>1.00 <span style="color:#f92672">(</span>Dense Real<span style="color:#f92672">)}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>2,1<span style="color:#f92672">)</span> -0.049896
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>1,2<span style="color:#f92672">)</span> 0.9987544
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>At beta<span style="color:#f92672">=</span>0.1, energy <span style="color:#f92672">=</span> -0.2998339973
</span></span><span style="display:flex;"><span>D <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>ITensor ord<span style="color:#f92672">=</span>2: <span style="color:#f92672">(</span>dim<span style="color:#f92672">=</span>1|id<span style="color:#f92672">=</span>426|<span style="color:#e6db74">&#34;U,Link&#34;</span><span style="color:#f92672">)</span> <span style="color:#f92672">(</span>dim<span style="color:#f92672">=</span>1|id<span style="color:#f92672">=</span>228|<span style="color:#e6db74">&#34;V,Link&#34;</span><span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>norm<span style="color:#f92672">=</span>1.00 <span style="color:#f92672">(</span>Diag Real<span style="color:#f92672">)}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>1,1<span style="color:#f92672">)</span> 0.9987544
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>newpsi <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>ITensor ord<span style="color:#f92672">=</span>2: <span style="color:#f92672">(</span>dim<span style="color:#f92672">=</span>2|id<span style="color:#f92672">=</span>311|<span style="color:#e6db74">&#34;s1&#34;</span><span style="color:#f92672">)</span> <span style="color:#f92672">(</span>dim<span style="color:#f92672">=</span>2|id<span style="color:#f92672">=</span>239|<span style="color:#e6db74">&#34;s2&#34;</span><span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>norm<span style="color:#f92672">=</span>1.00 <span style="color:#f92672">(</span>Dense Real<span style="color:#f92672">)}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>1,2<span style="color:#f92672">)</span> 0.9987544
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>op <span style="color:#f92672">=</span> -0.274295
</span></span></code></pre></div><p>æ‰€ä»¥åªè¦æˆ‘ä»¬ä¸€ç›´è°ƒæ•´<code>beta</code>çš„å–å€¼åå¤ç¼–è¯‘æ‰§è¡Œ, æœ€åå°±èƒ½å¤Ÿæ‰¾åˆ°èƒ½é‡æœ€ä½æ—¶æ‰€å¯¹åº”çš„<code>beta</code>å€¼.</p>
<h1 id="svd-å¥‡å¼‚å€¼åˆ†è§£">SVD å¥‡å¼‚å€¼åˆ†è§£<a hidden class="anchor" aria-hidden="true" href="#svd-å¥‡å¼‚å€¼åˆ†è§£">#</a></h1>
<blockquote>
<p><strong>Singular Value Decomposition</strong></p>
<p>å¦‚æœMæ˜¯ $m\times m$ çš„çŸ©é˜µ, é‚£ä¹ˆä¸€å®šå­˜åœ¨è¿™æ ·ä¸€ä¸ªå¼å­:</p>
<p>$M = U \Sigma V^*$</p>
<p>å…¶ä¸­$U$æ˜¯ $m\times m$ çš„é…‰çŸ©é˜µ,
$\Sigma$ æ˜¯ $m\times n$ éè´Ÿå®æ•°å¯¹ç„¦çŸ©é˜µ,
$V^*$ æ˜¯ $n\times n$ çš„é…‰çŸ©é˜µ.</p>
<p>å…¶ä¸­ $\Sigma$ å¯¹è§’çº¿ä¸Šçš„å…ƒç´  $\Sigma_{i,i}$ æ˜¯ $M$ çš„å¥‡å¼‚å€¼.</p>
</blockquote>
<blockquote>
<p>å¯†åº¦çŸ©é˜µé‡æ•´åŒ–ç¾¤ <strong>Density Matrix Renormalization Group</strong></p>
<p>è¯¥æ–¹æ³•é€šè¿‡çŸ©é˜µä¹˜ç§¯æ€(Matrix Product State,MPS)æ¥è¡¨ç¤ºé‡å­å¤šä½“ç³»ç»Ÿçš„æ³¢å‡½æ•°ç­‰.
DMRGæ–¹æ³•æ¥æºäºå¯†åº¦çŸ©é˜µçš„ç†è®ºå’Œé‡æ•´åŒ–ç¾¤çš„æ€æƒ³, å¤§å¹…å‡å°‘ç³»ç»Ÿè‡ªç”±åº¦çš„åŒæ—¶ä¿ç•™äº†ç³»ç»Ÿä¸­çš„ç‰©ç†ç‰¹å¾.</p>
</blockquote>
<p>å¯¹äº</p>
<p>$$
M=
\begin{bmatrix}
0.435839 &amp; 0.223707 &amp; 0.10\\
0.435839 &amp; 0.223707 &amp; -0.10 \\
0.223707 &amp; 0.435839 &amp; 0.10 \\
0.223707 &amp; 0.435839 &amp; -0.10 \\
\end{bmatrix}
$$</p>
<p>å¯ä»¥åˆ†è§£ä¸º $A * D * B$:</p>
<p>$$
\begin{bmatrix}
0.5 &amp;-0.5 &amp; 0.5 \\
0.5 &amp;-0.5 &amp;-0.5 \\
0.5 &amp; 0.5 &amp; 0.5 \\
0.5 &amp; 0.5 &amp;-0.5 \\
\end{bmatrix}*
\begin{bmatrix}
0.933 &amp; 0 &amp; 0 \\
0 &amp; 0.300 &amp; 0 \\
0 &amp; 0 &amp; 0.200 \\
\end{bmatrix}*
\begin{bmatrix}
0.707107 &amp; 0.707107 &amp; 0 \\
-0.707107 &amp; 0.707107 &amp; 0 \\
0 &amp; 0 &amp; 1 \\
\end{bmatrix}
$$</p>
<p>å¯ä»¥çœ‹å‡º, ä¸¤è¾¹çš„çŸ©é˜µ $A,B$ æ»¡è¶³é…‰çŸ©é˜µçš„å®šä¹‰, å³æœ‰ $A^{\dagger}A=I,BB^{\dagger}=I$.è€Œå¯¹è§’çŸ©é˜µ $D$ ,å…ƒç´ æ˜¯éè´Ÿå®æ•°ä¸”é™åºæ’åˆ—.</p>
<p>å¦‚æœæˆ‘ä»¬ä»åå¾€å‰ä¸€æ­¥æ­¥å»é™¤ $D$ å¯¹è§’çº¿ä¸Šçš„å…ƒç´ , å³</p>
<p>$$
\begin{bmatrix}
0.933 &amp; 0 &amp; 0 \\
0 &amp; 0.300 &amp; 0 \\
0 &amp; 0 &amp; 0.200 \\
\end{bmatrix}
\rightarrow
\begin{bmatrix}
0.933 &amp; 0 &amp; 0 \\
0 &amp; 0.300 &amp; 0 \\
0 &amp; 0 &amp; 0 \\
\end{bmatrix}
\rightarrow
\begin{bmatrix}
0.933 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 \\
\end{bmatrix}
$$</p>
<p>è¿™ç§æ“ä½œè¢«ç§°ä¸ºæˆªæ–­(Truncating).</p>
<p>ç„¶åä¾æ¬¡é‡æ–°è¿›è¡Œ $M_{i} = A * D_{i} * B$ åˆæˆ,
å¹¶ä¸”ä½¿ç”¨èŒƒæ•° $||M_i - M||^2$ æ¥å¯¹åˆæˆåçš„çŸ©é˜µäº§ç”Ÿçš„åå·®ç¨‹åº¦è¿›è¡Œè¯„ä¼°.æˆ‘ä»¬å°†å¯ä»¥çœ‹åˆ°:</p>
<p>$$
||M - M||^2 = 0;\
||M - M_1||^2 =  (0.2)^2;\
||M - M_2||^2 = (0.2)^2 + (0.3)^2;
$$</p>
<p>æˆ‘ä»¬ä¸éš¾çœ‹å‡º, å…¶å®æˆªæ–­å°±æ˜¯åœ¨é™ä½çŸ©é˜µ $D$ çš„ç§©, é€šè¿‡æŠŠæ¡è¿™ä¸ªæˆªæ–­çš„å¹…åº¦, æˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶æœ€åäº§ç”Ÿ $M_i$ çŸ©é˜µçš„åå·®ç¨‹åº¦. è¿™æ˜¯ä¸€ä¸ªç”¨ç²¾åº¦æ¢é€Ÿåº¦çš„è¿‡ç¨‹.</p>
<h2 id="åŒè‡ªæ—‹æ³¢å‡½æ•°">åŒè‡ªæ—‹æ³¢å‡½æ•°<a hidden class="anchor" aria-hidden="true" href="#åŒè‡ªæ—‹æ³¢å‡½æ•°">#</a></h2>
<p>æˆ‘ä»¬ä¸å¦¨ç”¨æ›´ç‰©ç†ä¸€ç‚¹çš„èƒŒæ™¯æ¥åˆ†æå¥‡å¼‚å€¼åˆ†è§£çš„è¿‡ç¨‹.</p>
<p>å¯¹äºä¸€ä¸ªçº ç¼ æ€çš„åŒè‡ªæ—‹ç³»ç»Ÿ, æˆ‘ä»¬å·²ç»çŸ¥é“å¯ä»¥å¤„ç†ä¸ºä¸€ä¸ªå…·æœ‰ä¸¤ä¸ª&quot;è§¦æ‰‹&quot;(å³ä¸Šæ ‡)çš„ç»“ç‚¹. ä½†æ˜¯æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å…¶ä½œä¸ºä¸€ä¸ªçŸ©é˜µæ¥å¤„ç†, å³ä¸€ä¸ªæ‹¥æœ‰å·¦å³ä¸¤ä¸ª&quot;è§¦æ‰‹&quot;çš„ç»“ç‚¹.</p>
<p>$-^{s_1} -\square\square\square^{\psi}-^{s_2}-$</p>
<p>è¿™æ ·, æˆ‘ä»¬å°±å¯ä»¥å¯¹ä¸­é—´çš„ç»“ç‚¹è¿›è¡ŒSVDæ“ä½œ, è¿™æ ·å°±å½¢æˆäº†ä¸€ä¸ªé¡¹é“¾å¼çš„ç»“æ„:</p>
<p>$-^{s_1} -\square^{A}-\square^{D}-\square^{B}-^{s_2}-$</p>
<p>è¿™ç§æ³¢å‡½æ•°å½¢å¼, æˆ‘ä»¬å°†å…¶ç§°ä¹‹ä¸º&quot;çŸ©é˜µä¹˜ç§¯æ€&quot;(<strong>Matrix Product State,MPS</strong>).</p>
<p>ä¸ºäº†è®©è¿™ä¸ªç»“æ„çœ‹ä¸Šå»æ›´åƒæ˜¯ä¸€ä¸ªæ³¢å‡½æ•°,å¯ä»¥æƒ³è±¡ä¸¤ä¾§çš„&quot;è§¦æ‰‹&quot;æ˜¯å‘ä¸Šçš„(ä¸Šæ ‡).</p>
<p>ä¸å¦¨ç”¨ç¨‹åºæ¥æè¿°è¿™ä¸ªè¿‡ç¨‹.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>ITensor <span style="color:#a6e22e">A</span>(s1),D,B;  <span style="color:#75715e">//å…ˆå£°æ˜åä½¿ç”¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>svd(psi,A,D,B);
</span></span></code></pre></div><p>æˆ‘ä»¬å·²ç»çŸ¥é“, å¯¹äºä¸€ä¸ªå¯»å¸¸çš„åŒè‡ªæ—‹æ³¢å‡½æ•°, æˆ‘ä»¬éœ€è¦ $(2s + 1)^2$ ä¸ªå‚æ•°æ¥è¿›è¡Œæè¿°. è€Œä¸”ä¸€èˆ¬æƒ…å†µä¸‹, æˆ‘ä»¬å¯¹äºè¿™äº›å‚æ•°çš„é‡è¦ç¨‹åº¦æ˜¯æ— çŸ¥çš„.æ— æ³•æ”¾å¼ƒä»»ä½•ä¸€ä¸ªå‚æ•°, è¿™å°±ä¼šæ€¥å‰§å¢åŠ è®¡ç®—é‡.</p>
<p>è€ŒSVDç»™äº†æˆ‘ä»¬ä¸€ç§å¯èƒ½: æˆ‘ä»¬ä¸ä»…èƒ½çŸ¥é“å“ªäº›å‚æ•°æœ€é‡è¦, æˆ‘ä»¬è¿˜å¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸ŠæŒæ¡å®ƒä»¬çš„æ•°é‡, è€Œä¸”è¿™ä¸ªæ•°é‡å¾ˆæœ‰å¯èƒ½å¾ˆå°‘(æœ‰åˆ©äºè®¡ç®—!).</p>
<p>æˆ‘ä»¬ç”¨æ–¹ç¨‹æ¥è¡¨è¾¾çŸ©é˜µä¹˜ç§¯æ€çš„æ€æƒ³:</p>
<p>$$
|\Psi\rangle=\sum_{s_1,\alpha,\alpha&rsquo;,s_2}A_{s_1\alpha}D_{\alpha\alpha&rsquo;}B_{\alpha&rsquo;s_2}|s_1\rangle|s_2\rangle
$$</p>
<blockquote>
<p>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†çŸ©é˜µ $A,D$ é¢„å…ˆç›¸ä¹˜å½¢æˆæ–°çŸ©é˜µ $\psi$, å¼ é‡ç½‘ç»œçš„å½¢å¼å³ä¸º:</p>
<p>$-^{s_1} -\square^{A}-\square^{D}-\square^{B}-^{s_2}-$</p>
<p>$\downarrow$</p>
<p>$-^{s_1} -\square\square^{\psi}-\square^{B}-^{s_2}-$</p>
<p>è¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†</p>
<p>$$
|\Psi\rangle=\sum_{s_1,\alpha&rsquo;,s_2}\psi_{s_1\alpha&rsquo;}B_{\alpha&rsquo;s_2}|s_1\rangle|s_2\rangle
$$</p>
</blockquote>
<blockquote>
<p>åŒç†, æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†çŸ©é˜µ $D,B$ é¢„å…ˆç›¸ä¹˜å½¢æˆæ–°çŸ©é˜µ $\psi$, å¼ é‡ç§¯ç®—ç½‘ç»œçš„å½¢å¼ä¸º</p>
<p>$-^{s_1} -\square^{A}-\square^{D}-\square^{B}-^{s_2}-$</p>
<p>$\downarrow$</p>
<p>$-^{s_1} -\square^{A}-\square\square^{\psi}-^{s_2}-$</p>
<p>è¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†</p>
<p>$$
|\Psi\rangle=\sum_{s_1,\alpha,s_2}A_{s_1\alpha}\psi_{\alpha s_2}|s_1\rangle|s_2\rangle
$$</p>
</blockquote>
<h2 id="quiz-3-è§£æ">Quiz $3$ è§£æ<a hidden class="anchor" aria-hidden="true" href="#quiz-3-è§£æ">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;itensor/all.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;itensor/util/print_macro.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> itensor;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(){
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// SVD of matrix M
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">int</span> Nrow <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>;<span style="color:#66d9ef">int</span> Ncol <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> maxdim <span style="color:#f92672">=</span> std<span style="color:#f92672">::</span>min(Nrow,Ncol);<span style="color:#75715e">//ç¡®å®šæˆªæ–­ç»´åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> M <span style="color:#f92672">=</span> Matrix(Nrow,Ncol);
</span></span><span style="display:flex;"><span>    M(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.435839</span>; M(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.223707</span>; M(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">2</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.10</span>;
</span></span><span style="display:flex;"><span>    M(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.435839</span>; M(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.223707</span>; M(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>) <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.10</span>;
</span></span><span style="display:flex;"><span>    M(<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.223707</span>; M(<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.435839</span>; M(<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">2</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.10</span>;
</span></span><span style="display:flex;"><span>    M(<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">0</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.223707</span>; M(<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">1</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.435839</span>; M(<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">2</span>) <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.10</span>;<span style="color:#75715e">//åˆå§‹åŒ–çŸ©é˜µ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    Print(M);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//å£°æ˜å˜é‡çš„æ•°æ®ç±»å‹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    Matrix U,V;
</span></span><span style="display:flex;"><span>    Vector d;<span style="color:#75715e">//ç”¨æ¥æ¥æ”¶å¯¹è§’å…ƒç´ ,å³å¥‡å¼‚å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    SVD(M,U,d,V);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Print(U);Print(d);Print(V);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> nkeep <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>;<span style="color:#75715e">//å–çŸ©é˜µçš„æˆªæ–­ç»´åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> Dtrunc <span style="color:#f92672">=</span> Matrix(maxdim,maxdim);<span style="color:#75715e">//åªå£°æ˜ä¸å®šä¹‰,åˆ™åˆå§‹åŒ–ä¸º0
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">auto</span> j : range(nkeep)){
</span></span><span style="display:flex;"><span>        Dtrunc(j,j) <span style="color:#f92672">=</span> d(j);
</span></span><span style="display:flex;"><span>    }<span style="color:#75715e">//åœ¨å¯¹è§’çº¿ä¸Šå¡«ä¸Šæˆªæ–­ä¿ç•™çš„å¥‡å¼‚å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> Mtrunc <span style="color:#f92672">=</span> U<span style="color:#f92672">*</span>Dtrunc<span style="color:#f92672">*</span>transpose(V);<span style="color:#75715e">//é‡æ–°ç»“åˆå½¢æˆé‡‡å–æˆªæ–­åçš„çŸ©é˜µ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    Print(Mtrunc);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> diff <span style="color:#f92672">=</span> norm(M<span style="color:#f92672">-</span>Mtrunc);<span style="color:#66d9ef">auto</span> diff2 <span style="color:#f92672">=</span> sqr(diff);<span style="color:#75715e">//å–çŸ©é˜µå·®çš„èŒƒæ•°æ¥è¯„ä¼°æˆªæ–­çš„æ•ˆæœ(diff)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    printfln(<span style="color:#e6db74">&#34;|M-Mtrunc|^2 = %.2f&#34;</span>,diff2);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// SVD of two-site wavefunction
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> s1 <span style="color:#f92672">=</span> Index(<span style="color:#ae81ff">2</span>,<span style="color:#e6db74">&#34;s1&#34;</span>);<span style="color:#66d9ef">auto</span> s2 <span style="color:#f92672">=</span> Index(<span style="color:#ae81ff">2</span>,<span style="color:#e6db74">&#34;s2&#34;</span>);<span style="color:#75715e">//å£°æ˜æŒ‡æ ‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> sing <span style="color:#f92672">=</span> ITensor(s1,s2);<span style="color:#66d9ef">auto</span> prod <span style="color:#f92672">=</span> ITensor(s1,s2);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//Make sing a singlet
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    sing.set(s1<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,s2<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1.</span><span style="color:#f92672">/</span>sqrt(<span style="color:#ae81ff">2</span>));sing.set(s1<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,s2<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">1.</span><span style="color:#f92672">/</span>sqrt(<span style="color:#ae81ff">2</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//Make prod a product state
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    prod.set(s1<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,s2<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1.</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(Real mix <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; mix <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1.</span>; mix <span style="color:#f92672">+=</span> <span style="color:#ae81ff">0.1</span>){
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// TODO: ADD CODE here to create
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">// a new wavefunction that is 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">// (1-mix) times a product state plus (mix)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">// times a singlet (i.e. maximally entangled state).
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">auto</span> wf <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1.</span> <span style="color:#f92672">-</span> mix) <span style="color:#f92672">*</span> prod <span style="color:#f92672">+</span> mix <span style="color:#f92672">*</span> sing;
</span></span><span style="display:flex;"><span>        wf <span style="color:#f92672">/=</span> norm(wf);
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//PrintData(wf);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">// SVD this wavefunction and analyze the results.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">// Try computing and plotting the entanglement entropy.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        
</span></span><span style="display:flex;"><span>        ITensor A(s1),D,B;
</span></span><span style="display:flex;"><span>        Spectrum spec <span style="color:#f92672">=</span> svd(wf,A,D,B);
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//PrintData(U);PrintData(D);PrintData(V);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">auto</span> ent <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//.eig(n)è¿”å›çš„æ˜¯ç¬¬(n+1)ä¸ªæœ¬å¾å€¼,è¿™æ˜¯å› ä¸ºæ•°ç»„ä¸‹æ ‡ä»0å¼€å§‹;.numEigsKept()åˆ™æ˜¯è¡¨ç¤ºçš„ç‰¹å¾å€¼çš„æ•°ç›®
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> n <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;n <span style="color:#f92672">&lt;</span> spec.numEigsKept();n<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">auto</span> P <span style="color:#f92672">=</span> sqr(spec.eig(n));
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span>(P <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) ent <span style="color:#f92672">-=</span> P<span style="color:#f92672">*</span>log(P);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//åˆ†åˆ«ä»¥ä¸¤ä½å°æ•°å’Œå…­ä½å°æ•°çš„å½¢å¼è¾“å‡º
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        printfln(<span style="color:#e6db74">&#34;mix = %.2f, entropy = %.6f</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, mix, ent);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ä¸ºäº†èŠ‚çœç¯‡å¹…,åŸæœ¬éœ€è¦å¤šæ¬¡æ‰§è¡Œçš„<code>PrintData()</code>å‡½æ•°è¢«æ³¨é‡Šäº†. å¦‚æœä½ æœ‰æŸ¥çœ‹å…¶å…·ä½“æ•°å€¼çš„éœ€è¦å¯ä»¥åœ¨è‡ªå·±ä½¿ç”¨çš„æ—¶å€™å¯ç”¨.</p>
<p>ç¼–è¯‘å®Œæˆæ‰§è¡Œ,åœ¨ç»ˆç«¯è¾“å‡º:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>M <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>|0.4358390 0.2237070 0.1000000|
</span></span><span style="display:flex;"><span>|0.4358390 0.2237070 -0.100000|
</span></span><span style="display:flex;"><span>|0.2237070 0.4358390 0.1000000|
</span></span><span style="display:flex;"><span>|0.2237070 0.4358390 -0.100000|
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>U <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>|0.5000000 0.5000000 0.5000000|
</span></span><span style="display:flex;"><span>|0.5000000 0.5000000 -0.500000|
</span></span><span style="display:flex;"><span>|0.5000000 -0.500000 0.5000000|
</span></span><span style="display:flex;"><span>|0.5000000 -0.500000 -0.500000|
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d <span style="color:#f92672">=</span> 0.932739 0.3 0.2 
</span></span><span style="display:flex;"><span>V <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>|0.7071068 0.7071068 1.11671818E-16|
</span></span><span style="display:flex;"><span>|0.7071068 -0.707107 -8.81355030E-17|
</span></span><span style="display:flex;"><span>|-1.66426876E-17 -1.41285111E-16 1.0000000|
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Mtrunc <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>|0.4358390 0.2237070 -2.89544043E-17|
</span></span><span style="display:flex;"><span>|0.4358390 0.2237070 -2.89544043E-17|
</span></span><span style="display:flex;"><span>|0.2237070 0.4358390 1.34311222E-17|
</span></span><span style="display:flex;"><span>|0.2237070 0.4358390 1.34311222E-17|
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>|M-Mtrunc|^2 <span style="color:#f92672">=</span> 0.04
</span></span><span style="display:flex;"><span>mix <span style="color:#f92672">=</span> 0.00, entropy <span style="color:#f92672">=</span> 0.000000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mix <span style="color:#f92672">=</span> 0.10, entropy <span style="color:#f92672">=</span> 0.010473
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mix <span style="color:#f92672">=</span> 0.20, entropy <span style="color:#f92672">=</span> 0.042683
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mix <span style="color:#f92672">=</span> 0.30, entropy <span style="color:#f92672">=</span> 0.094817
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mix <span style="color:#f92672">=</span> 0.40, entropy <span style="color:#f92672">=</span> 0.160729
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mix <span style="color:#f92672">=</span> 0.50, entropy <span style="color:#f92672">=</span> 0.230729
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mix <span style="color:#f92672">=</span> 0.60, entropy <span style="color:#f92672">=</span> 0.293765
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mix <span style="color:#f92672">=</span> 0.70, entropy <span style="color:#f92672">=</span> 0.340279
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mix <span style="color:#f92672">=</span> 0.80, entropy <span style="color:#f92672">=</span> 0.364548
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mix <span style="color:#f92672">=</span> 0.90, entropy <span style="color:#f92672">=</span> 0.365602
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mix <span style="color:#f92672">=</span> 1.00, entropy <span style="color:#f92672">=</span> 0.346574
</span></span></code></pre></div><h1 id="four-å››ç»“ç‚¹">Four å››ç»“ç‚¹<a hidden class="anchor" aria-hidden="true" href="#four-å››ç»“ç‚¹">#</a></h1>
<p>å¯¹äºå››èŠ‚ç‚¹çš„çŸ©é˜µä¹˜ç§¯æ€ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™æ ·ä¸€ä¸ªæ–¹ç¨‹å¼æ¥æè¿°ï¼š</p>
<p>$$
|\Psi\rangle=\sum_{{s},{\alpha}}M_{\alpha_1}^{s_1}M_{\alpha_1\alpha_2}^{s_2}M_{\alpha_2\alpha_3}^{s_3}M_{\alpha_4}^{s_4}|s_1s_2s_3s_4\rangle
$$</p>
<p>å‰é¢æˆ‘ä»¬å·²ç»å­¦ä¹ è¿‡æ€ä¹ˆå¤„ç†å°†ä¸¤ä¸ªå•èŠ‚ç‚¹ç»“åˆä¸ºçº ç¼ æ€çš„åŒèŠ‚ç‚¹. æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œå¯ä»¥å°†å…·æœ‰ $s_3$ å’Œ $s_4$ ä¸Šæ ‡çš„ä¸¤ä¸ªå•èŠ‚ç‚¹ç»„åˆå½¢æˆå…·æœ‰ $s_3$ å’Œ $s_4$ ä¸Šæ ‡çš„çº ç¼ æ€åŒèŠ‚ç‚¹.</p>
<p>ç„¶åå°±æ˜¯åˆšæ‰æ‰€å­¦çš„å°†åŒèŠ‚ç‚¹è¿›è¡ŒSVDåˆ†è§£, è€Œè¿™é‡Œæˆ‘ä»¬è¦åˆ†è§£çš„å¯¹è±¡å°±æ˜¯åˆšæ‰åˆæˆçš„çº ç¼ æ€åŒèŠ‚ç‚¹ã€‚</p>
<p>ä¸ºäº†ç»§ç»­ä¿æŒå››èŠ‚ç‚¹çš„æ€§è´¨ï¼Œæˆ‘ä»¬å°†åˆ†è§£å‡ºçš„<code>A</code>,<code>D</code>å’Œ<code>B</code>ä¸­çš„<code>A</code>ä¸<code>D</code>ç»“åˆ,å…¶ä¸Šæ ‡æ˜¯ $s_3$ ,è€Œå‰©ä¸‹æ¥çš„<code>B</code>åˆ™å•ç‹¬ä½œä¸ºç»“ç‚¹, å…¶ä¸Šæ ‡æ˜¯ $s_4$.</p>
<p>ä»¥è¿™ç§æ–¹å¼å¾—åˆ°çš„æ–°çš„å››èŠ‚ç‚¹å¼ é‡, æˆ‘ä»¬ç§°ä¹‹ä¸º&quot;å³æ­£äº¤&quot;(<strong>Right Orthogonal</strong>)æˆ–è€…è¯´&quot;å³è§„èŒƒ&quot;, è¿™æ˜¯å› ä¸ºå•ç‹¬ä½œä¸ºç»“ç‚¹çš„ $B$ æ˜¯ é…‰çš„ ($BB^{\dagger}=I$).</p>
<p>æ˜¾ç„¶, è¿™ç§å³æ­£äº¤çš„æ€§è´¨æ˜¯å¯ä»¥å‘å·¦ä¼ é€’çš„. æ¯”å¦‚, æˆ‘ä»¬å–å·²ç»å®Œæˆäº†<strong>SVD</strong>å’Œ<strong>AD</strong>ç»“åˆçš„å››èŠ‚ç‚¹å¼ é‡ä¸­çš„å…·æœ‰ $s_2$ å’Œ $s_3$ ä¸Šæ ‡çš„å•èŠ‚ç‚¹é‡å¤ä¸Šè¿°æ“ä½œ, ä¾¿å¯ä»¥è®©å…·æœ‰ä¸Šæ ‡ $s_3$ çš„å•èŠ‚ç‚¹ä¹Ÿå…·æœ‰å³æ­£äº¤çš„æ€§è´¨.ä¾æ­¤ç±»æ¨, ä½¿å¾—é™¤äº† $s_1$ ä¹‹å¤–çš„æ‰€æœ‰å•èŠ‚ç‚¹éƒ½å…·æœ‰å³æ­£äº¤çš„æ€§è´¨.</p>
<h2 id="æœŸæœ›å€¼-langlehata_1rangle">æœŸæœ›å€¼ $\langle\hat{A}_1\rangle$<a hidden class="anchor" aria-hidden="true" href="#æœŸæœ›å€¼-langlehata_1rangle">#</a></h2>
<p>æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªå…·æœ‰4é‡å­ä½çš„çº ç¼ æ€æ³¢å‡½æ•°æ±‚ç¬¬ä¸€é‡å­ä½ç®—ç¬¦çš„æœŸæœ›å€¼çš„è¿‡ç¨‹.</p>
<p>åœ¨ä¸€èˆ¬æƒ…å†µä¸‹,æˆ‘ä»¬é€šå¸¸æ˜¯è¿™æ ·æ±‚è§£çš„(å‡è®¾ $|\psi\rangle$ å·²ç»è§„ä¸€åŒ–):</p>
<p>$$
\langle\hat{A_1}\rangle=\sum_{s}\overline{\psi}_{s&rsquo;_{1}s_{2}s_{3}s_{4}}A_{s&rsquo;_{1}s_{1}}\psi_{s_{1}s_{2}s_{3}s_{4}}
$$</p>
<p>è¿™ä¸ªè¿‡ç¨‹æ˜¾ç„¶æ˜¯åŠå…¶ç¹æ‚çš„, åœ¨è¿™ç§æƒ…å†µä¸‹æ—¶é—´å¤æ‚åº¦ä»¥ $O(2^n)$ çš„é€Ÿåº¦å¢é•¿, å¦‚æœä¸ä»¥æŸç§ç®—æ³•è¿›è¡Œç®€åŒ–å¿…ç„¶æå…¶è€—æ—¶.</p>
<p>å¦‚æœæ˜¯å·²ç»ç»è¿‡äº† SVD åˆ†è§£çš„çº ç¼ æ€æ³¢å‡½æ•°, é™¤äº†ç¬¬ä¸€é‡å­ä½ $s_1$ , å…¶ä½™çš„æ‰€æœ‰å•èŠ‚ç‚¹å…¨éƒ¨éƒ½å…·æœ‰å³æ­£äº¤æ€§è´¨, è€Œæˆ‘ä»¬æ±‚çš„æ˜¯ç¬¬ä¸€é‡å­ä½çš„ç®—ç¬¦çš„æœŸæœ›å€¼, è¿™ä¹Ÿæ„å‘³ç€å…¶ä½™é‡å­ä½ç»“åˆä¸ä¼šå¯¹ç¬¬ä¸€é‡å­ä½çš„è¿ç®—äº§ç”Ÿä»»ä½•å½±å“.</p>
<p>é€šè¿‡è¿™æ ·çš„ç®—æ³•, è®¡ç®—é‡å¾—åˆ°äº†å¤§é‡ç®€åŒ–.</p>
<p>ç”¨ç¨‹åºè¯­è¨€æ¥æè¿°è¿™ä¸ªè¿‡ç¨‹:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>SpinHalf <span style="color:#a6e22e">sites</span>(N);  <span style="color:#75715e">//è¡¨ç¤ºsitesæ˜¯Nä¸ª1/2è‡ªæ—‹é‡å­ä½çš„ä½“ç³»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>MPS <span style="color:#a6e22e">psi</span>(sites);     <span style="color:#75715e">//ä»¥çŸ©é˜µä¹˜ç§¯æ€è¡¨ç¤ºsitesä½“ç³»çš„æ³¢å‡½æ•°, å¹¶ä¸”ç”¨psiæ¥ç§°å‘¼è¿™ä¸ªæ³¢å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>computeGroundState(H,psi);<span style="color:#75715e">//å¯»æ‰¾å“ˆå¯†é¡¿é‡Hä¸‹çš„åŸºæ€, psiè¢«ç”¨ä»¥è¿›è¡Œåˆå§‹åŒ–
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>psi.position(<span style="color:#ae81ff">2</span>);<span style="color:#75715e">//å°†psiçš„æ­£åˆ™ä½ç½®è®¾ç½®ä¸ºç¬¬äºŒä¸ªä½ç½®.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>Real sz_expect <span style="color:#f92672">=</span> (dag(prime(psi.A(<span style="color:#ae81ff">2</span>),Site)) <span style="color:#f92672">*</span> sites.op(<span style="color:#e6db74">&#34;Sz&#34;</span>,<span style="color:#ae81ff">2</span>) <span style="color:#f92672">*</span> psi.A(<span style="color:#ae81ff">2</span>)).real();
</span></span></code></pre></div><blockquote>
<p>æ­£åˆ™ä½ç½®<strong>Canonical Position</strong></p>
<p>åœ¨å‰é¢çš„SVDå’Œregroupè¿‡ç¨‹ä¸­æˆ‘ä»¬åªæåˆ°äº†&quot;å³è§„èŒƒ&quot;, å®é™…ä¸Šæˆ‘ä»¬ä¹Ÿå¾ˆå®¹æ˜“å°†å…¶æ¨å¹¿åˆ°&quot;å·¦è§„èŒƒ&quot;, è¿™æ ·çš„è¯æˆ‘ä»¬å°±å¯ä»¥å°†æ­£åˆ™ä½ç½®å®šä¹‰ä¸º&quot;å·¦è§„èŒƒ&quot;å’Œ&quot;å³è§„èŒƒ&quot;åŒæ—¶æˆç«‹çš„ä½ç½®.</p>
<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­,å› ä¸ºæˆ‘ä»¬è¦æ±‚çš„æ˜¯ç¬¬äºŒé‡å­ä½çš„è‡ªæ—‹æœŸæœ›å€¼, ä¸ºäº†ç®€åŒ–æˆ‘ä»¬å°±è¦å°†å…¶å·¦å³çš„å…¨éƒ¨ç»“ç‚¹éƒ½è§„èŒƒåŒ–(å…·ä½“ç»“åˆçš„æ–¹å‘çœ‹æ­£åˆ™ä½ç½®çš„å·¦å³).</p>
</blockquote>
<h2 id="quiz-4-è§£æ">Quiz $4$ è§£æ<a hidden class="anchor" aria-hidden="true" href="#quiz-4-è§£æ">#</a></h2>
<blockquote>
<p>çŸ©é˜µä¹˜ç§¯ç®—å­<strong>Matrix Product Operator</strong>(<strong>MPO</strong>)</p>
<p>å’ŒçŸ©é˜µä¹˜ç§¯æ€(<strong>MPS</strong>)ç›¸ä¼¼, <strong>MPO</strong>ä¹Ÿæ˜¯ä¸€ç§å¼ é‡ç½‘ç»œçš„è¡¨ç¤ºæ–¹æ³•.
å®ƒå¯ä»¥ç”¨æ¥æè¿°å¤æ‚é‡å­ç³»ç»Ÿçš„å“ˆå¯†é¡¿é‡.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;itensor/all.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;itensor/util/print_macro.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> itensor;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> std<span style="color:#f92672">::</span>vector;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(){
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> N <span style="color:#f92672">=</span> <span style="color:#ae81ff">50</span>;<span style="color:#75715e">//å®šä¹‰ä¸€ä¸ªåŒ…å«50ä¸ª1/2è‡ªæ—‹çš„ç³»ç»Ÿ&#39;sites&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> sites <span style="color:#f92672">=</span> SpinHalf(N,{<span style="color:#e6db74">&#34;ConserveQNs=&#34;</span>,false});<span style="color:#75715e">//&#34;ConserveQNs=&#34;è®¾ä¸ºfalse,è¡¨ç¤ºä¸è€ƒè™‘é‡å­æ•°å®ˆæ’.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// TODO
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// 3. Adjust the external field to see how the
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    magnetization changes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    Real h <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//è°ƒæ•´hæ¥æ‰¾åˆ°ç›¸å˜ç‚¹.h = 1 æ—¶,ç³»ç»Ÿä»ç£æ€§ç›¸å˜æ— åºç›¸. 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create the MPO for the transverse field
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// Ising model
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> ampo <span style="color:#f92672">=</span> AutoMPO(sites); <span style="color:#75715e">//åˆ›å»ºä¸€ä¸ªè‡ªåŠ¨æ„é€ MPOçš„å¯¹è±¡&#39;ampo&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//ä¾æ¬¡èµ‹å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; j <span style="color:#f92672">&lt;</span> N; <span style="color:#f92672">++</span>j){
</span></span><span style="display:flex;"><span>        ampo <span style="color:#f92672">+=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">4.0</span>,<span style="color:#e6db74">&#34;Sz&#34;</span>,j,<span style="color:#e6db74">&#34;Sz&#34;</span>,j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; j <span style="color:#f92672">&lt;=</span> N; <span style="color:#f92672">++</span>j){
</span></span><span style="display:flex;"><span>        ampo <span style="color:#f92672">+=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>h,<span style="color:#e6db74">&#34;Sx&#34;</span>,j;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//å“ˆå¯†é¡¿é‡çš„ç±»å‹æ˜¯MPO, åˆ©ç”¨toMPO()å‡½æ•°å°†ampoé‡Œè•´å«çš„ä¿¡æ¯è½¬åŒ–ä¸ºå“ˆå¯†é¡¿é‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> H <span style="color:#f92672">=</span> toMPO(ampo);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create a random starting state
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// For DMRG
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//éšæœºç”Ÿæˆä¸€ä¸ªåˆå§‹æ€
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> psi0 <span style="color:#f92672">=</span> randomMPS(sites);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Run DMRG to get the ground state
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> sweeps <span style="color:#f92672">=</span> Sweeps(<span style="color:#ae81ff">5</span>);        <span style="color:#75715e">//è®¾ç½®å¯†åº¦çŸ©é˜µé‡æ•´åŒ–ç¾¤ç®—æ³•(DMRG)çš„æœ€å¤§è¿­ä»£æ¬¡æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    sweeps.maxdim() <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">20</span>;      <span style="color:#75715e">//è®¾ç½®å¯†åº¦çŸ©é˜µé‡æ•´åŒ–ç¾¤ç®—æ³•(DMRG)çš„æœ€å¤§çº ç¼ çŸ©é˜µç»´åº¦çš„åºåˆ—
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    sweeps.cutoff() <span style="color:#f92672">=</span> <span style="color:#ae81ff">1E-10</span>;        <span style="color:#75715e">//è®¾ç½®å¥‡å¼‚å€¼çš„æˆªæ–­ç²¾åº¦, åªæœ‰å¤§äºè¯¥å€¼çš„å¥‡å¼‚å€¼æ‰ä¼šè¢«ä¿ç•™
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> [E,psi] <span style="color:#f92672">=</span> dmrg(H,psi0,sweeps,{<span style="color:#e6db74">&#34;Quiet&#34;</span>,true});
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//Hä¸ºç³»ç»Ÿçš„å“ˆå¯†é¡¿é‡, ä»¥psi0ä½œä¸ºè¿­ä»£èµ·ç‚¹è¿è¡Œç®—æ³•,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//&#39;sweeps&#39;æ˜¯è¿­ä»£çš„å‚æ•°,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//&#39;{&#34;Quiet&#34;,true}&#39;è¡¨ç¤ºé™é»˜è¿è¡Œ(ä¸è¾“å‡ºè¯¦ç»†çš„è¿­ä»£ä¿¡æ¯)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//è¿”å›å€¼ä¸ºåŸºæ€èƒ½é‡å’ŒåŸºæ€æ³¢å‡½æ•°, ä»¥é‡ E å’Œ psi å¯¹è®¡ç®—ç»“æœè¿›è¡Œå­˜å‚¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//åœ¨ç»ˆç«¯æŸ¥çœ‹åŸºæ€èƒ½é‡å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    printfln(<span style="color:#e6db74">&#34;Ground state energy = &#34;</span>,E);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å¯¹psiè¿›è¡Œå…±è½­è½¬ç½®. æ­¤æ—¶psidagä¸Šæ ‡çº§åˆ«ä¸º2.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> psidag <span style="color:#f92672">=</span> dag(prime(psi));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// A vector holding the operators used
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// in the expectation value.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// All set to identity operators to start.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// Note: this is one-indexed 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//       (O[n] is the operator on site n)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//åˆ›å»ºé•¿ä¸ºN+1çš„å‘é‡, ç”¨äºå­˜å‚¨æµ‹é‡ç®—ç¬¦.O[j]ä»£è¡¨åœ¨ç¬¬jä¸ªé‡å­ä½ä¸Šçš„æµ‹é‡ç®—ç¬¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> O <span style="color:#f92672">=</span> vector<span style="color:#f92672">&lt;</span>ITensor<span style="color:#f92672">&gt;</span>(N<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//å¯¹Oè¿›è¡Œåˆå§‹åŒ–,æ–¹æ³•æ˜¯å°†æ‰€æœ‰çš„æµ‹é‡ç®—ç¬¦éƒ½è®¾ä¸ºå•ä½ç®—ç¬¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">auto</span> j : range1(N)){
</span></span><span style="display:flex;"><span>        O[j] <span style="color:#f92672">=</span> op(sites,<span style="color:#e6db74">&#34;Id&#34;</span>,j);      <span style="color:#75715e">//&#34;Id&#34;æ„æŒ‡&#34;Identity&#34;, å³å•ä½ç®—ç¬¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Position we will place our operator
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// å°†æœ¬å¾ä½ç½®é€‰ä¸ºæ­£ä¸­, å³N/2.ä»¥è¿™ä¸ªä½ç½®æ¥æ‰§è¡Œæµ‹é‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">int</span> Npos <span style="color:#f92672">=</span> N<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// TODO
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// 1. Add an operator to measure the magnetization
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    in the z direction at Npos.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    HINT: use the op(...) function.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//          It provides spin operators &#34;Sx&#34;, &#34;Sy&#34;, &#34;Sz&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//          you may want to scale your operator
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//          to make it a Pauli matrix
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> op_z <span style="color:#f92672">=</span> <span style="color:#ae81ff">2.0</span> <span style="color:#f92672">*</span> op(sites,<span style="color:#e6db74">&#34;Sz&#34;</span>,Npos);
</span></span><span style="display:flex;"><span>    O[Npos] <span style="color:#f92672">=</span> op_z;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// TODO
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// 2. Complete the following code 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    to measure the magnetization.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    Print your results with PrintData(...)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> o <span style="color:#f92672">=</span> psidag(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> O[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">*</span> psi(<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">auto</span> j : range1(<span style="color:#ae81ff">2</span>,N)){
</span></span><span style="display:flex;"><span>        o <span style="color:#f92672">*=</span> psidag(j) <span style="color:#f92672">*</span> O[j] <span style="color:#f92672">*</span> psi(j);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    PrintData(o);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// TODO
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// 3. Adjust the transverse field h at the top of the
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    file to find the critical point.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//    HINT: think about the field limits h -&gt; 0
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//          and h -&gt; infinity
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ç¼–è¯‘æ‰§è¡Œåç»ˆç«¯è¾“å‡ºï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vN Entropy at center bond b<span style="color:#f92672">=</span>25 <span style="color:#f92672">=</span> 0.002062540436
</span></span><span style="display:flex;"><span>    Eigs at center bond b<span style="color:#f92672">=</span>25: 0.9998 
</span></span><span style="display:flex;"><span>    Largest link dim during sweep 1/5 was <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>    Largest truncation error: 4.11222e-11
</span></span><span style="display:flex;"><span>    Energy after sweep 1/5 is -51.205898332822
</span></span><span style="display:flex;"><span>    Sweep 1/5 CPU time <span style="color:#f92672">=</span> 0.0146s <span style="color:#f92672">(</span>Wall time <span style="color:#f92672">=</span> 0.0177s<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    vN Entropy at center bond b<span style="color:#f92672">=</span>25 <span style="color:#f92672">=</span> 0.006828488484
</span></span><span style="display:flex;"><span>    Eigs at center bond b<span style="color:#f92672">=</span>25: 0.9992 
</span></span><span style="display:flex;"><span>    Largest link dim during sweep 2/5 was <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>    Largest truncation error: 1.88078e-08
</span></span><span style="display:flex;"><span>    Energy after sweep 2/5 is -51.298393038956
</span></span><span style="display:flex;"><span>    Sweep 2/5 CPU time <span style="color:#f92672">=</span> 0.0181s <span style="color:#f92672">(</span>Wall time <span style="color:#f92672">=</span> 0.0181s<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    vN Entropy at center bond b<span style="color:#f92672">=</span>25 <span style="color:#f92672">=</span> 0.002920154202
</span></span><span style="display:flex;"><span>    Eigs at center bond b<span style="color:#f92672">=</span>25: 0.9997 
</span></span><span style="display:flex;"><span>    Largest link dim during sweep 3/5 was <span style="color:#ae81ff">18</span>
</span></span><span style="display:flex;"><span>    Largest truncation error: 9.69913e-11
</span></span><span style="display:flex;"><span>    Energy after sweep 3/5 is -52.306536772989
</span></span><span style="display:flex;"><span>    Sweep 3/5 CPU time <span style="color:#f92672">=</span> 0.0210s <span style="color:#f92672">(</span>Wall time <span style="color:#f92672">=</span> 0.0210s<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    vN Entropy at center bond b<span style="color:#f92672">=</span>25 <span style="color:#f92672">=</span> 0.002920148259
</span></span><span style="display:flex;"><span>    Eigs at center bond b<span style="color:#f92672">=</span>25: 0.9997 
</span></span><span style="display:flex;"><span>    Largest link dim during sweep 4/5 was <span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>    Largest truncation error: 9.45633e-11
</span></span><span style="display:flex;"><span>    Energy after sweep 4/5 is -52.306549436787
</span></span><span style="display:flex;"><span>    Sweep 4/5 CPU time <span style="color:#f92672">=</span> 0.0179s <span style="color:#f92672">(</span>Wall time <span style="color:#f92672">=</span> 0.0180s<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    vN Entropy at center bond b<span style="color:#f92672">=</span>25 <span style="color:#f92672">=</span> 0.002920145615
</span></span><span style="display:flex;"><span>    Eigs at center bond b<span style="color:#f92672">=</span>25: 0.9997 
</span></span><span style="display:flex;"><span>    Largest link dim during sweep 5/5 was <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>    Largest truncation error: 9.18628e-11
</span></span><span style="display:flex;"><span>    Energy after sweep 5/5 is -52.306549436806
</span></span><span style="display:flex;"><span>    Sweep 5/5 CPU time <span style="color:#f92672">=</span> 0.0168s <span style="color:#f92672">(</span>Wall time <span style="color:#f92672">=</span> 0.0168s<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Ground state energy <span style="color:#f92672">=</span> -52.3065
</span></span><span style="display:flex;"><span>o <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>ITensor ord<span style="color:#f92672">=</span>0: 
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>norm<span style="color:#f92672">=</span>0.96 <span style="color:#f92672">(</span>Dense Real<span style="color:#f92672">)}</span>
</span></span><span style="display:flex;"><span>  -0.964679
</span></span></code></pre></div><h1 id="å°è½¦-trotter--suzuki-formula"><del>&ldquo;å°è½¦&rdquo;</del> Trotter â€“ Suzuki formula<a hidden class="anchor" aria-hidden="true" href="#å°è½¦-trotter--suzuki-formula">#</a></h1>
<p>ä¸Šä¸€ç« ä¸­æˆ‘ä»¬æµ‹é‡çš„æ˜¯å•ä¸ªé‡å­ä½çš„æœŸæœ›å€¼, å½“æˆ‘ä»¬å¢åŠ æœ‰æ•ˆç®—å­(æŒ‡åœ¨è¯¥é‡å­ä½ä¸Šå¹¶éå•ä½ç®—ç¬¦<code>&quot;Id&quot;</code>)çš„æ•°é‡, å¼ é‡ç½‘ç»œçœ‹ä¸Šå»å°±å¦‚åŒå°è½¦ä¸€èˆ¬.</p>
<blockquote>
<p><del>ä¸Šè¿°è¯­å¥å‡ä¸ºå¼ºè¡Œè§£é‡Š</del>.äº‹å®ä¸Šè¿™ä¸ªç®—æ³•æ¥æºäºæ¨¡æ‹Ÿå“ˆå¯†é¡¿é‡åŠ¨åŠ›å­¦ä¸­çš„<strong>Trotter â€“ Suzuki formula</strong>, <strong>Trotter</strong>åˆ°åº•æ˜¯å½¢å®¹&quot;å°è½¦&quot;è¿˜æ˜¯äººåå®é™…ä¸Šå¹¶ä¸å¤ªæ¸…æ¥š.</p>
</blockquote>
<p>ç°åœ¨æˆ‘ä»¬è®¾æƒ³ä¸€ä¸ªå·²ç»å¯¹äºç›¸é‚»çš„ä¸¤ä¸ªé‡å­ä½çš„å·¦/å³éƒ½å·²ç»å®Œæˆå·¦/å³è§„èŒƒåŒ–,é‚£ä¹ˆç°åœ¨è¦åšçš„å°±æ˜¯è®¡ç®—è¿™ä¸¤ä¸ªç›¸é‚»é‡å­ä½ä¸Šå¯¹åº”ç®—ç¬¦çš„æœŸæœ›å€¼.</p>
<p>å’Œå‰é¢ç« èŠ‚ä¸­å¤„ç†äºŒé‡å­ä½çš„çº ç¼ æ€ç±»ä¼¼, æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸¤ä¸ªé‡å­ä½è¿›è¡Œåˆå¹¶, è¿›è¡ŒSVDåˆ†è§£, å†é‡ç»„(è‡³äºæ˜¯<code>AD</code>ç»„åˆè¿˜æ˜¯<code>DB</code>ç»„åˆ,å¯ä»¥æ ¹æ®è‡ªå·±éœ€æ±‚æ¥è°ƒæ•´).</p>
<blockquote>
<p>æ³¨æ„: è¿™ç§ç®—æ³•ä»…é€‚ç”¨äºç›¸é‚»é‡å­ä½å¹¶ä¸å±äºåŒä¸€æ–¹å‘è§„èŒƒçš„æƒ…å†µ(æ¯”å¦‚å¹¶ä¸æ˜¯ä¸¤ä¸ªæ­£åˆ™ä½ç½®, è€Œæ˜¯åœ¨æ­£åˆ™ä½ç½®çš„åŒä¸€è¾¹), å¦åˆ™ä»¥æˆªæ–­SVDæ–¹æ³•è®¡ç®—å¾—åˆ°çš„ç»“æœå¹¶éå…¨å±€æœ€ä¼˜.</p>
</blockquote>
<p>Trotterç®—æ³•çš„ç²¾é«“åœ¨äº,å°†å“ˆå¯†é¡¿é‡(ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€ç”¨çš„ç®—å­)åˆ†è§£ä¸ºè‹¥å¹²ä¸ªå¯ä»¥ç‹¬ç«‹æ¼”åŒ–çš„å°å—, è€Œä¸”å¦‚æœå“ˆå¯†é¡¿é‡æ˜¯çŸ­ç¨‹ç›¸äº’ä½œç”¨, é‚£ä¹ˆè¿™ç§åˆ†è§£çš„æ•ˆæœå°±æ›´å¥½. å¯¹äºé•¿ç¨‹ä½œç”¨çš„å“ˆå¯†é¡¿é‡Trotterç®—æ³•çš„æ•ˆç‡å°±ä¼šæ˜æ˜¾é™ä½.åœ¨ä¸Šé¢æˆ‘ä»¬æ‰€ä¸¾çš„ä¾‹å­é‡Œ, æœ‰æ•ˆçš„å“ˆå¯†é¡¿é‡ä»…æ¶‰åŠä¸¤ä¸ªç›¸é‚»çš„é‡å­ä½, å¯ä»¥è¯´æ˜¯ç¬¦åˆçŸ­ç¨‹çš„å®šä¹‰.</p>
<p>å¦‚æœå“ˆå¯†é¡¿é‡ä¸­çš„ç›¸äº’ä½œç”¨éƒ½æ˜¯çŸ­ç¨‹çš„, æˆ‘ä»¬å¯ä»¥å°†å“ˆå¯†é¡¿é‡åˆ†è§£ä¸ºå°å—, ç”¨è‡ªæ—‹ç³»ç»Ÿä¸ºä¾‹, æˆ‘ä»¬å¯ä»¥ç”¨è¿™æ ·çš„æ–¹ç¨‹æ¥æè¿°:</p>
<p>$$
\begin{equation}
\hat{H}=\hat{H_1}+\hat{H_2}+\hat{H_3}+\dots \\
=\sum_{j}\hat{S_{j}}\cdot\hat{S_{j+1}} \\
=(\hat{S_{1}}\cdot\hat{S_{2}})+(\hat{S_{2}}\cdot\hat{S_{3}})+(\hat{S_{3}}\cdot\hat{S_{4}})\dots
\end{equation}
$$</p>
<p>é‚£ä¹ˆå‡è®¾ç³»ç»Ÿæ¼”åŒ–äº†ä¸€æçŸ­çš„è™šæ—¶é—´ $\tau$,æˆ‘ä»¬å¯ä»¥å°†ç³»ç»Ÿçš„æ¼”åŒ–å†™ä½œ:</p>
<p>$$
\begin{aligned}
e^{-\tau\hat{H}}\approxeq &amp;e^{-\tau\hat{H_1}/2}e^{-\tau\hat{H_2}/2}e^{-\tau\hat{H}_3/2}\dots\
&amp;\dots e^{-\tau\hat{H}_3/2}e^{-\tau\hat{H_2}/2}e^{-\tau\hat{H_1}/2}+O(\tau^3)
\end{aligned}
$$</p>
<blockquote>
<p><strong>è™šæ—¶æ¼”åŒ–</strong></p>
<p>å¯¹äºä¸€ä¸ªä¸€èˆ¬çš„è¡¨è¾¾å¼ $|\psi&rsquo;\rangle=e^{-\tau\hat{H}}|\psi\rangle$ (çœç•¥äº† $\hbar$ ),æœ‰ä¸¤ç§æƒ…å†µ:</p>
<ul>
<li>$\tau$ æ˜¯å®æ•°, é‚£ä¹ˆç›¸å½“äº $\tau = i\tau&rsquo;$, å…¶ä¸­ $\tau&rsquo;$æ˜¯è™šæ—¶é—´. é‚£ä¹ˆæˆ‘ä»¬åªè¦æ‰§è¡Œè¶³å¤Ÿå¤šæ­¥, å°±å¯ä»¥æœç´¢åˆ°åŸºæ€.</li>
<li>$\tau$ æ˜¯è™šæ•°, é‚£ä¹ˆå°±æ˜¯ä¸€èˆ¬çš„<strong>åŠ¨åŠ›å­¦</strong>è¡¨è¿°, ç›¸å½“äº $\tau = it$, åŸæ–¹ç¨‹å˜ä¸º $|\psi&rsquo;\rangle=e^{-it\hat{H}}|\psi\rangle$</li>
</ul>
<p>å¯¹äºç¬¬ä¸€ç§æƒ…å†µ, æœ‰ä¸€ç§åº”ç”¨çš„ä¾‹å­, å³é€šè¿‡å– $\beta/2=1/(2T)$ çš„è™šæ—¶æ¼”åŒ–æ¥æ¨¡æ‹Ÿæœ‰é™æ¸©åº¦.</p>
<p>æ›´è¯¦ç»†çš„è¯´, å°±æ˜¯å– $\tau = \frac{1}{k_BT}$ ,å°±ç›¸å½“äºè¿›è¡Œäº†ä¸€æ¬¡è™šæ—¶é—´æ¼”åŒ–. åœ¨æ¯ä¸€æ­¥æ‰§è¡Œå®Œæˆåæˆ‘ä»¬è¦å¯¹ç³»ç»Ÿçš„çŠ¶æ€è¿›è¡Œè®°å½•, ä»è€Œå¯¹ç³»ç»Ÿçš„åœ¨æ¸©åº¦Tä¸‹çš„æ€§è´¨è¿›è¡Œç»Ÿè®¡å¹³å‡.</p>
</blockquote>
<p>æˆ‘ä»¬ç”¨.gif æ¥æ¼”ç¤ºè¿™ä¸€è¿‡ç¨‹:</p>
<iframe src="https://giphy.com/embed/y5zirGH4lWCGE9j6SL" width="480" height="360" frameBorder="0" class="giphy-embed" allowFullScreen></iframe>
<p>å› ä¸ºæˆ‘ä»¬æ¯ä¸€æ­¥éƒ½åªå–äº†æ¯ä¸ªé‡å­ä½å¯¹åº”åˆ†å—å“ˆå¯†é¡¿é‡çš„ $\frac{1}{2}$ ,æ‰€ä»¥é€šè¿‡å¾€è¿”æ‰§è¡Œä¸€éå¯ä»¥ä¸æ”¹å˜çº ç¼ æ€çš„è§„èŒƒæ€§.</p>
<h1 id="quiz-5-è§£æ">Quiz 5 è§£æ<a hidden class="anchor" aria-hidden="true" href="#quiz-5-è§£æ">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;itensor/all.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;itensor/util/print_macro.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> std<span style="color:#f92672">::</span>vector;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> std<span style="color:#f92672">::</span>move;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> itensor;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">TGate</span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> i1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;<span style="color:#66d9ef">int</span> i2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//i1, i2æ˜¯ç”¨æ¥æŒ‡å®šè™šæ—¶æ¼”åŒ–ç®—å­ä¸­äº§ç”Ÿä½œç”¨çš„ä¸¤ä¸ªè‡ªæ—‹é‡å­ä½ç¼–å·
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    ITensor G;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//Gè¢«å£°æ˜ä¸ºITensorç±»å‹ï¼Œç”¨æ¥å­˜å‚¨å…·ä½“çš„è™šæ—¶æ¼”åŒ–ç®—å­å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    TGate() { }
</span></span><span style="display:flex;"><span>    TGate(<span style="color:#66d9ef">int</span> i1_, <span style="color:#66d9ef">int</span> i2_, ITensor G_) 
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">:</span> i1(i1_), i2(i2_), G(G_) { }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(){
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> N <span style="color:#f92672">=</span> <span style="color:#ae81ff">20</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> sites <span style="color:#f92672">=</span> SpinHalf(N);<span style="color:#75715e">//å£°æ˜ç³»ç»Ÿæ˜¯20ä¸ª1/2è‡ªæ—‹å­çš„ç³»ç»Ÿ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> init <span style="color:#f92672">=</span> InitState(sites);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">auto</span> n : range1(N)){
</span></span><span style="display:flex;"><span>        init.set(n, n<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">&#34;Up&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Dn&#34;</span>);
</span></span><span style="display:flex;"><span>    }<span style="color:#75715e">//å¹¶ä¸”å°†è¯¥ç³»ç»Ÿåˆå§‹åŒ–ä¸ºNeelæ€(ç›¸é‚»è‡ªæ—‹æ€»ç›¸å)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//å°†è¯¥çŠ¶æ€inité€šè¿‡MPS()è½¬è¯‘ä¸ºçŸ©é˜µä¹˜ç§¯æ€(MPS)çš„å½¢å¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> psi <span style="color:#f92672">=</span> MPS(init);
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//å®šä¹‰è™šæ—¶æ¼”åŒ–çš„æ€»æ—¶é—´å’Œæ—¶é—´é—´éš”(æ­¥é•¿)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    Real ttotal <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>;Real tstep <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//æ£€æŸ¥æ—¶é—´æ­¥é•¿å’Œæ€»æ—¶é—´æ˜¯å¦åˆæ³•
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> nt <span style="color:#f92672">=</span> <span style="color:#66d9ef">int</span>(ttotal<span style="color:#f92672">/</span>tstep<span style="color:#f92672">+</span>(<span style="color:#ae81ff">1e-9</span><span style="color:#f92672">*</span>(ttotal<span style="color:#f92672">/</span>tstep)));
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(std<span style="color:#f92672">::</span>fabs(nt<span style="color:#f92672">*</span>tstep<span style="color:#f92672">-</span>ttotal) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1E-9</span>){
</span></span><span style="display:flex;"><span>        Error(<span style="color:#e6db74">&#34;Timestep not commensurate with total time&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//Create Trotter gates (imaginary time)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//å®šä¹‰æ•°æ®ç±»å‹ä¸ºTGateçš„vectorå®¹å™¨ï¼Œç”¨æ¥å­˜å‚¨è™šæ—¶æ¼”åŒ–ç®—å­
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> gates <span style="color:#f92672">=</span> vector<span style="color:#f92672">&lt;</span>TGate<span style="color:#f92672">&gt;</span>{};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> b <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; b <span style="color:#f92672">&lt;</span> N; <span style="color:#f92672">++</span>b){
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//ä»å¤´å¼€å§‹æ„å»ºå“ˆå¯†é¡¿é‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">auto</span> hh <span style="color:#f92672">=</span> op(sites,<span style="color:#e6db74">&#34;Sz&#34;</span>,b)<span style="color:#f92672">*</span>op(sites,<span style="color:#e6db74">&#34;Sz&#34;</span>,b<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>        hh <span style="color:#f92672">+=</span> <span style="color:#ae81ff">0.5</span><span style="color:#f92672">*</span>op(sites,<span style="color:#e6db74">&#34;Sp&#34;</span>,b)<span style="color:#f92672">*</span>op(sites,<span style="color:#e6db74">&#34;Sm&#34;</span>,b<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>        hh <span style="color:#f92672">+=</span> <span style="color:#ae81ff">0.5</span><span style="color:#f92672">*</span>op(sites,<span style="color:#e6db74">&#34;Sm&#34;</span>,b)<span style="color:#f92672">*</span>op(sites,<span style="color:#e6db74">&#34;Sp&#34;</span>,b<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//è®¡ç®—åŠæ­¥é•¿çš„è™šæ—¶æ¼”åŒ–ç®—å­
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">auto</span> G <span style="color:#f92672">=</span> expHermitian(hh,<span style="color:#f92672">-</span>tstep<span style="color:#f92672">/</span><span style="color:#ae81ff">2.</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//å°†è™šæ—¶æ¼”åŒ–ç®—å­å­˜å‚¨åˆ°åä¸ºgatesçš„å®¹å™¨ä¸­(åºåˆ—å°¾éƒ¨)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">//båœ¨æ¯ä¸ªå¾ªç¯ä¸­éƒ½æœ‰ä¸€ä¸ªå€¼. ä¸‹é¢çš„bå’Œb+1æ˜¯æŒ‡åº”ç”¨ç®—å­çš„ä½ç½®.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        gates.emplace_back(b,b<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,move(G));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> b <span style="color:#f92672">=</span> N<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>; b <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">1</span>; <span style="color:#f92672">--</span>b){
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//ä»å°¾å¼€å§‹æ„å»ºå“ˆå¯†é¡¿é‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        ITensor hh <span style="color:#f92672">=</span> op(sites,<span style="color:#e6db74">&#34;Sz&#34;</span>,b)<span style="color:#f92672">*</span>op(sites,<span style="color:#e6db74">&#34;Sz&#34;</span>,b<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>        hh <span style="color:#f92672">+=</span> <span style="color:#ae81ff">0.5</span><span style="color:#f92672">*</span>op(sites,<span style="color:#e6db74">&#34;Sp&#34;</span>,b)<span style="color:#f92672">*</span>op(sites,<span style="color:#e6db74">&#34;Sm&#34;</span>,b<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>        hh <span style="color:#f92672">+=</span> <span style="color:#ae81ff">0.5</span><span style="color:#f92672">*</span>op(sites,<span style="color:#e6db74">&#34;Sm&#34;</span>,b)<span style="color:#f92672">*</span>op(sites,<span style="color:#e6db74">&#34;Sp&#34;</span>,b<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//è®¡ç®—åŠæ­¥é•¿çš„è™šæ—¶æ¼”åŒ–ç®—å­
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">auto</span> G <span style="color:#f92672">=</span> expHermitian(hh,<span style="color:#f92672">-</span>tstep<span style="color:#f92672">/</span><span style="color:#ae81ff">2.</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//å°†è™šæ—¶æ¼”åŒ–ç®—å­å­˜å‚¨åˆ°åä¸ºgatesçš„å®¹å™¨ä¸­(åºåˆ—å°¾éƒ¨)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">//båœ¨æ¯ä¸ªå¾ªç¯ä¸­éƒ½æœ‰ä¸€ä¸ªå€¼. ä¸‹é¢çš„bå’Œb+1æ˜¯æŒ‡åº”ç”¨ç®—å­çš„ä½ç½®.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        gates.emplace_back(b,b<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,move(G));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> step <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; step <span style="color:#f92672">&lt;=</span> nt; <span style="color:#f92672">++</span>step){
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//å°†ä¹‹å‰è®¡ç®—å­˜å‚¨å¥½çš„åˆ†å—ç®—å­ä¸€ä¸€å–å‡º
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">auto</span><span style="color:#f92672">&amp;</span> gate : gates){
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">//è¯»å–åˆ†å—ç®—å­å¯¹åº”çš„ä½œç”¨ä½ç½®
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">auto</span> b <span style="color:#f92672">=</span> gate.i1;
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">//è¯»å–åˆ†å—ç®—å­çš„å…·ä½“å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">auto</span><span style="color:#f92672">&amp;</span> G <span style="color:#f92672">=</span> gate.G;
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">//è®¾ç½®æ­£åˆ™ä½ç½®ä¸ºå½“å‰å¾ªç¯ä¸­çš„b
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            psi.position(b);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">//å°†ç›¸é‚»é‡å­ä½bå’Œb+1åˆæˆä¸ºæ–°å¼ é‡AA
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">auto</span> AA <span style="color:#f92672">=</span> psi(b) <span style="color:#f92672">*</span> psi(b<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// TODO: ADD CODE here that applies 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#75715e">// the gate G to the MPS bond
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#75715e">// tensor &#34;AA&#34; by multiplying
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#75715e">// G and AA using the * operator
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#75715e">// G is an ITensor
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#75715e">// with index structure:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#75715e">//   s_{b}&#39; s_{b+1}&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#75715e">//    |      |
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#75715e">//    ========
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#75715e">//    |      |
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#75715e">//   s_{b}  s_{b+1}
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#75715e">// After applying G to AA, don&#39;t forget
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#75715e">// to reset the prime level to 0 by using
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#75715e">// the noPrime method.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#75715e">//å°†Gå’ŒAAç›¸ä¹˜
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            AA <span style="color:#f92672">*=</span> G;
</span></span><span style="display:flex;"><span>            AA.noPrime();<span style="color:#75715e">//å°†AAçš„ä¸Šæ ‡çº§åˆ«é™ä¸º0, å› ä¸ºSVDæ“ä½œè¦æ±‚ä¸Šæ ‡çº§åˆ«æ˜¯ä¸€è‡´çš„
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#75715e">//Normalize AA after applying G
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            AA <span style="color:#f92672">/=</span> norm(AA);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">//SVD AA to restore MPS form
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">auto</span> [U,D,V] <span style="color:#f92672">=</span> svd(AA,inds(psi(b)),{<span style="color:#e6db74">&#34;Cutoff&#34;</span>,<span style="color:#ae81ff">1E-10</span>});
</span></span><span style="display:flex;"><span>            psi.set(b,U);
</span></span><span style="display:flex;"><span>            psi.set(b<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,D<span style="color:#f92672">*</span>V);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        printfln(<span style="color:#e6db74">&#34;Step %d/%d&#34;</span>,step,nt);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//Make Heisenberg H to
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//conveniently measure energy
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">auto</span> ampo <span style="color:#f92672">=</span> AutoMPO(sites);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">auto</span> j : range1(N<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)){
</span></span><span style="display:flex;"><span>        ampo <span style="color:#f92672">+=</span> <span style="color:#ae81ff">0.5</span>,<span style="color:#e6db74">&#34;S+&#34;</span>,j,<span style="color:#e6db74">&#34;S-&#34;</span>,j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        ampo <span style="color:#f92672">+=</span> <span style="color:#ae81ff">0.5</span>,<span style="color:#e6db74">&#34;S-&#34;</span>,j,<span style="color:#e6db74">&#34;S+&#34;</span>,j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        ampo <span style="color:#f92672">+=</span>     <span style="color:#e6db74">&#34;Sz&#34;</span>,j,<span style="color:#e6db74">&#34;Sz&#34;</span>,j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> H <span style="color:#f92672">=</span> toMPO(ampo);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    printfln(<span style="color:#e6db74">&#34;Energy = %.20f&#34;</span>,inner(psi,H,psi));
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Exact ground state energy of N=20
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// Heisenberg model:E0 = -8.6824733306
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ç¼–è¯‘æ‰§è¡Œå, åœ¨ç»ˆç«¯è¾“å‡ºçš„ç»“æœ:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Step 1/20
</span></span><span style="display:flex;"><span>Step 2/20
</span></span><span style="display:flex;"><span>Step 3/20
</span></span><span style="display:flex;"><span>Step 4/20
</span></span><span style="display:flex;"><span>Step 5/20
</span></span><span style="display:flex;"><span>Step 6/20
</span></span><span style="display:flex;"><span>Step 7/20
</span></span><span style="display:flex;"><span>Step 8/20
</span></span><span style="display:flex;"><span>Step 9/20
</span></span><span style="display:flex;"><span>Step 10/20
</span></span><span style="display:flex;"><span>Step 11/20
</span></span><span style="display:flex;"><span>Step 12/20
</span></span><span style="display:flex;"><span>Step 13/20
</span></span><span style="display:flex;"><span>Step 14/20
</span></span><span style="display:flex;"><span>Step 15/20
</span></span><span style="display:flex;"><span>Step 16/20
</span></span><span style="display:flex;"><span>Step 17/20
</span></span><span style="display:flex;"><span>Step 18/20
</span></span><span style="display:flex;"><span>Step 19/20
</span></span><span style="display:flex;"><span>Step 20/20
</span></span><span style="display:flex;"><span>Energy <span style="color:#f92672">=</span> -8.51422469470028886462
</span></span></code></pre></div><p>æœ€åçš„ç»“æœå’Œç†è®ºä¸Šè®¡ç®—å¾—åˆ°çš„ $-8.6824733306$ ç›¸å·®çº¦ä¸º $1.94%$, å¯ä»¥è¯´å·®è·ä¸å¤§.</p>
<h1 id="çŸ©é˜µä¹˜ç§¯ç®—å­-mpo">çŸ©é˜µä¹˜ç§¯ç®—å­ <strong>MPO</strong><a hidden class="anchor" aria-hidden="true" href="#çŸ©é˜µä¹˜ç§¯ç®—å­-mpo">#</a></h1>
<p>æˆ‘ä»¬å·²ç»çŸ¥é“, åœ¨å¼ é‡ç½‘ç»œä¸­, ä¸€ä¸ªå“ˆå¯†é¡¿é‡ $\hat{H}$ çœ‹ä¸Šå»å¤§æ¦‚æ˜¯è¿™ä¸ªæ ·å­:</p>
<p>$$
\sum_{|}^{|}\sum_{|}^{|}\sum_{|}^{|}\sum_{|}^{|}\sum_{|}^{|}
$$</p>
<p>è€Œä¸€ä¸ªå¯¹åº”é‡å­ä½æ•°çš„çº ç¼ æ€æ³¢å‡½æ•° $|\Psi\rangle$ åˆ™æ˜¯è¿™æ ·:</p>
<p>$$
\sum^{|}-\sum^{|}-\sum^{|}-\sum^{|}-\sum^{|}
$$</p>
<p>åœ¨ä¸Šé¢çš„å­¦ä¹ ä¸­æˆ‘ä»¬å·²ç»çŸ¥é“, è¦è®© $\hat{H}$ ä½œç”¨åˆ° $|\Psi\rangle$ ä¸Š, å…¶å®å°±æ˜¯å°†ä¸Šä¸‹æ ‡è¿›è¡Œç»“åˆçš„è¿‡ç¨‹.</p>
<p>é‚£ä¹ˆæ—¢ç„¶ $|\Psi\rangle$ èƒ½å¤Ÿå†™ä½œçŸ©é˜µä¹˜ç§¯çš„å½¢å¼, æˆ‘ä»¬è‡ªç„¶ä¹Ÿå¯ä»¥å¯¹ $\hat{H}$ è¿›è¡ŒåŒæ ·çš„è¦æ±‚,å°†å…¶åŒ–ä¸ºå¼ é‡ç½‘ç»œä¸­çš„è¿™ç§å½¢å¼:</p>
<p>$$
\sum_{|}^{|}-\sum_{|}^{|}-\sum_{|}^{|}-\sum_{|}^{|}-\sum_{|}^{|}
$$</p>
<p>æˆ‘ä»¬å–å…¶ä¸­ä¸€ä¸ªå¼ é‡è¿›è¡Œåˆ†æ:</p>
<p>$$
^{1}-\sum_{|_{4}}^{|^{3}}-^{2}
$$</p>
<p>è¿™é‡Œé¢çš„$1$å’Œ$2$ä»£è¡¨çš„æ—¶å¼ é‡å·¦å³çš„æŒ‡æ ‡, è€Œ$3$å’Œ$4$ä»£è¡¨çš„æ˜¯å¼ é‡ä¸Šä¸‹çš„æŒ‡æ ‡(é€šå¸¸å’Œä½œç”¨ä¸æŸé‡å­ä½æˆ–å…¶å®ƒç‰©ç†é‡æœ‰å…³). å¤šä¸ªè¿™æ ·çš„å¼ é‡ä¹˜åœ¨ä¸€èµ·å°±èƒ½åŒ–æˆçŸ©é˜µä¹˜ç§¯ç®—å­çš„å½¢å¼.</p>
<p>æˆ‘ä»¬ä¸å¦¨ç”¨ä¸€ä¸ªæ›´å…·ä½“çš„ä¾‹å­:</p>
<p>$$\hat{H} =
\begin{bmatrix}
0 &amp; 1\\
\end{bmatrix}_{A}
\begin{bmatrix}
\hat{I} &amp; \\
\hat{\sigma}^{z} &amp; \hat{I}\\
\end{bmatrix}_{B}
\begin{bmatrix}
\hat{I} &amp; \\
\hat{\sigma}^{z} &amp; \hat{I}\\
\end{bmatrix}_{C}
\begin{bmatrix}
1 \\
0\\
\end{bmatrix}_{D}
$$</p>
<p>åœ¨çŸ©é˜µçš„å³ä¸‹è§’ä½¿ç”¨<code>A</code> <code>B</code> <code>C</code> <code>D</code>æ¥è¿›è¡Œæ ‡è®°.å®ƒä»¬ä»¥å¼ é‡ç½‘ç»œç”»å‡ºçš„å½¢å¼å¤§æ¦‚åƒè¿™æ ·:</p>
<p>$$
\sum{A}-\sum_{|}^{|}{B}-\sum_{|}^{|}{C}-\sum{D}
$$</p>
<p>ä¸éš¾çœ‹å‡ºå®é™…ä¸Š<code>A</code>å’Œ<code>B</code>,ä»¥åŠ<code>C</code>å’Œ<code>D</code>æ˜¯èƒ½å¤Ÿå„è‡ªç»“åˆå½¢æˆæ–°çŸ©é˜µçš„, æˆ‘ä»¬å†™å‡ºç›¸ä¹˜å¾—åˆ°çš„ç»“æœ:</p>
<p>$$
\hat{H} =
\begin{bmatrix}
\hat{\sigma}^{z} &amp; \hat{I}\\
\end{bmatrix}_{A&rsquo;}
\begin{bmatrix}
\hat{I}\\
\hat{\sigma}^{z} \\
\end{bmatrix}_{B&rsquo;}
$$</p>
<p>åœ¨æ–¹ç¨‹ä¸Šæˆ‘ä»¬è¿™æ ·è¡¨è¿°:</p>
<p>$$
\hat{H} = \hat{\sigma_{1}}^{z}\bigotimes\hat{I_{2}} + \hat{I_{1}}\bigotimes\hat{\sigma_{2}}^{z}
$$</p>
<p>å½“ç„¶è¿™ä¸€ä¸ªå¼å­æˆ‘ä»¬è¿˜å¯ä»¥è¿›è¡Œç»§ç»­çš„ç®€åŒ–, å®Œæˆæœ€åä¸€æ­¥çš„ä¹˜æ³•:</p>
<p>$$
\hat{H} = \hat{\sigma_{1}}^{z}+\hat{\sigma_{2}}^{z}
=\sum_{i}\hat{\sigma_{i}}^{z}
$$</p>
<p>ç°åœ¨å†åŠ¨æ‰‹ç®—æ›´å¤æ‚çš„ä¾‹å­.</p>
<p>$$\hat{H}=
\begin{bmatrix}
0 &amp; 0 &amp; 1\\
\end{bmatrix}
\begin{bmatrix}
\hat{I} &amp;  &amp; \\
\hat{\sigma}^{z} &amp;  &amp; \\
-h\hat{\sigma}^{x} &amp; \hat{\sigma}^{z} &amp; \hat{I}\\
\end{bmatrix}
\begin{bmatrix}
\hat{I} &amp;  &amp; \\
\hat{\sigma}^{z} &amp;  &amp; \\
-h\hat{\sigma}^{x} &amp; \hat{\sigma}^{z} &amp; \hat{I}\\
\end{bmatrix}
\begin{bmatrix}
1\\
0\\
0\\
\end{bmatrix}
$$</p>
<p>å…ˆç®—ä¸¤è¾¹, å†ç®—ä¸­é—´, å³æœ‰</p>
<p>$$
\hat{H}=[-h\hat{\sigma}^{x},\hat{\sigma}^{z},\hat{I}][\hat{I},\hat{\sigma}^{z},-h\hat{\sigma}^{x}]^{T}=\sum_{j}\hat{\sigma_{j}}^{z}\hat{\sigma_{j+1}}^{z}-h\hat{\sigma_{j}}^{x}
$$</p>
<blockquote>
<p>æœ¬ç« æ²¡æœ‰å¯¹åº”çš„Quiz</p>
</blockquote>
<h1 id="dmrg-å¯†åº¦çŸ©é˜µé‡æ•´åŒ–ç¾¤"><strong>DMRG</strong> å¯†åº¦çŸ©é˜µé‡æ•´åŒ–ç¾¤<a hidden class="anchor" aria-hidden="true" href="#dmrg-å¯†åº¦çŸ©é˜µé‡æ•´åŒ–ç¾¤">#</a></h1>
<blockquote>
<p>è­¦å‘Š</p>
<p>ä»¥ä¸‹éƒ¨åˆ†å†…å®¹, å¯èƒ½ä»…é€‚ç”¨äº<strong>1D</strong>çš„æƒ…å†µ, è™½ç„¶ITensorå¼€å‘äº†ä¸€äº›åŸºäºåŸºäº<strong>DMRG</strong>ç®—æ³•çš„æ‰©å±•ç”¨ä»¥åº”å¯¹äºŒç»´æƒ…å†µä¸‹ç³»ç»Ÿ, ä½†æ˜¯è¿™äº›æ–¹æ³•çš„å®ç°å¤æ‚åº¦é€šå¸¸è¾ƒé«˜, éœ€è¦è¾ƒé•¿çš„è®¡ç®—æ—¶é—´å’Œæ›´é«˜çš„è®¡ç®—èµ„æº.</p>
<p>å¦‚æœä½ æƒ³è¦å¯¹äºŒç»´ç³»ç»Ÿè¿›è¡Œè®¡ç®—, è¯·è€ƒè™‘ä½¿ç”¨<strong>PEPS</strong>(æŠ•å½±çº ç¼ å¯¹æ€ç®—æ³•)æˆ–è€…<strong>MERA</strong>(<strong>Multi-scale Entanglement Renormalization Ansatz</strong>,å¤šå°ºåº¦åµŒå¥—æ­£äº¤æ¨¡å‹)ç®—æ³•,
é™¤äº†<strong>ITensor</strong>å¤–ä½ ä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨<strong>Qiskit, PyQuante</strong>ç­‰è®¡ç®—åº“, ä»è€Œå®ç°åŸºäºå“ˆå¯†é¡¿é‡å¯¹è§’åŒ–çš„èƒ½å¸¦è®¡ç®—.</p>
<p><span title="ä½ çŸ¥é“çš„å¤ªå¤šäº†" style="background-color: black; color: black;">æ‰€ä»¥ä¸ºä»€ä¹ˆè¦å­¦ITensorå‘¢? ç›´æ¥ç”¨matlabæ¨¡æ‹Ÿä¸å°±å¥½äº†</span></p>
</blockquote>
<p>å¦‚æœæˆ‘ä»¬æƒ³è¦æ±‚è§£<strong>ä¸€ç»´</strong>å“ˆå¯†é¡¿é‡çš„åŸºæ€, <strong>DMRG</strong> å°†æ˜¯æœ€å¥½çš„æ–¹æ³•.</p>
<p>æ–¹ç¨‹å¼çš„å½¢å¼å¦‚ä¸‹:</p>
<p>$\hat{H}|\Psi\rangle = E|\Psi\rangle$</p>
<p>å…¶ä¸­ $\hat{H}$ å’Œ $|\Psi\rangle$ éƒ½åŒ–ä¸ºå¯¹åº”é‡å­ä½æ•°çš„ çŸ©é˜µä¹˜ç§¯å½¢å¼(<code>MPO</code> å’Œ <code>MPS</code>).</p>
<p>MPSçš„æ„é€ ä¸­ä¸åªæ˜¯ç”¨åˆ°äº†æˆ‘ä»¬ä¹‹å‰æ‰€å­¦çš„SVDå’ŒReGroup, å®ƒè¿˜åŒ…æ‹¬äº†ä¸€äº›æˆ‘ä»¬æ²¡æœ‰æåˆ°çš„å¤„ç†æ“ä½œ, è¿™äº›æ“ä½œè¢«ç»Ÿç§°ä¸º&quot;è§„èŒƒåŒ–å˜æ¢&quot;, æ¯”å¦‚å¯¹å¼ é‡è¿›è¡Œå•ä½åŒ–(unitarization).</p>
<p>è¿™äº›å¤„ç†æ˜¯ä¸ºäº†MPSåœ¨è®¡ç®—æ—¶å…·æœ‰è‰¯å¥½æ€§è´¨, æ¯”å¦‚è®¡ç®—ç‰©ç†é‡æ—¶å…·æœ‰æœ€å°è¯¯å·®.</p>
<blockquote>
<p>Importtant: MPS should be in definite gauge. I.e.most tensors unitary.</p>
</blockquote>
<p>å°±æ˜¯åœ¨è¦æ±‚çŸ©é˜µä¹˜ç§¯æ€åº”å½“å·²ç»è¢«è§„èŒƒåŒ–, ä¹Ÿå°±æ˜¯å¤§å¤šæ•°é‡å­ä½çš„å¼ é‡éƒ½æ˜¯å¹ºæ­£çš„.</p>
<blockquote>
<p><strong>å¹ºæ­£ Unitary</strong></p>
<p>å¹ºæ­£æœ¬èº«æ˜¯ä¸€ä¸ªçº¿æ€§ä»£æ•°é‡Œçš„æ¦‚å¿µ, åœ¨è¿™é‡Œæˆ‘ä»¬ç”¨æ›´ç‰©ç†ä¸€äº›çš„è¯­è¨€æ¥æè¿°è¿™ä¸ªæ€§è´¨.</p>
<p>å¦‚æœä¸€ä¸ªç®—å­ $\hat{U}$ , è¿˜æœ‰ä¸€ä¸ªæ€çŸ¢é‡ $|\psi\rangle$ ,èƒ½å¤Ÿæ»¡è¶³ä»¥ä¸‹æ¡ä»¶:</p>
<ul>
<li>$\hat{U}|\psi\rangle\neq 0$;</li>
<li>$||\hat{U}|\psi\rangle|| = ||\psi\rangle||$;</li>
<li>$\langle\Phi|\hat{U}|\psi\rangle = \langle\Phi|\psi\rangle$
å…¶ä¸­ $||\psi\rangle||$ ä»£è¡¨æ€åŠ¿ $|\psi\rangle$ çš„é•¿åº¦, è¿™ä¸ªé‡å¯ä»¥é€šè¿‡æ±‚å†…ç§¯æ¥å¾—åˆ°.
é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç§°è¿™ä¸ªç®—å­æ˜¯å¹ºæ­£çš„.</li>
</ul>
</blockquote>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€‰å®šä¸€ä¸ªç‰¹å®šçš„ä½ç½®(æ­£åˆ™ä½ç½®), å°†å…¶å·¦å³ä¸¤è¾¹çš„å¼ é‡å…¨éƒ¨éƒ½è§„èŒƒåŒ–å¤„ç†, ä»è€Œå®šä¹‰å‡ºæ­£äº¤å½’ä¸€çš„åŸº.</p>
<p>è¿™æ ·, æˆ‘ä»¬å°±å¯ä»¥è®¡ç®—å‡ºæœŸæœ›å€¼ $\langle\Psi|\hat{H}|\Psi\rangle$ .å…¶ä¸­ $|\Psi\rangle$ å’Œ $\hat{H}$ éƒ½æ˜¯çŸ©é˜µä¹˜ç§¯å½¢å¼. æŒ‰ç…§æˆ‘ä»¬å‰é¢æ‰€è¯´çš„,</p>
<h1 id="meraç®—æ³•"><strong>MERA</strong>ç®—æ³•<a hidden class="anchor" aria-hidden="true" href="#meraç®—æ³•">#</a></h1>
<blockquote>
<p><strong>Multi-scale Entanglement Renormalization Ansatz</strong></p>
<p>å¤šå°ºåº¦åµŒå¥—æ­£äº¤çŸ©å½¢æ¨¡å‹. è¿™æ˜¯å¯¹é‡æ•´åŒ–ç¾¤æ–¹æ³•çš„æ‰©å±•.
MERAå°†ç³»ç»Ÿåˆ†è§£ä¸ºä¸€ç³»åˆ—çš„å¼ é‡, æ¯ä¸ªå¼ é‡ä»£è¡¨äº†ç³»ç»Ÿä¸åŒå°ºåº¦ä¸‹çš„çŠ¶æ€. æ¯ä¸ªå¼ é‡çš„å¤§å°è¡¨ç¤ºè¯¥å°ºåº¦çš„è‡ªç”±åº¦æ•°ç›®.</p>
<p>è¿™äº›å¼ é‡é€šè¿‡ç‰¹å®šçš„å˜åŒ–ç›¸äº’è¿æ¥, ä»è€Œå½¢æˆå…·æœ‰åˆ†å½¢ç»“æ„çš„ç½‘ç»œ. è¿™æ ·, æˆ‘ä»¬å°±å¯ä»¥å°†ç³»ç»Ÿçš„çº ç¼ ç»“æ„è¡¨ç¤ºä¸ºä¸åŒå°ºåº¦ä¸Šçš„ç®€å•å¼ é‡ç½‘ç»œ.</p>
<p>å…·ä½“æ¥è¯´, æ¯ä¸ªå¼ é‡è¢«åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†, å³ä¸Šéƒ¨åˆ†å’Œä¸‹éƒ¨åˆ†. ä¸Šéƒ¨åˆ†è¡¨ç¤ºçš„æ˜¯ä½å°ºåº¦çš„ä¿¡æ¯, ä¸‹éƒ¨åˆ†è¡¨ç¤ºçš„æ˜¯é«˜å°ºåº¦çš„ä¿¡æ¯. é€šè¿‡é‡å¤åº”ç”¨åŠ å¯†å’Œè§£å¯†æ“ä½œ, å°±å¯ä»¥å¾—åˆ°ä¸åŒå°ºåº¦ä¸‹çš„ç³»ç»ŸçŠ¶æ€.</p>
</blockquote>


        </div>

        <footer class="post-footer">
            
<nav class="paginav">
  <a class="prev" href="https://Muatyz.github.io/posts/phy/hcmp/tbg-fig-python/">
    <span class="title">Â« ä¸Šä¸€é¡µ</span>
    <br>
    <span>ä½¿ç”¨Pythonç»˜åˆ¶è½¬è§’çŸ³å¢¨çƒ¯</span>
  </a>
  <a class="next" href="https://Muatyz.github.io/posts/phy/calphy/itensor-donwload/">
    <span class="title">ä¸‹ä¸€é¡µ Â»</span>
    <br>
    <span>ITensoråº“å®‰è£…è¯´æ˜</span>
  </a>
</nav>

        </footer>
    </div>

<style>
    .comments_details summary::marker {
        font-size: 20px;
        content: 'ğŸ‘‰å±•å¼€è¯„è®º';
        color: var(--content);
    }
    .comments_details[open] summary::marker{
        font-size: 20px;
        content: 'ğŸ‘‡å…³é—­è¯„è®º';
        color: var(--content);
    }
</style>





<div>
    <div class="pagination__title">
        <span class="pagination__title-h" style="font-size: 20px;">ğŸ’¬è¯„è®º</span>
        <hr />
    </div>
    <div id="tcomment"></div>
    <script src="https://cdn.staticfile.org/twikoo/1.6.16/twikoo.all.min.js"></script>
    <script>
        twikoo.init({
            envId: "https://twikoo-api-one-xi.vercel.app",  
            el: "#tcomment",
            lang: 'zh-CN',
            region: 'ap-shanghai',  
            path: window.TWIKOO_MAGIC_PATH||window.location.pathname,
        });
    </script>
</div>
</article>
</main>

<footer class="footer">
    <span>Muartz</span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <span class="topInner">
        <svg class="topSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z"/>
        </svg>
        <span id="read_progress"></span>
    </span>
</a>

<script>
    document.addEventListener('scroll', function (e) {
        const readProgress = document.getElementById("read_progress");
        const scrollHeight = document.documentElement.scrollHeight;
        const clientHeight = document.documentElement.clientHeight;
        const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
        readProgress.innerText = ((scrollTop / (scrollHeight - clientHeight)).toFixed(2) * 100).toFixed(0);
    })
</script><script>

    let detail = document.getElementsByClassName('details')
   
    details = [].slice.call(detail);
   
    for (let index = 0; index < details.length; index++) {
   
    let element = details[index]
   
    const summary = element.getElementsByClassName('details-summary')[0];
   
    if (summary) {
   
    summary.addEventListener('click', () => {
   
    element.classList.toggle('open');
   
    }, false);
   
    }
   
    }
   
   </script>   

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });
</script>
<script>
    let mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };
</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        (function() {
            document.cookie = "change-themes" + "="+ escape ("false");
        })()

        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    });
</script>

<script>
    document.body.addEventListener('copy', function (e) {
        if (window.getSelection().toString() && window.getSelection().toString().length > 50) {
            let clipboardData = e.clipboardData || window.clipboardData;
            if (clipboardData) {
                e.preventDefault();
                let htmlData = window.getSelection().toString() +
                    '\r\n\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\r\n' +
                    'ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºã€Œ'+"æ— å¤„æƒ¹å°˜åŸƒ"+'ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚' +
                '\r\nåŸæ–‡é“¾æ¥ï¼š' + location.href;
                let textData = window.getSelection().toString() +
                    '\r\n\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\r\n' +
                    'ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºã€Œ'+"æ— å¤„æƒ¹å°˜åŸƒ"+'ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚' +
                '\r\nåŸæ–‡é“¾æ¥ï¼š' + location.href;
                clipboardData.setData('text/html', htmlData);
                clipboardData.setData('text/plain', textData);
            }
        }
    });
</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;
        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'å¤åˆ¶';

        function copyingDone() {
            copybutton.innerText = 'å·²å¤åˆ¶ï¼';
            setTimeout(() => {
                copybutton.innerText = 'å¤åˆ¶';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                let text = codeblock.textContent +
                    '\r\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\r\n' +
                    'ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºã€Œ'+"æ— å¤„æƒ¹å°˜åŸƒ"+'ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚' +
                '\r\nåŸæ–‡é“¾æ¥ï¼š' + location.href;
                navigator.clipboard.writeText(text);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) {}
            selection.removeRange(range);
        });

        let language = codeblock.className.replaceAll("language-", "")
        let macTool = document.createElement("div")
        let macTool1 = document.createElement("div")
        let macTool2 = document.createElement("div")
        let macTool3 = document.createElement("div")
        let languageType = document.createElement("div")
        languageType.innerText = language
        macTool.setAttribute('class', 'mac-tool')
        macTool1.setAttribute('class', 'mac bb1')
        macTool2.setAttribute('class', 'mac bb2')
        macTool3.setAttribute('class', 'mac bb3')
        languageType.setAttribute('class', 'language-type')
        macTool.appendChild(macTool1)
        macTool.appendChild(macTool2)
        macTool.appendChild(macTool3)
        macTool.appendChild(languageType)

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
            container.appendChild(macTool)
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
            container.appendChild(macTool)
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
            container.appendChild(macTool)
        }
    });
</script>

<script>
    $("code[class^=language] ").on("mouseover", function () {
        if (this.clientWidth < this.scrollWidth) {
            $(this).css("width", "135%")
            $(this).css("border-top-right-radius", "var(--radius)")
        }
    }).on("mouseout", function () {
        $(this).css("width", "100%")
        $(this).css("border-top-right-radius", "unset")
    })
</script>


<script>
    
    document.addEventListener('keydown', function(event) {
      
      if (event.key === 'j') {
        
        var nextPageLink = document.querySelector('.pagination-item.pagination-next > a');
        if (nextPageLink) {
          nextPageLink.click();
        }
      } else if (event.key === 'k') {
        
        var prevPageLink = document.querySelector('.pagination-item.pagination-previous > a');
        if (prevPageLink) {
          prevPageLink.click();
        }
      }
    });
  </script>
  

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/fz6m/Private-web@1.2/js/custom/click.min.js"></script>

</body>





<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script>
  </head>


<body>
  <link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont/style.css" media="print" onload="this.media='all'">
</body>


</html>
